Attribute VB_Name = "B_Apoio_Cadastro_Unidades"
Sub Calcular_Total_m2_Construído()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        If .TB_CUSTO_C.Value <> "" Then
            If FormatDouble(.TB_Area_Total_C.Value) = 0 Then .TB_Area_Total_C.Value = .TB_Area_Total_PVT.Value
            .TB_CUSTO_TOTAL2.Value = CDbl(.TB_CUSTO_C.Value) * CDbl(.TB_Area_Total_C.Value)
            Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_TOTAL2", 2)
            If .Custo_Obra_Pvt.Value = "Custo do m² Pvt. C/ Taxas" Then
                'CONTABILIZA CUSTO POR M²
                .TB_CUSTO_P_TAXAS.Value = .TB_CUSTO_TOTAL2.Value / .TB_Area_Total_PVT.Value
                Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_P_TAXAS", 2)
                
                'INFORMA ZERO NAS TAXAS EM BRANCO
                If .TB_TX_ADM_GER.Value = "" Then .TB_TX_ADM_GER = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_GER", 2)
                If .TB_TX_ADM_EXT.Value = "" Then .TB_TX_ADM_EXT = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_EXT", 2)
                If .TB_TX_DTAS_2.Value = "" Then .TB_TX_DTAS_2 = "0"
                Call FormatarNum("CadastroUnidades", "TB_TX_DTAS_2", 2)
                
                'CONTABILIZA O TOTAL DAS TAXAS
                ºTaxas = 0
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_GER, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_EXT, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_DTAS_2, "%", "") / 100)
                
                'CALCULA O CUSTO POR M² PVT SEM TAXAS
                .TB_Custo_Metro = .TB_CUSTO_P_TAXAS / (1 + ºTaxas)
                Call FormatarNumCur("CadastroUnidades", "TB_Custo_Metro", 2)
                
                'CALCULA O RESTANTE DAS INFORMAÇÕES
                Call TotaisObra_2
            Else
                'CONTABILIZA CUSTO POR M²
                .TB_Custo_Metro.Value = .TB_CUSTO_TOTAL2.Value / .TB_Area_Total_PVT.Value
                Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_P_TAXAS", 2)
                
                'INFORMA ZERO NAS TAXAS EM BRANCO
                If .TB_TX_ADM_GER.Value = "" Then .TB_TX_ADM_GER = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_GER", 2)
                If .TB_TX_ADM_EXT.Value = "" Then .TB_TX_ADM_EXT = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_EXT", 2)
                If .TB_TX_DTAS_2.Value = "" Then .TB_TX_DTAS_2 = "0"
                Call FormatarNum("CadastroUnidades", "TB_TX_DTAS_2", 2)
                
                'CONTABILIZA O TOTAL DAS TAXAS
                ºTaxas = 0
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_GER, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_EXT, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_DTAS_2, "%", "") / 100)
                
                'CALCULA O CUSTO POR M² PVT SEM TAXAS
                .TB_CUSTO_P_TAXAS = .TB_Custo_Metro / (1 + ºTaxas)
                Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_P_TAXAS", 2)
                
                'CALCULA O RESTANTE DAS INFORMAÇÕES
                Call TotaisObra_2
            End If
        End If
    End With
End Sub
Sub Calcular_Custo_m2_Construído()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    With CadastroUnidades
        If .TB_Area_Total_C.Value <> "" Then
            .TB_CUSTO_TOTAL2.Value = CDbl(.TB_CUSTO_C.Value) * CDbl(.TB_Area_Total_C.Value)
            Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_TOTAL2", 2)
            If .Custo_Obra_Pvt.Value = "Custo do m² Pvt. C/ Taxas" Then
                'CONTABILIZA CUSTO POR M²
                .TB_CUSTO_P_TAXAS.Value = .TB_CUSTO_TOTAL2.Value / .TB_Area_Total_PVT.Value
                Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_P_TAXAS", 2)
                
                'INFORMA ZERO NAS TAXAS EM BRANCO
                If .TB_TX_ADM_GER.Value = "" Then .TB_TX_ADM_GER = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_GER", 2)
                If .TB_TX_ADM_EXT.Value = "" Then .TB_TX_ADM_EXT = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_EXT", 2)
                If .TB_TX_DTAS_2.Value = "" Then .TB_TX_DTAS_2 = "0"
                Call FormatarNum("CadastroUnidades", "TB_TX_DTAS_2", 2)
                
                'CONTABILIZA O TOTAL DAS TAXAS
                ºTaxas = 0
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_GER, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_EXT, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_DTAS_2, "%", "") / 100)
                
                'CALCULA O CUSTO POR M² PVT SEM TAXAS
                .TB_Custo_Metro = .TB_CUSTO_P_TAXAS / (1 + ºTaxas)
                Call FormatarNum("CadastroUnidades", "TB_Custo_Metro", 2)
                
                'CALCULA O RESTANTE DAS INFORMAÇÕES
                Call TotaisObra_2
            Else
                'CONTABILIZA CUSTO POR M²
                .TB_Custo_Metro.Value = .TB_CUSTO_TOTAL2.Value / .TB_Area_Total_PVT.Value
                Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_P_TAXAS", 2)
                
                'INFORMA ZERO NAS TAXAS EM BRANCO
                If .TB_TX_ADM_GER.Value = "" Then .TB_TX_ADM_GER = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_GER", 2)
                If .TB_TX_ADM_EXT.Value = "" Then .TB_TX_ADM_EXT = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_EXT", 2)
                If .TB_TX_DTAS_2.Value = "" Then .TB_TX_DTAS_2 = "0"
                Call FormatarNum("CadastroUnidades", "TB_TX_DTAS_2", 2)
                
                'CONTABILIZA O TOTAL DAS TAXAS
                ºTaxas = 0
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_GER, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_EXT, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_DTAS_2, "%", "") / 100)
                
                'CALCULA O CUSTO POR M² PVT SEM TAXAS
                .TB_CUSTO_P_TAXAS = .TB_Custo_Metro / (1 + ºTaxas)
                Call FormatarNum("CadastroUnidades", "TB_CUSTO_P_TAXAS", 2)
                
                'CALCULA O RESTANTE DAS INFORMAÇÕES
                Call TotaisObra_2
            End If
        End If
    End With
End Sub


Sub mudarpagina_2()
    CadastroUnidades.MultiPage1.Value = 2
End Sub


Sub LiberarCampos()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        .TB_Tbl_Name.Enabled = True
        .CB_TP_PARCELA.Enabled = True
        .TB_Quantidade.Enabled = True
        .TB_Inicio.Enabled = True
        .TB_Percent_VGV.Enabled = True
        .CB_Cobrar_Juros.Enabled = True
        .TB_Inicio_Juros.Enabled = True
        .CB_FX_INICIO.Enabled = True
        .CB_FX_FIM.Enabled = True
        .TB_Ultimo.Enabled = True
        .Add.Enabled = True
        .ADD_ROW_TBL_VND.Enabled = True
        .EDIT_ROW_TBL_VND.Enabled = True
        .COPY_ROW_TBL_VND.Enabled = True
        .DEL_ROW_TBL_VND.Enabled = True
        Liberar_Deletar = True
    End With
End Sub
Sub TravarCampos()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    CadastroUnidades.TB_Tbl_Name.Value = ""
    CadastroUnidades.TB_Tbl_Name.Enabled = False
    CadastroUnidades.CB_TP_PARCELA.Enabled = False
    CadastroUnidades.TB_Quantidade.Enabled = False
    CadastroUnidades.TB_Inicio.Enabled = False
    CadastroUnidades.TB_Percent_VGV.Enabled = False
    CadastroUnidades.CB_Cobrar_Juros.Enabled = False
    CadastroUnidades.TB_Inicio_Juros.Enabled = False
    CadastroUnidades.CB_FX_INICIO.Enabled = False
    CadastroUnidades.CB_FX_FIM.Enabled = False
    CadastroUnidades.TB_Ultimo.Enabled = False
    CadastroUnidades.Add.Enabled = False
    CadastroUnidades.ADD_ROW_TBL_VND.Enabled = False
    CadastroUnidades.EDIT_ROW_TBL_VND.Enabled = False
    CadastroUnidades.COPY_ROW_TBL_VND.Enabled = False
    CadastroUnidades.DEL_ROW_TBL_VND.Enabled = False
    
    Liberar_Deletar = False

End Sub
Sub Feed_List_Tipologias()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    'CadastroUnidades.List_Tipologias.ColumnCount = 2
    'CadastroUnidades.List_Tipologias.ColumnWidths = "60;60"
    Application.EnableEvents = False
    CadastroUnidades.List_Tipologias.Clear
    Application.EnableEvents = True
    If CadastroUnidades.LIST_Perfil_Venda.ListItems.Count > 0 Then
        ºperfil = CadastroUnidades.LIST_Perfil_Venda.SelectedItem
        For ºL = 3 To 32
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value Then
                CadastroUnidades.List_Tipologias.AddItem ºL
                CadastroUnidades.List_Tipologias.List(CadastroUnidades.List_Tipologias.ListCount - 1, 1) = ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & ºL).Value
                If ThisWorkbook.Sheets("BD_CAD_VND").Range("e" & ºL).Value <> "" And ThisWorkbook.Sheets("BD_CAD_VND").Range("F" & ºL).Value <> "" Then
                    CadastroUnidades.List_Tipologias.List(CadastroUnidades.List_Tipologias.ListCount - 1, 2) = Format(ThisWorkbook.Sheets("BD_CAD_VND").Range("e" & ºL).Value - ThisWorkbook.Sheets("BD_CAD_VND").Range("F" & ºL).Value, "#,##0")
                Else
                    CadastroUnidades.List_Tipologias.List(CadastroUnidades.List_Tipologias.ListCount - 1, 2) = 0
                End If
                If ThisWorkbook.Sheets("BD_CAD_VND").Range("O" & ºL).Value <> 0 And CadastroUnidades.List_Tipologias.List(CadastroUnidades.List_Tipologias.ListCount - 1, 2) <> 0 Then
                    CadastroUnidades.List_Tipologias.List(CadastroUnidades.List_Tipologias.ListCount - 1, 3) = Format(ThisWorkbook.Sheets("BD_CAD_VND").Range("O" & ºL).Value / CadastroUnidades.List_Tipologias.List(CadastroUnidades.List_Tipologias.ListCount - 1, 2), "#,##0")
                Else
                    CadastroUnidades.List_Tipologias.List(CadastroUnidades.List_Tipologias.ListCount - 1, 3) = 0
                End If
                If ThisWorkbook.Sheets("BD_CAD_VND").Range("N" & ºL).Value = CDbl(ºperfil) Then
                    CadastroUnidades.List_Tipologias.Selected(CadastroUnidades.List_Tipologias.ListCount - 1) = True
                End If
            End If
        Next
        For ºL = 35 To 54
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value Then
                CadastroUnidades.List_Tipologias.AddItem ºL
                CadastroUnidades.List_Tipologias.List(CadastroUnidades.List_Tipologias.ListCount - 1, 1) = "VAGA EXTRA"
                CadastroUnidades.List_Tipologias.List(CadastroUnidades.List_Tipologias.ListCount - 1, 2) = Format(ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & ºL).Value, "#,##0")
                CadastroUnidades.List_Tipologias.List(CadastroUnidades.List_Tipologias.ListCount - 1, 3) = Format(ThisWorkbook.Sheets("BD_CAD_VND").Range("G" & ºL).Value, "#,##0")
                If ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºL).Value = CDbl(ºperfil) Then
                    CadastroUnidades.List_Tipologias.Selected(CadastroUnidades.List_Tipologias.ListCount - 1) = True
                End If
            End If
        Next
    End If
End Sub

Function ºValidarNumero(VALOR As Variant)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Function

    ºValidarNumero = False
    If VALOR <> "" Then
    On Error Resume Next
        If Err.Number <> 0 Then
            ºValidarNumero = False
        Else
            ºValidarNumero = True
        End If
    On Error GoTo 0
    End If
End Function

Sub CarregarVelocidades(Perfil)
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades.LIST_Velocidade
        .ListItems.Clear
        .ColumnHeaders.Clear
        .ColumnHeaders.Add , , "% de Venda", 60
        .ColumnHeaders.Add , , "Inicio", 100
        .ColumnHeaders.Add , , "Duração", 100
        If Perfil <> 0 Then
            Perfil = Application.IfError(Application.Match(CDbl(Perfil), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
            ºCurvaVel = Left(ThisWorkbook.Sheets("BD_CAD_VND").Cells(900 + Perfil, 3), 1)
            For ºVel = 3 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(56 + ºCurvaVel, Columns.Count).End(xlToLeft).Column Step 3
                If ThisWorkbook.Sheets("BD_CAD_VND").Cells(56 + ºCurvaVel, ºVel).Value <> "" Then
                    ºVel_percent = ThisWorkbook.Sheets("BD_CAD_VND").Cells(56 + ºCurvaVel, ºVel).Value
                    ºVel_Tempo = ThisWorkbook.Sheets("BD_CAD_VND").Cells(56 + ºCurvaVel, ºVel + 1).Value
                    ºVel_Ini = ThisWorkbook.Sheets("BD_CAD_VND").Cells(56 + ºCurvaVel, ºVel + 2).Value
                    ºVel_Tempo = ThisWorkbook.Sheets("BD_CAD_VND").Cells(56 + ºCurvaVel, ºVel + 1).Value
                    Set ºLi = .ListItems.Add(, , Format(ºVel_percent, "0%"))
                    ºLi.SubItems(1) = ºVel_Ini
                    ºLi.SubItems(2) = ºVel_Tempo
                End If
            Next
        End If
        .View = lvwReport
        .FullRowSelect = True
        .Visible = False
        .Visible = True
    End With
End Sub

Sub OrganizarParcelas()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºPARCELAS = CadastroUnidades.List_Tabela.ListItems.Count
    ºCod = Left(CadastroUnidades.CB_Select_Tbl.Value, Application.Search("|", CadastroUnidades.CB_Select_Tbl.Value) - 2) + 107
    For ºP = 1 To ºPARCELAS
            '---------------------------------------------------------  TIPO  ---------------------------------------------------------------------------------------------------------------------------------
            Set Li = CadastroUnidades.List_Tabela.ListItems(ºP)
            ThisWorkbook.Sheets("BD_CAD_VND").Range("MA" & ºP + 1).Value = CadastroUnidades.List_Tabela.ListItems(ºP).Text
            '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
            ThisWorkbook.Sheets("BD_CAD_VND").Range("MB" & ºP + 1).Value = Li.SubItems(1)
            '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
            ThisWorkbook.Sheets("BD_CAD_VND").Range("MC" & ºP + 1).Value = Li.SubItems(2)
            '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
            ThisWorkbook.Sheets("BD_CAD_VND").Range("MD" & ºP + 1).Value = "'" & Li.SubItems(3)
            '---------------------------------------------------------  JUROS  -------------------------------------------------------------------------------------------------------------------------------
            ThisWorkbook.Sheets("BD_CAD_VND").Range("ME" & ºP + 1).Value = Li.SubItems(4)
            '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
            ThisWorkbook.Sheets("BD_CAD_VND").Range("MF" & ºP + 1).Value = Li.SubItems(5)
            '---------------------------------------------------------  FIXAR INICIO  ----------------------------------------------------------------------------------------------------------------------
            ThisWorkbook.Sheets("BD_CAD_VND").Range("MG" & ºP + 1).Value = Li.SubItems(6)
            '---------------------------------------------------------  FIXAR FIM  --------------------------------------------------------------------------------------------------------------------------
            ThisWorkbook.Sheets("BD_CAD_VND").Range("MH" & ºP + 1).Value = Li.SubItems(7)
            '---------------------------------------------------------  MES FIM  -----------------------------------------------------------------------------------------------------------------------------
            ThisWorkbook.Sheets("BD_CAD_VND").Range("MI" & ºP + 1).Value = Li.SubItems(8)
    Next
    If ThisWorkbook.Sheets("BD_CAD_VND").AutoFilterMode = True Then ThisWorkbook.Sheets("BD_CAD_VND").AutoFilterMode = False
    ThisWorkbook.Sheets("BD_CAD_VND").Range("MA1:MI" & ºPARCELAS + 1).AutoFilter
    ThisWorkbook.Worksheets("BD_CAD_VND").AutoFilter.Sort.SortFields.Clear
    ThisWorkbook.Worksheets("BD_CAD_VND").AutoFilter.Sort.SortFields.Add Key:=Range("MC2:MC" & ºPARCELAS + 1), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ThisWorkbook.Worksheets("BD_CAD_VND").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
    End With
    ThisWorkbook.Worksheets("BD_CAD_VND").AutoFilter.Sort.Apply
    CadastroUnidades.List_Tabela.ListItems.Clear
    For ºP = 1 To ºPARCELAS
            '---------------------------------------------------------  TIPO  ---------------------------------------------------------------------------------------------------------------------------------
            Set Li = CadastroUnidades.List_Tabela.ListItems.Add(, , ThisWorkbook.Sheets("BD_CAD_VND").Range("MA" & ºP + 1).Value)
            '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
            Li.SubItems(1) = ThisWorkbook.Sheets("BD_CAD_VND").Range("MB" & ºP + 1).Value
            '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(2) = ThisWorkbook.Sheets("BD_CAD_VND").Range("MC" & ºP + 1).Value
            '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(3) = ThisWorkbook.Sheets("BD_CAD_VND").Range("MD" & ºP + 1).Value
            '---------------------------------------------------------  JUROS  -------------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(4) = ThisWorkbook.Sheets("BD_CAD_VND").Range("ME" & ºP + 1).Value
            '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
            Li.SubItems(5) = ThisWorkbook.Sheets("BD_CAD_VND").Range("MF" & ºP + 1).Value
            '---------------------------------------------------------  FIXAR INICIO  ----------------------------------------------------------------------------------------------------------------------
            Li.SubItems(6) = ThisWorkbook.Sheets("BD_CAD_VND").Range("MG" & ºP + 1).Value
            '---------------------------------------------------------  FIXAR FIM  --------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(7) = ThisWorkbook.Sheets("BD_CAD_VND").Range("MH" & ºP + 1).Value
            '---------------------------------------------------------  MES FIM  -----------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(8) = ThisWorkbook.Sheets("BD_CAD_VND").Range("MI" & ºP + 1).Value
    Next
    ThisWorkbook.Sheets("BD_CAD_VND").Range("MA2:MI" & ºPARCELAS + 1).ClearContents

End Sub


Sub Atulizar_Tbl_BD()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºPARCELAS = CadastroUnidades.List_Tabela.ListItems.Count
    ºP = 1
    ºCod = Left(CadastroUnidades.CB_Select_Tbl.Value, Application.Search("|", CadastroUnidades.CB_Select_Tbl.Value) - 2) + 107
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºCod & ":HA" & ºCod).ClearContents
    With CadastroUnidades
        '---------------------------------------------------------  PERCENTUAL  ---------------------------------------------------------------------------------------------------------------------------------
        PERCENTUALa = Replace(Replace(.LB_ParcentualAtingido.Caption, "Os percentuais da curva somam ", ""), "% do VGV da unidade", "")
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, 1).Value = (1 + PERCENTUALa) * 1 - 1
        For ºC_TBL = 3 To 172 Step 9
            If ºP <= ºPARCELAS Then
                Set Li = .List_Tabela.ListItems(ºP)
                ºCTIPO = .List_Tabela.ListItems(ºP).Text
                '---------------------------------------------------------  TIPO  ---------------------------------------------------------------------------------------------------------------------------------
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & Application.Match(ºCTIPO, ThisWorkbook.Sheets("BD_CAD_VND").Range("C:C"), 0))
                '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 1).Value = Li.SubItems(1)
                '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 2).Value = Li.SubItems(2)
                '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
                If Li.SubItems(3) > 0 And Li.SubItems(3) <> "" Then
                    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 3).Value = Format(Replace(Li.SubItems(3), "%", "") * 10, "0,000%")
                Else
                    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 3).Value = Format(Replace(0, "%", "") * 10, "0,000%")
                End If
                '---------------------------------------------------------  JUROS  -------------------------------------------------------------------------------------------------------------------------------
                If Li.SubItems(4) = "Não" Then
                    Bol = 0
                ElseIf Li.SubItems(4) = "Sim" Then
                    Bol = 1
                End If
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 4).Value = Bol
                '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 5).Value = Li.SubItems(5)
                '---------------------------------------------------------  FIXAR INICIO  ----------------------------------------------------------------------------------------------------------------------
                If Li.SubItems(6) = "Não" Then
                    Bol = 0
                ElseIf Li.SubItems(6) = "Sim" Then
                    Bol = 1
                End If
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 6).Value = Bol
                '---------------------------------------------------------  FIXAR FIM  --------------------------------------------------------------------------------------------------------------------------
                If Li.SubItems(7) = "Não" Then
                    Bol = 0
                ElseIf Li.SubItems(7) = "Sim" Then
                    Bol = 1
                End If
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 7).Value = Bol
                '---------------------------------------------------------  MES FIM  ------------------------------------------------------------------------------------------------------------------------------
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 8).Value = Li.SubItems(8)
            End If
            ºP = ºP + 1
        Next
    End With
End Sub
Sub CheckPercent()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºPARCELAS = CadastroUnidades.List_Tabela.ListItems.Count
    For ºP = 1 To ºPARCELAS
        ºPrtc = ºPrtc + CDbl(Replace(CadastroUnidades.List_Tabela.ListItems(ºP).SubItems(3), "%", ""))
        CadastroUnidades.LB_ParcentualAtingido.Caption = "Os percentuais da curva somam " & Format(ºPrtc, "0.00") & "% do VGV da unidade"
    Next
    If ºPrtc = 100 Then
        CadastroUnidades.LB_ParcentualAtingido.ForeColor = &H80000012
    Else
        CadastroUnidades.LB_ParcentualAtingido.ForeColor = &HFF&
    End If
End Sub

Sub LimparVel()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub

    For ºI = 1 To 4
        CadastroUnidades.Controls("TB_Percentual_" & ºI).Value = ""
        CadastroUnidades.Controls("TB_BGN_" & ºI).Value = ""
        CadastroUnidades.Controls("TB_DURACAO_" & ºI).Value = ""
    Next
End Sub
Sub ATTbdVel(ºLinBd As Integer)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub

    Campo = 1
    For Each ºLi In CadastroUnidades.LIST_Velocidade.ListItems
        If CadastroUnidades.Controls("TB_Percentual_" & Campo).Value <> "" And CadastroUnidades.Controls("TB_BGN_" & Campo).Value <> "" And _
        CadastroUnidades.Controls("TB_DURACAO_" & Campo).Value <> "" Then
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, ºCOLBD).Value = CadastroUnidades.Controls("TB_Percentual_" & Campo).Value
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, ºCOLBD + 1).Value = CadastroUnidades.Controls("TB_BGN_" & Campo).Value
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, ºCOLBD + 2).Value = CadastroUnidades.Controls("TB_DURACAO_" & Campo).Value
        Else
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, ºCOLBD).Value = ""
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, ºCOLBD + 1).Value = ""
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, ºCOLBD + 2).Value = ""
        End If
        Campo = Campo + 1
    Next
End Sub
Sub ATTVel(ºLinBd As Integer)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    Call LimparVel
    Campo = 1
    CadastroUnidades.TB_Vel_Name.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, 2).Text
    For ºCOLBD = 3 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, Columns.Count).End(xlToLeft).Column Step 3
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, ºCOLBD).Value <> "" Then
            CadastroUnidades.Controls("TB_Percentual_" & Campo).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, ºCOLBD).Text
            CadastroUnidades.Controls("TB_BGN_" & Campo).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, ºCOLBD + 1).Text
            CadastroUnidades.Controls("TB_DURACAO_" & Campo).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLinBd, ºCOLBD + 2).Text
        End If
        Campo = Campo + 1
    Next
    Call ATT_Percentual_vel
End Sub
Sub ATT_Percentual_vel()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    CadastroUnidades.LB_PRCT.Caption = ""
    For Each ºLi In CadastroUnidades.LIST_Velocidade.ListItems
        If Replace(ºLi, "%", "") <> "" Then
            ºPrtc = ºPrtc + CDbl(Replace(ºLi, "%", ""))
        End If
    Next
    CadastroUnidades.LB_PRCT.Caption = ºPrtc & "%"
End Sub
Sub TravarCampoV()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    CadastroUnidades.TB_Vel_Name.Enabled = False
    For ºI = 1 To 4
        CadastroUnidades.Controls("TB_Percentual_" & ºI).Enabled = False
        CadastroUnidades.Controls("TB_BGN_" & ºI).Enabled = False
        CadastroUnidades.Controls("TB_DURACAO_" & ºI).Enabled = False
    Next
    CadastroUnidades.BT_Save_Velocidade.Enabled = False
    CadastroUnidades.BT_Copy_Velocidade.Enabled = False
    CadastroUnidades.BT_Erase_Velocidade.Enabled = False
End Sub
Sub CarregarLB_Fase_Tipologia()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    For ºI = 1 To 30
        CadastroUnidades.Controls("LB_Fase_Tipologia_" & ºI).Clear
        For ºL = 1 To 10
            CadastroUnidades.Controls("LB_Fase_Tipologia_" & ºI).AddItem ºL
        Next
        If ºI < 11 Then
            CadastroUnidades.Controls("LB_Fase_Vaga_" & ºI).Clear
            For ºL = 1 To 10
                CadastroUnidades.Controls("LB_Fase_Vaga_" & ºI).AddItem ºL
            Next
        End If
    Next
    CadastroUnidades.CB_Fases.AddItem "TOTAL"
    For ºL = 1 To 10
        CadastroUnidades.CB_Fases.AddItem "FASE OBRA " & ºL
    Next
    
    CadastroUnidades.CB_Medias.AddItem "TOTAL"
    CadastroUnidades.CB_Medias.AddItem "LÍQUIDO"
End Sub

Sub AttBDTipologias()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    For ºI = 1 To 30
        ºC = Application.Match("Ativo", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = CadastroUnidades.Controls("CB_Tipologia_" & ºI).Value
        
        ºC = Application.Match("Fase", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = CadastroUnidades.Controls("LB_Fase_Tipologia_" & ºI).Value
        
        ºC = Application.Match("Descrição", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = CadastroUnidades.Controls("TB_Descricao_Tipologia_" & ºI).Value
        
        ºC = Application.Match("Unidades", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value
        
        ºC = Application.Match("Permutas", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = Replace(CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value, ",", ".")
        
        If CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value <> "" Then
            ºC = Application.Match("Area Privativa Coberta", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = CDbl(CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value)
        Else: ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = ""
        End If
        If CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value <> "" Then
            ºC = Application.Match("Preço do m² Privativo Coberto", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = CDbl(CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value)
        Else: ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = ""
        End If
        
        ºC = Application.Match("Area Privativa Descoberta", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = Replace(CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value, ",", ".")
        
        ºC = Application.Match("Fator", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value
        
        ºC = Application.Match("Vagas Vinculadas", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value = CadastroUnidades.Controls("TB_Vagas_Tipologia_" & ºI).Value
                
        ºC = Application.Match("VGV", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).FormulaR1C1 = "=(RC[-10]-RC[-9])*((RC[-8]*RC[-5]*R1C15)+(RC[-7]*RC[-6]*RC[-5]*R1C15))"
    
        ºC = Application.Match("R$ do M²", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).FormulaR1C1 = "=RC[-6]*R1C15"
    Next
    For ºI = 1 To 10
        ºC = Application.Match("Ativo", ThisWorkbook.Sheets("BD_CAD_VND").Rows(34), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value = CadastroUnidades.Controls("CB_Vaga_" & ºI).Value
        
        ºC = Application.Match("Fase", ThisWorkbook.Sheets("BD_CAD_VND").Rows(34), 0)
       ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value = CadastroUnidades.Controls("LB_Fase_Vaga_" & ºI).Value
                
        ºC = Application.Match("Unidades", ThisWorkbook.Sheets("BD_CAD_VND").Rows(34), 0)
       ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value = CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value
        
        ºC = Application.Match("Preço do M²", ThisWorkbook.Sheets("BD_CAD_VND").Rows(34), 0)
        If CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value <> "" Then
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value = Replace(CDbl(CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value), ",", ".")
        Else: ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value = ""
        End If
        
        ºC = Application.Match("Area Privativa", ThisWorkbook.Sheets("BD_CAD_VND").Rows(34), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value = 1
                
    Next
End Sub

Sub AttTipologias()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    For ºI = 1 To 30
        ºC = Application.Match("Ativo", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        CadastroUnidades.Controls("CB_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
        
        ºC = Application.Match("Fase", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        CadastroUnidades.Controls("LB_Fase_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
        
        ºC = Application.Match("Descrição", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        CadastroUnidades.Controls("TB_Descricao_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
        
        ºC = Application.Match("Unidades", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
        
        ºC = Application.Match("Permutas", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
        
        ºC = Application.Match("Area Privativa Coberta", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
        Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_" & ºI, 5)
        
        ºC = Application.Match("Preço do m² Privativo Coberto", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Text
        
        ºC = Application.Match("Area Privativa Descoberta", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
        Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_" & ºI, 5)
        
        ºC = Application.Match("Fator", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
        
        If CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value <> "" Then
            If CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value > 0 And CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value > 0 Then
                CadastroUnidades.Controls("TB_VGV_Tipologia_" & ºI).Value = Format((CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value * CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value) + (CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value * (Replace(CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value, "%", "") + 1 - 1) / 100 * CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value), "#,##0.00")
            Else
                CadastroUnidades.Controls("TB_VGV_Tipologia_" & ºI).Value = Format(CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value * CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value, "#,##0.00")
            End If
        End If
        
        ºC = Application.Match("Vagas Vinculadas", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        CadastroUnidades.Controls("TB_Vagas_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
       
    Next
    For ºI = 1 To 10
        ºC = Application.Match("Ativo", ThisWorkbook.Sheets("BD_CAD_VND").Rows(34), 0)
        CadastroUnidades.Controls("CB_Vaga_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value
        
        ºC = Application.Match("Fase", ThisWorkbook.Sheets("BD_CAD_VND").Rows(34), 0)
        CadastroUnidades.Controls("LB_Fase_Vaga_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value
                
        ºC = Application.Match("Unidades", ThisWorkbook.Sheets("BD_CAD_VND").Rows(34), 0)
        CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value
        
        ºC = Application.Match("Preço do M²", ThisWorkbook.Sheets("BD_CAD_VND").Rows(34), 0)
        CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Text
        
        If CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value <> "" Then
            CadastroUnidades.Controls("TB_VGV_Vaga_" & ºI).Value = Format(CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value / CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value, "#,##0.00")
        End If
    Next
End Sub


Sub OrganizarTabIndex()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    For ºI = 1 To 30
        CadastroUnidades.Controls("CB_Tipologia_" & ºI).tabIndex = 1 + (13 * (ºI - 1))
        CadastroUnidades.Controls("LB_Fase_Tipologia_" & ºI).tabIndex = 2 + (13 * (ºI - 1))
        CadastroUnidades.Controls("TB_Descricao_Tipologia_" & ºI).tabIndex = 3 + (13 * (ºI - 1))
        CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).tabIndex = 4 + (13 * (ºI - 1))
        CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).tabIndex = 5 + (13 * (ºI - 1))
        CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).tabIndex = 6 + (13 * (ºI - 1))
        CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).tabIndex = 7 + (13 * (ºI - 1))
        CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).tabIndex = 8 + (13 * (ºI - 1))
        CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).tabIndex = 9 + (13 * (ºI - 1))
        CadastroUnidades.Controls("TB_VGV_Tipologia_" & ºI).tabIndex = 10 + (13 * (ºI - 1))
        CadastroUnidades.Controls("TB_Vagas_Tipologia_" & ºI).tabIndex = 11 + (13 * (ºI - 1))
    Next
End Sub

Sub CarregarTotais()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    CadastroUnidades.Controls("LB_TT_U_1").Caption = 0
    CadastroUnidades.Controls("LB_TT_A_1").Caption = 0
    CadastroUnidades.Controls("LB_TT_TK_1").Caption = 0
    CadastroUnidades.Controls("LB_TT_V_1").Caption = 0
    
    CadastroUnidades.Controls("LB_TT_U_2").Caption = 0
    CadastroUnidades.Controls("LB_TT_A_2").Caption = 0
    CadastroUnidades.Controls("LB_TT_TK_2").Caption = 0
    CadastroUnidades.Controls("LB_TT_V_2").Caption = 0
    
    CadastroUnidades.Controls("LB_TT_U_3").Caption = 0
    CadastroUnidades.Controls("LB_TT_A_3").Caption = 0
    CadastroUnidades.Controls("LB_TT_TK_3").Caption = 0
    CadastroUnidades.Controls("LB_TT_V_3").Caption = 0
    For ºI = 1 To 30
        If CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value <> "" _
            And CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value <> "" Then
            If CadastroUnidades.CB_Fases.Value = "TOTAL" Or Replace(CadastroUnidades.CB_Fases.Value, "FASE OBRA ", "") = CadastroUnidades.Controls("LB_Fase_Tipologia_" & ºI) Then
                ºM² = 1 + CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value - 1
                If CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value = "" Then CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value = 0
                ºM²D = 1 + CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value - 1
                ºR$ = 1 + CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value - 1
                If CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value = "" Then CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value = 0
                ºFTR = (1 + Replace(CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value, "%", "") - 1) / 100
                ºUND = 1 + CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value - 1
                ºPRMT = 1 + CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value - 1
                
                CadastroUnidades.Controls("LB_TT_U_1").Caption = Format(CDbl(CadastroUnidades.Controls("LB_TT_U_1").Caption) + ºUND, "#,##0.00")
                CadastroUnidades.Controls("LB_TT_A_1").Caption = Format(CDbl(CadastroUnidades.Controls("LB_TT_A_1").Caption) + ((ºM² + ºM²D) * ºUND), "#,##0.00")
                CadastroUnidades.Controls("LB_TT_V_1").Caption = Format(CadastroUnidades.Controls("LB_TT_V_1").Caption + ((ºM² * ºR$ * ºUND) + (ºM²D * (ºR$ * ºFTR) * ºUND)), "#,##0.00")
                
                CadastroUnidades.Controls("LB_TT_U_2").Caption = Format(CDbl(CadastroUnidades.Controls("LB_TT_U_2").Caption) + ºPRMT, "#,##0.00")
                CadastroUnidades.Controls("LB_TT_A_2").Caption = Format(CDbl(CadastroUnidades.Controls("LB_TT_A_2").Caption) + ((ºM² * ºPRMT) + (ºM²D * ºPRMT)), "#,##0.00")
                CadastroUnidades.Controls("LB_TT_V_2").Caption = Format(CadastroUnidades.Controls("LB_TT_V_2").Caption + ((ºM² * ºR$ * ºPRMT) + (ºM²D * (ºR$ * ºFTR) * ºPRMT)), "#,##0.00")
                
                CadastroUnidades.Controls("LB_TT_U_3").Caption = Format(CDbl(CadastroUnidades.Controls("LB_TT_U_1").Caption) - CDbl(CadastroUnidades.Controls("LB_TT_U_2").Caption), "#,##0.00")
                CadastroUnidades.Controls("LB_TT_A_3").Caption = Format(CDbl(CadastroUnidades.Controls("LB_TT_A_1").Caption) - CDbl(CadastroUnidades.Controls("LB_TT_A_2").Caption), "#,##0.00")
                CadastroUnidades.Controls("LB_TT_V_3").Caption = Format(CDbl(CadastroUnidades.Controls("LB_TT_V_1").Caption) - CDbl(CadastroUnidades.Controls("LB_TT_V_2").Caption), "#,##0.00")
            End If
        End If
    Next
    If FormatDouble(CadastroUnidades.Controls("LB_TT_U_1").Caption) > 0 Then
        CadastroUnidades.Controls("LB_TT_TK_1").Caption = Format(FormatDouble(CadastroUnidades.Controls("LB_TT_V_1").Caption) / FormatDouble(CadastroUnidades.Controls("LB_TT_U_1").Caption), "#,##0.00")
    Else
        CadastroUnidades.Controls("LB_TT_TK_1").Caption = Format(0, "#,##0.00")
    End If
    
    If FormatDouble(CadastroUnidades.Controls("LB_TT_U_2").Caption) > 0 Then
        CadastroUnidades.Controls("LB_TT_TK_2").Caption = Format(FormatDouble(CadastroUnidades.Controls("LB_TT_V_2").Caption) / FormatDouble(CadastroUnidades.Controls("LB_TT_U_2").Caption), "#,##0.00")
    Else
        CadastroUnidades.Controls("LB_TT_TK_2").Caption = Format(0, "#,##0.00")
    End If
    
    If FormatDouble(CadastroUnidades.Controls("LB_TT_U_3").Caption) > 0 Then
        CadastroUnidades.Controls("LB_TT_TK_3").Caption = Format(FormatDouble(CadastroUnidades.Controls("LB_TT_V_3").Caption) / FormatDouble(CadastroUnidades.Controls("LB_TT_U_3").Caption), "#,##0.00")
    Else
        CadastroUnidades.Controls("LB_TT_TK_3").Caption = Format(0, "#,##0.00")
    End If
    
    For ºI = 1 To 10
        If CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value <> "" Then
            If CadastroUnidades.CB_Fases.Value = "TOTAL" Or Replace(CadastroUnidades.CB_Fases.Value, "FASE OBRA ", "") = CadastroUnidades.Controls("LB_Fase_Vaga_" & ºI) Then
                CadastroUnidades.Controls("LB_TT_V_1").Caption = Format(CadastroUnidades.Controls("LB_TT_V_1").Caption + (CDbl(CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value)), "#,##0,0000")
                CadastroUnidades.Controls("LB_TT_V_3").Caption = Format(CDbl(CadastroUnidades.Controls("LB_TT_V_1").Caption) - CDbl(CadastroUnidades.Controls("LB_TT_V_2").Caption), "#,##0,0000")
            End If
        End If
    Next
    ºUND = 0
    ºPRMT = 0
    For ºI = 1 To 30
        If CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value <> "" _
            And CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value <> "" Then
            ºM² = FormatDouble(CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value)
            ºM²D = FormatDouble(CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value)
            ºR$ = FormatDouble(CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value)
            ºFTR = FormatDouble(Replace(CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value, "%", "")) / 100
            
            ºUND = ºUND + FormatDouble(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value)
            ºPRMT = ºPRMT + FormatDouble(CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value)
            
            If CadastroUnidades.CB_Medias.Value = "TOTAL" Then
                ºM²_T = ºM²_T + (ºM² * FormatDouble(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value))
                ºM²D_T = ºM²D_T + (ºM²D * FormatDouble(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value))
            
                ºVGV1 = ºVGV1 + ((ºM² + (ºM²D * ºFTR)) * ºR$ * FormatDouble(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value))
                ºVGV2 = ºVGV2 + (ºM² * ºR$ * FormatDouble(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value))
            Else
                ºM²_T = ºM²_T + (ºM² * (FormatDouble(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value) - FormatDouble(CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value)))
                ºM²D_T = ºM²D_T + (ºM²D * (FormatDouble(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value) - FormatDouble(CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value)))
            
                ºVGV1 = ºVGV1 + ((ºM² + (ºM²D * ºFTR)) * ºR$ * (FormatDouble(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value) - FormatDouble(CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value)))
                ºVGV2 = ºVGV2 + (ºM² * ºR$ * (FormatDouble(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value) - FormatDouble(CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value)))
            End If
        End If
    Next
    
    
    If CadastroUnidades.CB_Medias.Value = "TOTAL" Then
        If ºUND > 0 Then CadastroUnidades.LB_PVT_MD.Caption = Format((ºM²_T + ºM²D_T) / ºUND, "#,##0.00")
    Else
        If ºUND > 0 Then CadastroUnidades.LB_PVT_MD.Caption = Format((ºM²_T + ºM²D_T) / (ºUND - ºPRMT), "#,##0.00")
    End If
    
    If ºM²_T > 0 Then CadastroUnidades.LB_COB_MD.Caption = Format(ºVGV2 / ºM²_T, "#,##0.00")
    If ºM²_T > 0 Then CadastroUnidades.LB_TOT_MD.Caption = Format(ºVGV1 / (ºM²D_T + ºM²_T), "#,##0.00")
    
    If CadastroUnidades.Associativo Then
        CadastroUnidades.AS_UNID_TOTAL.Caption = Format(ºUND - ºPRMT, "#,##0.00")
    End If
    
End Sub
Sub ATT_P_cap()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    For ºI = 1 To 30 Step 1
        If CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_VGV_Tipologia_" & ºI).Value <> "" Then
            ºPERMUTAS = ºPERMUTAS + CDbl(CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value)
            ºUNIDADES = ºUNIDADES + CDbl(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value)
            ºVgv = ºVgv + (CDbl(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value) * CDbl(CadastroUnidades.Controls("TB_VGV_Tipologia_" & ºI).Value))
            ºPRTMVGV = ºPRTMVGV + (CDbl(CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value) * CDbl(CadastroUnidades.Controls("TB_VGV_Tipologia_" & ºI).Value))
            ºAREA = ºAREA + (CDbl(CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value) * CDbl(CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value))
            ºPRTMAREA = ºPRTMAREA + (CDbl(CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value) * CDbl(CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value))
        End If
        If ºI < 11 Then
            If CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value <> "" Then
                ºUNIDADES = ºUNIDADES + CDbl(CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value)
                ºVgv = ºVgv + CDbl(CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value)
                'ºPRTMVGV = ºPRTMVGV + ((ºVgv / ºUnidades) * ºPERMUTAS)
            End If
        End If
    Next
    If ºPERMUTAS <> "" And ºUNIDADES <> "" Then
        If CadastroUnidades.OptionButton1.Value = True Then
            If ºVgv <> 0 Then CadastroUnidades.TB_Percent_Permuta.Value = Round((ºPRTMVGV / ºVgv) * 100, 4)
            Call FormatarNum("CadastroUnidades", "TB_Percent_Permuta", 4)
        Else
            If ºAREA <> 0 Then CadastroUnidades.TB_Percent_Permuta.Value = Round((ºPRTMAREA / ºAREA) * 100, 4)
            Call FormatarNum("CadastroUnidades", "TB_Percent_Permuta", 4)
            If ºVgv <> 0 Then CadastroUnidades.TB_Percent_Permuta_VGV.Caption = Round((ºPRTMVGV / ºVgv) * 100, 4)
            If Application.IfError(Application.Search("%", CadastroUnidades.TB_Percent_Permuta_VGV.Caption), 0) = 0 Then CadastroUnidades.TB_Percent_Permuta_VGV.Caption = CadastroUnidades.TB_Percent_Permuta_VGV.Caption & "%"
        End If
        If Application.IfError(Application.Search("%", CadastroUnidades.TB_Percent_Permuta.Value), 0) = 0 Then CadastroUnidades.TB_Percent_Permuta.Value = CadastroUnidades.TB_Percent_Permuta.Value & "%"
    End If
End Sub
Sub Mostrar(ºTPLG As Double)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If CadastroUnidades.Controls("CB_Tipologia_" & ºTPLG).Value = True And CadastroUnidades.Controls("CB_Tipologia_" & ºTPLG + 1).Value = False Then
        CadastroUnidades.Controls("LB_Fase_Tipologia_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_Descricao_Tipologia_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_Und_Tipologia_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_M²_Tipologia_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_VGV_Tipologia_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_Vagas_Tipologia_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("LB_Fase_Tipologia_" & ºTPLG).Value = 1
        CadastroUnidades.Controls("TB_Descricao_Tipologia_" & ºTPLG).Value = "Nova Tipologia"
        CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºTPLG).Value = 0
        CadastroUnidades.Controls("TB_Und_Tipologia_" & ºTPLG).Value = 0
        CadastroUnidades.Controls("TB_M²_Tipologia_" & ºTPLG).Value = 0
        CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºTPLG).Value = 0
        CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºTPLG).Value = 0
        CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºTPLG).Value = 0
        CadastroUnidades.Controls("TB_VGV_Tipologia_" & ºTPLG).Value = 0
        CadastroUnidades.Controls("TB_Vagas_Tipologia_" & ºTPLG).Value = 0
    ElseIf ºTPLG > 1 Then
        If CadastroUnidades.Controls("CB_Tipologia_" & ºTPLG - 1).Value Then
            CadastroUnidades.Controls("LB_Fase_Tipologia_" & ºTPLG).Visible = False
            CadastroUnidades.Controls("LB_Fase_Tipologia_" & ºTPLG).Value = ""
            CadastroUnidades.Controls("TB_Descricao_Tipologia_" & ºTPLG).Visible = False
            CadastroUnidades.Controls("TB_Descricao_Tipologia_" & ºTPLG).Value = ""
            CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºTPLG).Visible = False
            CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºTPLG).Value = ""
            CadastroUnidades.Controls("TB_Und_Tipologia_" & ºTPLG).Visible = False
            CadastroUnidades.Controls("TB_Und_Tipologia_" & ºTPLG).Value = ""
            CadastroUnidades.Controls("TB_M²_Tipologia_" & ºTPLG).Visible = False
            CadastroUnidades.Controls("TB_M²_Tipologia_" & ºTPLG).Value = ""
            CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºTPLG).Visible = False
            CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºTPLG).Value = ""
            CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºTPLG).Visible = False
            CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºTPLG).Value = ""
            CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºTPLG).Visible = False
            CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºTPLG).Value = ""
            CadastroUnidades.Controls("TB_VGV_Tipologia_" & ºTPLG).Visible = False
            CadastroUnidades.Controls("TB_VGV_Tipologia_" & ºTPLG).Value = ""
            CadastroUnidades.Controls("TB_Vagas_Tipologia_" & ºTPLG).Visible = False
            CadastroUnidades.Controls("TB_Vagas_Tipologia_" & ºTPLG).Value = ""
        Else
            CadastroUnidades.Controls("CB_Tipologia_" & ºTPLG).Value = False
        End If
    End If
    
    If CadastroUnidades.Controls("CB_Tipologia_" & ºTPLG + 1).Value Then CadastroUnidades.Controls("CB_Tipologia_" & ºTPLG).Value = True
    Call CarregarTotais
End Sub
Sub Mostrar_Vaga(ºTPLG As Double)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If CadastroUnidades.Controls("CB_Vaga_" & ºTPLG).Value = True Then
        CadastroUnidades.Controls("LB_Fase_Vaga_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_Und_Vaga_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_VGV_Vaga_" & ºTPLG).Visible = True
        CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºTPLG).Visible = True
    Else
        CadastroUnidades.Controls("LB_Fase_Vaga_" & ºTPLG).Visible = False
        CadastroUnidades.Controls("LB_Fase_Vaga_" & ºTPLG).Value = ""
        CadastroUnidades.Controls("TB_Und_Vaga_" & ºTPLG).Visible = False
        CadastroUnidades.Controls("TB_Und_Vaga_" & ºTPLG).Value = ""
        CadastroUnidades.Controls("TB_VGV_Vaga_" & ºTPLG).Visible = False
        CadastroUnidades.Controls("TB_VGV_Vaga_" & ºTPLG).Value = ""
        CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºTPLG).Visible = False
        CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºTPLG).Value = ""
    End If
    Call CarregarTotais
End Sub

Sub Carregar_Tabela_Selecionada(ºCod As Variant)
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If ºCod < 108 Then Exit Sub
    CadastroUnidades.List_Tabela.ListItems.Clear
    '---------------------------------------------------------  NOME  ---------------------------------------------------------------------------------------------------------------------------------
    CadastroUnidades.TB_Tbl_Name = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, 2).Text
    For ºC_TBL = 3 To 172 Step 9
        'Categorização
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL).Text <> "" Then
            '---------------------------------------------------------  TIPO  ---------------------------------------------------------------------------------------------------------------------------------
            ºCTIPO = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL).Text)
            Set Li = CadastroUnidades.List_Tabela.ListItems.Add(, , ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & Application.Match(ºCTIPO, ThisWorkbook.Sheets("BD_CAD_VND").Range("B523:B550")) + 522))
            '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
            Li.SubItems(1) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 1).Text
            '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(2) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 2).Text
            '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(3) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 3).Text
            '---------------------------------------------------------  JUROS  -------------------------------------------------------------------------------------------------------------------------------
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 4).Text = 0 Then
                Bol = "Não"
            ElseIf ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 4).Text = 1 Then
                Bol = "Sim"
            End If
            Li.SubItems(4) = Bol
            '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
            Li.SubItems(5) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 5).Text
            '---------------------------------------------------------  FIXAR INICIO  ----------------------------------------------------------------------------------------------------------------------
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 6).Text = 0 Then
                Bol = "Não"
            ElseIf ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 6).Text = 1 Then
                Bol = "Sim"
            End If
            Li.SubItems(6) = Bol
            '---------------------------------------------------------  FIXAR FIM  --------------------------------------------------------------------------------------------------------------------------
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 7).Text = 0 Then
                Bol = "Não"
            ElseIf ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 7).Text = 1 Then
                Bol = "Sim"
            End If
            Li.SubItems(7) = Bol
            '---------------------------------------------------------  MES FIM  ------------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(8) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, ºC_TBL + 8).Text
        End If
    Next
    CadastroUnidades.LB_ParcentualAtingido.Caption = " Os percentuais da curva somam " & Format(0, "0.00") & "% do VGV da unidade"
    ºPARCELAS = CadastroUnidades.List_Tabela.ListItems.Count
    For ºP = 1 To ºPARCELAS
        ºPrtc = ºPrtc + CDbl(Replace(CadastroUnidades.List_Tabela.ListItems(ºP).SubItems(3), "%", ""))
        CadastroUnidades.LB_ParcentualAtingido.Caption = " Os percentuais da curva somam " & Format(ºPrtc, "0.00") & "% do VGV da unidade"
    Next
    If ºPrtc = 100 Then
        CadastroUnidades.LB_ParcentualAtingido.ForeColor = &H80000012
    Else
        CadastroUnidades.LB_ParcentualAtingido.ForeColor = &HFF&
    End If
End Sub

Sub CarregarPerfil()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    LPerf = ThisWorkbook.Sheets("BD_CAD_VND").Cells(208, 2).End(xlUp).Row
    CadastroUnidades.CB_Select_Prf.Clear
    With CadastroUnidades
        For ºL = 159 To LPerf
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value <> "" Then
                .CB_Select_Prf.AddItem ºL - 158 & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºL).Value
            End If
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value = True Then
                .CB_Select_Prf.Value = ºL - 158 & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºL).Value
                .TB_Descrição_Perfil.Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºL).Value
                ' REGIME DE TRIBUTAÇÃO
                ºC = Application.Match("Regime de Tributação", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                a = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value
                If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = "RET" Then
                    .OB_RET = True
                    'ALIQUOTA RET
                    ºC = Application.Match("Aliquota RET", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                    .TB_TX_RET = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                    ºR = Application.Match("ºP_RET", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
                    .TB_TX_RET_P.Value = Format(Reeb_I_Permt_Fin, "0.00%")
                    .TB_TX_RET_P.Visible = True
                    .LBRET.Visible = True
                
                    .TB_TX_IRCSLL_P.Visible = False
                    .TB_TX_PISCOFINS_P.Visible = False
                    .LBPISCOFINS.Visible = False
                    .LBIRCLSS.Visible = False
                Else
                    .OB_Presumido.Value = True
                    'ALIQUOTA IR/CLSS
                    ºC = Application.Match("Aliquota IR/CSLL", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                    .TB_TX_IRCSLL.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                    'ALIQUOTA PIS/COFINS
                    ºC = Application.Match("Aliquota PIS/COFINS", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                    .TB_TX_PISCOFINS.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                
                    ºR = Application.Match("ºP_IRCSLL", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
                    .TB_TX_IRCSLL_P.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text
                    
                    ºR = Application.Match("ºP_PISCOFINS", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
                    .TB_TX_PISCOFINS_P.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text
                    
                    .TB_TX_IRCSLL_P.Visible = True
                    .TB_TX_PISCOFINS_P.Visible = True
                    .LBPISCOFINS.Visible = True
                    .LBIRCLSS.Visible = True
                    
                    .TB_TX_RET_P.Visible = False
                    .LBRET.Visible = False
                End If
                'COMISSÃO EFETIVA
                ºC = Application.Match("Comissão Indireta", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .TB_CMSS_INT.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'COMISSÃO DIRETA
                ºC = Application.Match("Comissão Direta", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .TB_CMSS_DIR.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'MARKETING
                ºC = Application.Match("Marketing", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .TB_MKTG.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'PDV
                ºC = Application.Match("PDV", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .TB_PDV.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'E-Business
                ºC = Application.Match("E-Business", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .TB_EBUSINESS.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'PRÊMIO
                ºC = Application.Match("Prêmio", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .TB_PREMIO.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'CONDOMINIO
                ºC = Application.Match("Valor Condominio", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .TB_Condominio.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'FATOR CONDOMINIO
                ºC = Application.Match("Fator C", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .CB_FTR_Condominio.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'IPTU
                ºC = Application.Match("IPTU", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .TB_IPTU.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'FATOR IPTU
                ºC = Application.Match("Fator I", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .CB_FTR_IPTU.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'TAXA VP
                ºC = Application.Match("Taxa VP", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .TB_TX_VP.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
                'TX ADM CARTERA
                ºC = Application.Match("ADM Carteira", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                .TB_ADM_CARTEIRA = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
            End If
        Next
        
        'Participação Permutante
        
        'FISICA
        ºR = Application.Match("ºP_FISICA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .TB_PARTICIPAÇÃO_FISICA.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text
        'FINANCEIRA
        ºR = Application.Match("ºP_FINANC", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .TB_PARTICIPAÇÃO_FINANC.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text
        'MAJORAR
        
        'Comissão Indireta
        ºR = Application.Match("ºMJ_CMSS", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .MJ_CMSS.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        'Prêmio
        ºR = Application.Match("ºMJ_PREMIO", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .MJ_PREMIO = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        'Marketing
        ºR = Application.Match("ºMJ_MKT", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .MJ_MKTG = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        'PDV
        ºR = Application.Match("ºMJ_PDV", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .MJ_PDV = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        'E-Business
        ºR = Application.Match("ºMJ_EB", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .MJ_EB = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        'Taxa de Administração
        ºR = Application.Match("ºMJ_TX_ADM", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .MJ_TX_ADM = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
    End With
End Sub

Sub DescarregarPerfil()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    LPerf = ThisWorkbook.Sheets("BD_CAD_VND").Cells(208, 2).End(xlUp).Row
    With CadastroUnidades
        For ºL = 159 To LPerf
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value = True Then
                ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºL).Value = .TB_Descrição_Perfil.Value
                ' REGIME DE TRIBUTAÇÃO
                If .OB_RET = True Then
                    ºC = Application.Match("Regime de Tributação", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = "RET"
                    'ALIQUOTA RET
                    ºC = Application.Match("Aliquota RET", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_TX_RET
                    ºR = Application.Match("ºP_RET", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
                    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_TX_RET_P.Value
                Else
                    ºC = Application.Match("Regime de Tributação", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = "Presumido"
                    'ALIQUOTA IR/CLSS
                    ºC = Application.Match("Aliquota IR/CSLL", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_TX_IRCSLL.Value
                    'ALIQUOTA PIS/COFINS
                    ºC = Application.Match("Aliquota PIS/COFINS", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_TX_PISCOFINS.Value
                    
                    ºR = Application.Match("ºP_IRCSLL", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
                    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_TX_IRCSLL_P.Value
                    
                    ºR = Application.Match("ºP_PISCOFINS", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
                    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_TX_PISCOFINS_P.Value
                End If
                'COMISSÃO INDIRETA
                ºC = Application.Match("Comissão Indireta", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_CMSS_INT.Value
                'COMISSÃO DIRETA
                ºC = Application.Match("Comissão Direta", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_CMSS_DIR.Value
                'MARKETING
                ºC = Application.Match("Marketing", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_MKTG.Value
                'PDV
                ºC = Application.Match("PDV", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_PDV.Value
                'E-Business
                ºC = Application.Match("E-Business", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_EBUSINESS.Value
                'PRÊMIO
                ºC = Application.Match("Prêmio", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_PREMIO.Value
                'CONDOMINIO
                ºC = Application.Match("Valor Condominio", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_Condominio.Value
                'FATOR CONDOMINIO
                ºC = Application.Match("Fator C", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .CB_FTR_Condominio.Value
                'IPTU
                ºC = Application.Match("IPTU", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_IPTU.Value
                'FATOR IPTU
                ºC = Application.Match("Fator I", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .CB_FTR_IPTU.Value
                'TAXA VP
                ºC = Application.Match("Taxa VP", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_TX_VP.Value
                'TX ADM CARTERA
                ºC = Application.Match("ADM Carteira", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = .TB_ADM_CARTEIRA
            End If
        Next
        
        'Participação Permutante
        
        'FISICA
        ºR = Application.Match("ºP_FISICA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_PARTICIPAÇÃO_FISICA.Value
        'FINANCEIRA
        ºR = Application.Match("ºP_FINANC", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_PARTICIPAÇÃO_FINANC.Value
        
        'MAJORAR
        
        'Comissão Indireta
        ºR = Application.Match("ºMJ_CMSS", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .MJ_CMSS.Value
        'Prêmio
        ºR = Application.Match("ºMJ_PREMIO", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .MJ_PREMIO
        'Marketing
        ºR = Application.Match("ºMJ_MKT", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .MJ_MKTG
        'PDV
        ºR = Application.Match("ºMJ_PDV", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .MJ_PDV
        'E-Business
        ºR = Application.Match("ºMJ_EB", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .MJ_EB
        'Taxa de Administração
        ºR = Application.Match("ºMJ_TX_ADM", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .MJ_TX_ADM
        
        'OBSERVAÇÃO
        ThisWorkbook.Sheets("BD_CAD_VND").Range("C898").Value = .OBSERVAÇÕES.Value
    
    End With
End Sub

Sub CarregarFases()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    LPFases = ThisWorkbook.Sheets("BD_CAD_VND").Cells(259, 2).End(xlUp).Row
    With CadastroUnidades.LV_FasesObra
        'adiciona colunas
        With .ColumnHeaders
            .Clear
            .Add , , "Fase", 45
            .Add , , "Curva de Obra", 60, lvwColumnCenter
            .Add , , "Area Privativa", 60, lvwColumnCenter
            .Add , , "Area Construída", 60, lvwColumnCenter
            .Add , , "R$ m² Construido C/ TX", 100, lvwColumnCenter
            .Add , , "R$ m² Privativo C/ TX", 100, lvwColumnCenter
            .Add , , "Taxa Adm. Gerencial", 80, lvwColumnCenter
            .Add , , "Taxa Adm. Externa", 80, lvwColumnCenter
            .Add , , "Despesa com DTAS", 80, lvwColumnCenter
            .Add , , "Inicio", 60, lvwColumnCenter
            .Add , , "Duração", 60, lvwColumnCenter
            .Add , , "% do Projeto", 60, lvwColumnCenter
            .Add , , "Custo da Curva", 60, lvwColumnCenter
            .Add , , "Incorrido", 60, lvwColumnCenter
        End With
        .View = lvwReport
        .FullRowSelect = True
        .ListItems.Clear
        For ºL = 210 To LPFases
            Set ºLi = .ListItems.Add(, , ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value)
            ' CURVA
            ºC = Application.Match("Curva", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(1) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
            
            '  INCORRIDO DA CURVA
            ºC = Application.Match("Incorrido", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value Then ºLi.SubItems(13) = Format(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value, "#,##0.00") Else ºLi.SubItems(13) = "0.00"
            ' CUSTO DA CURVA
            ºC = Application.Match("VALOR CURVA", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(12) = Format(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value + CDbl(ºLi.SubItems(13)), "#,##0.00")
           
           ' AREA PRIVATIVA
            ºC = Application.Match("Area  Privativa", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(2) = Format(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value, "#,##0.00")
            ' AREA CONSTRUIDA
            ºC = Application.Match("Area Construida", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(3) = Format(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value, "#,##0.00")
            ' CUSTO METRO CONSTRUIDO
            ºC = Application.Match("Custo Metro Construido", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(4) = Format(ºLi.SubItems(12) / ºLi.SubItems(3), "#,##0.00")
            ' CUSTO METRO PRIVATIVO
            ºC = Application.Match("Custo Metro Privativo", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(5) = Format(ºLi.SubItems(12) / ºLi.SubItems(2), "#,##0.00")
            ' TAXA ADM GERENCIAL
            ºC = Application.Match("Taxa adm ger", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(6) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
            ' TAXA ADM EFETIVA
            ºC = Application.Match("Taxa adm ext", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(7) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
            ' TAXA DTAS
            ºC = Application.Match("taxa DTAS", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(8) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
            ' INICIO
            ºC = Application.Match("inicio", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(9) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value
            ' DURAÇÃO
            ºC = Application.Match("duração", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(10) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value
            ' % do Projeto
            ºC = Application.Match("% do Projeto", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ºLi.SubItems(11) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Text
        Next
    End With
End Sub

Sub DescarregarFases()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades.LV_FasesObra
        LPFases = .ListItems.Count
        For ºL = 1 To LPFases
            Set ºLi = .ListItems(ºL)
            ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL + 209).Value = ºLi.Text
            ' CURVA
            ºC = Application.Match("Curva", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = ºLi.SubItems(1)
            
            ' Incorrido
            ºC = Application.Match("Incorrido", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = ºLi.SubItems(13)
            ' CUSTO DA CURVA
            ºC = Application.Match("VALOR CURVA", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = ºLi.SubItems(12) - ºLi.SubItems(13)
            
            ' AREA PRIVATIVA
            ºC = Application.Match("Area  Privativa", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = Replace(Replace(ºLi.SubItems(2), ".", ""), ",", ".")
            ' AREA CONSTRUIDA
            ºC = Application.Match("Area Construida", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = ºLi.SubItems(3)
            ' CUSTO METRO CONSTRUIDO
            ºC = Application.Match("Custo Metro Construido", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = (ºLi.SubItems(12) - ºLi.SubItems(13)) / ºLi.SubItems(3)
            ' CUSTO METRO PRIVATIVO
            ºC = Application.Match("Custo Metro Privativo", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = (ºLi.SubItems(12) - ºLi.SubItems(13)) / ºLi.SubItems(2)
            ' TAXA ADM GERENCIAL
            ºC = Application.Match("Taxa adm ger", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = ºLi.SubItems(6)
            ' TAXA ADM EFETIVA
            ºC = Application.Match("Taxa adm ext", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = ºLi.SubItems(7)
            ' TAXA DTAS
            ºC = Application.Match("taxa DTAS", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = ºLi.SubItems(8)
            ' INICIO
            ºC = Application.Match("inicio", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = ºLi.SubItems(9)
            ' DURAÇÃO
            ºC = Application.Match("duração", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = ºLi.SubItems(10)
            ' % do Projeto
            ºC = Application.Match("% do Projeto", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = ºLi.SubItems(11)
            ' Valor Marjorado
            ºC = Application.Match("Valor Marjorado", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).FormulaR1C1 = "=(((RC[-1]+RC[4])*R1C17)/(SUMPRODUCT(RC[-7]:RC[-5]*1)+1))-RC[4]"
            ' Valor taxa gererncial
            ºC = Application.Match("Valor taxa gererncial", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = "=RC[-1]*RC[-8]"
            ' Valor taxa gererncial
            ºC = Application.Match("Valor taxa efetiva", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = "=RC[-2]*RC[-8]"
            ' Valor Dtas
            ºC = Application.Match("Valor Dtas", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL + 209, ºC).Value = "=RC[-3]*RC[-8]"
        Next
    End With
End Sub


Sub CarregarCurvasOB()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If ThisWorkbook.Sheets("BD_CAD_VND").Cells(260, Columns.Count).End(xlToLeft).Column > 1 Then
        With CadastroUnidades.LV_CurvasObra
            'adiciona colunas
            With .ColumnHeaders
                .Clear
                .Add , , "Mês", 28
            End With
            .View = lvwReport
            .FullRowSelect = True
            .ListItems.Clear
            Menor = 0
            Maior = 0
            For ºC = 2 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(260, Columns.Count).End(xlToLeft).Column
                ºDT_OBRA = DIF_DT_LCTO(ThisWorkbook.Sheets("BD_CAD_VND").Cells(261, ºC).Value, 0)
                If Menor > ºDT_OBRA Then Menor = ºDT_OBRA
                If Maior < ((ThisWorkbook.Sheets("BD_CAD_VND").Cells(461, ºC).End(xlUp).Row - 261) + ºDT_OBRA - 1) Then Maior = (ThisWorkbook.Sheets("BD_CAD_VND").Cells(461, ºC).End(xlUp).Row - 261) + ºDT_OBRA - 1
            Next
            For ºL = Menor To Maior + 1
                Set ºLi = .ListItems.Add(, , ºL)
            Next
            For ºC = 2 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(260, Columns.Count).End(xlToLeft).Column
                If ThisWorkbook.Sheets("BD_CAD_VND").Cells(2, ºC).Value <> "" Then
                    .ColumnHeaders.Add , , ºC - 1 & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Cells(260, ºC).Value, 60
                    LPCurvas = ThisWorkbook.Sheets("BD_CAD_VND").Cells(461, ºC).End(xlUp).Row
                    ºDT_OBRA = DIF_DT_LCTO(ThisWorkbook.Sheets("BD_CAD_VND").Cells(261, ºC).Value, 0)
                    If Menor <> ºDT_OBRA Then
                        For ºL = Menor To ºDT_OBRA
                            Set ºLi = .ListItems(ºL - Menor + 1)
                            ºLi.SubItems(ºC - 1) = Format(0, "0.00%")
                        Next
                    End If
                    For ºL = 262 To LPCurvas
                        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value <> "" Then
                            Set ºLi = .ListItems(ºL - 261 + ºDT_OBRA - Menor)
                            ºLi.SubItems(ºC - 1) = Format(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value, "0.00%")
                        End If
                    Next
               End If
            Next
        End With
    End If
End Sub

Sub TotaisObra()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºTaxas = 0
    If CadastroUnidades.TB_Area_Total_PVT.Value = "" Or CadastroUnidades.TB_Custo_Metro.Value = "" Then
        CadastroUnidades.TB_VLR_ADM_GER.Value = ""
        CadastroUnidades.TB_VLR_ADM_EXT.Value = ""
        CadastroUnidades.TB_VLR_DTAS_2.Value = ""
        CadastroUnidades.TB_CUSTO_P_TAXAS.Value = ""
        CadastroUnidades.TB_TT_S_TX.Value = ""
        CadastroUnidades.TB_CUSTO_TOTAL2.Value = ""
    Else
        CadastroUnidades.TB_TT_S_TX.Value = Format(CadastroUnidades.TB_Area_Total_PVT.Value * CadastroUnidades.TB_Custo_Metro.Value, "#,##0.00")
        If CadastroUnidades.TB_TX_ADM_GER.Value <> "" Then
            CadastroUnidades.TB_VLR_ADM_GER.Value = Format(CadastroUnidades.TB_TT_S_TX.Value * (CDbl(Replace(CadastroUnidades.TB_TX_ADM_GER.Value, "%", "")) / 100), "#,##0")
            ºTaxas = ºTaxas + CadastroUnidades.TB_VLR_ADM_GER.Value
        End If
        If CadastroUnidades.TB_TX_ADM_EXT.Value <> "" Then
            CadastroUnidades.TB_VLR_ADM_EXT.Value = Format(CadastroUnidades.TB_TT_S_TX.Value * (CDbl(Replace(CadastroUnidades.TB_TX_ADM_EXT.Value, "%", "")) / 100), "#,##0")
            ºTaxas = ºTaxas + CadastroUnidades.TB_VLR_ADM_EXT.Value
        End If
        If CadastroUnidades.TB_TX_DTAS_2.Value <> "" Then
            CadastroUnidades.TB_VLR_DTAS_2.Value = Format(CadastroUnidades.TB_TT_S_TX.Value * (CDbl(Replace(CadastroUnidades.TB_TX_DTAS_2.Value, "%", "")) / 100), "#,##0")
            ºTaxas = ºTaxas + CadastroUnidades.TB_VLR_DTAS_2.Value
        End If
        CadastroUnidades.TB_CUSTO_P_TAXAS.Value = Format((CDbl(CadastroUnidades.TB_TT_S_TX.Value) + ºTaxas) / CDbl(CadastroUnidades.TB_Area_Total_PVT), "#,##0.00")
        CadastroUnidades.TB_CUSTO_TOTAL2.Value = Format(CadastroUnidades.TB_CUSTO_P_TAXAS.Value * CDbl(CadastroUnidades.TB_Area_Total_PVT), "#,##0.00")
        Call C_Totais
    End If
End Sub
Sub TotaisObra_2()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        ºTaxas = 0
        If .TB_Area_Total_PVT.Value = "" Or .TB_CUSTO_P_TAXAS.Value = "" Then
            .TB_VLR_ADM_GER.Value = ""
            .TB_VLR_ADM_EXT.Value = ""
            .TB_VLR_DTAS_2.Value = ""
            .TB_CUSTO_P_TAXAS.Value = ""
            .TB_TT_S_TX.Value = ""
            .TB_CUSTO_TOTAL2.Value = ""
        Else
            If .Custo_Obra_Pvt.Value = "Custo do m² Pvt. C/ Taxas" Then
                'CONTABILIZA CUSTO TOTAL
                .TB_CUSTO_TOTAL2.Value = CDbl(.TB_Area_Total_PVT) * CDbl(.TB_CUSTO_P_TAXAS.Value)
                Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_TOTAL2", 2)
                
                'INFORMA ZERO NAS TAXAS EM BRANCO
                If .TB_TX_ADM_GER.Value = "" Then .TB_TX_ADM_GER = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_GER", 2)
                If .TB_TX_ADM_EXT.Value = "" Then .TB_TX_ADM_EXT = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_EXT", 2)
                If .TB_TX_DTAS_2.Value = "" Then .TB_TX_DTAS_2 = "0"
                Call FormatarNum("CadastroUnidades", "TB_TX_DTAS_2", 2)
                
                'CONTABILIZA O TOTAL DAS TAXAS
                ºTaxas = 0
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_GER, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_EXT, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_DTAS_2, "%", "") / 100)
                
                'CALCULA O CUSTO POR M² PVT SEM TAXAS
                .TB_Custo_Metro = .TB_CUSTO_P_TAXAS / (1 + ºTaxas)
                Call FormatarNumCur("CadastroUnidades", "TB_Custo_Metro", 2)
                                
                'CALCULA O CUSTO RASO
                .TB_TT_S_TX = CDbl(.TB_Custo_Metro) * CDbl(.TB_Area_Total_PVT)
                Call FormatarNumCur("CadastroUnidades", "TB_TT_S_TX", 2)
                
                'TAXA ADM GERENCIAL
                .TB_VLR_ADM_GER.Value = (Replace(.TB_TX_ADM_GER, "%", "") / 100) * .TB_TT_S_TX
                Call FormatarNumCur("CadastroUnidades", "TB_VLR_ADM_GER", 0)
                'TAXA ADM EFETIVA
                .TB_VLR_ADM_EXT.Value = (Replace(.TB_TX_ADM_EXT, "%", "") / 100) * .TB_TT_S_TX
                Call FormatarNumCur("CadastroUnidades", "TB_VLR_ADM_EXT", 0)
                'TAXA DTAS
                .TB_VLR_DTAS_2.Value = (Replace(.TB_TX_DTAS_2, "%", "") / 100) * .TB_TT_S_TX
                Call FormatarNumCur("CadastroUnidades", "TB_VLR_DTAS_2", 0)
                
                'M2 CONSTRUÍDO COM TAXAS
                If .TB_Area_Total_C = "" Then .TB_Area_Total_C.Value = .TB_Area_Total_PVT
                If .TB_Area_Total_C <> "" Then
                    If CDbl(.TB_Area_Total_C) = 0 Then .TB_Area_Total_C.Value = .TB_Area_Total_PVT
                End If
                .TB_CUSTO_C.Value = CDbl(.TB_CUSTO_TOTAL2) / CDbl(.TB_Area_Total_C)
                Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_C", 2)
            Else
            
                'CALCULA O CUSTO RASO
                .TB_TT_S_TX = CDbl(.TB_CUSTO_P_TAXAS) * CDbl(.TB_Area_Total_PVT)
                Call FormatarNumCur("CadastroUnidades", "TB_TT_S_TX", 2)
                            
                'INFORMA ZERO NAS TAXAS EM BRANCO
                If .TB_TX_ADM_GER.Value = "" Then .TB_TX_ADM_GER = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_GER", 2)
                If .TB_TX_ADM_EXT.Value = "" Then .TB_TX_ADM_EXT = 0
                Call FormatarNum("CadastroUnidades", "TB_TX_ADM_EXT", 2)
                If .TB_TX_DTAS_2.Value = "" Then .TB_TX_DTAS_2 = "0"
                Call FormatarNum("CadastroUnidades", "TB_TX_DTAS_2", 2)
                
                'CONTABILIZA O TOTAL DAS TAXAS
                ºTaxas = 0
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_GER, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_ADM_EXT, "%", "") / 100)
                ºTaxas = ºTaxas + (Replace(.TB_TX_DTAS_2, "%", "") / 100)
                
                'CALCULA O CUSTO POR M² PVT COM TAXAS
                .TB_Custo_Metro = .TB_CUSTO_P_TAXAS * (1 + ºTaxas)
                Call FormatarNumCur("CadastroUnidades", "TB_Custo_Metro", 2)
                
                'CONTABILIZA CUSTO TOTAL
                .TB_CUSTO_TOTAL2.Value = CDbl(.TB_Area_Total_PVT) * CDbl(.TB_Custo_Metro)
                Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_TOTAL2", 2)
                
                'TAXA ADM GERENCIAL
                .TB_VLR_ADM_GER.Value = (Replace(.TB_TX_ADM_GER, "%", "") / 100) * .TB_TT_S_TX
                Call FormatarNumCur("CadastroUnidades", "TB_VLR_ADM_GER", 0)
                'TAXA ADM EFETIVA
                .TB_VLR_ADM_EXT.Value = (Replace(.TB_TX_ADM_EXT, "%", "") / 100) * .TB_TT_S_TX
                Call FormatarNumCur("CadastroUnidades", "TB_VLR_ADM_EXT", 0)
                'TAXA DTAS
                .TB_VLR_DTAS_2.Value = (Replace(.TB_TX_DTAS_2, "%", "") / 100) * .TB_TT_S_TX
                Call FormatarNumCur("CadastroUnidades", "TB_VLR_DTAS_2", 0)
                
                'M2 CONSTRUÍDO COM TAXAS
                If FormatDouble(.TB_Area_Total_C) = 0 Then .TB_Area_Total_C.Value = .TB_Area_Total_PVT
                .TB_CUSTO_C.Value = CDbl(.TB_CUSTO_TOTAL2) / CDbl(.TB_Area_Total_C)
                Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_C", 2)
            End If
        End If
    End With
    Call SalvarFase
End Sub



Sub CarregarfasesLB(Optional Novo As Boolean)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub

    CadastroUnidades.CB_Fase.Clear
    If Novo Then
        For ºI = CadastroUnidades.LV_FasesObra.ListItems.Count + 1 To 20
            If Application.IfError(Application.CountIf(ThisWorkbook.Sheets("BD_CAD_VND").Range("B210:B259"), ºI), 0) = 0 Then
               CadastroUnidades.CB_Fase.AddItem ºI
            End If
        Next
    Else
        For ºI = 1 To 20
            CadastroUnidades.CB_Fase.AddItem ºI
        Next
    End If
End Sub
Sub LOAD_PEP()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    CadastroUnidades.CB_PEP.Clear
    CadastroUnidades.CB_PEP.AddItem "1 TERRENO"
    CadastroUnidades.CB_PEP.AddItem "2 PROPAGANDA"
    CadastroUnidades.CB_PEP.AddItem "3 OBRA"
    CadastroUnidades.CB_PEP.AddItem "3.4 INCORPORAÇÃO"
    CadastroUnidades.CB_PEP.AddItem "4 RELACIONAMENTO"
    CadastroUnidades.CB_PEP.AddItem "5 DTAS"
    CadastroUnidades.CB_PEP.AddItem "6 COMERCIAL"
    CadastroUnidades.CB_PEP.AddItem "8 ADM. DE CARTEIRA"
    CadastroUnidades.CB_PEP.AddItem "8.3 DESP. C/ FINANC. (CA)"
    CadastroUnidades.CB_PEP.AddItem "OUTRAS RECEITAS"
    CadastroUnidades.PEP_FILTRO.Clear
    CadastroUnidades.PEP_FILTRO.AddItem "1 TERRENO"
    CadastroUnidades.PEP_FILTRO.AddItem "2 PROPAGANDA"
    CadastroUnidades.PEP_FILTRO.AddItem "3 OBRA"
    CadastroUnidades.PEP_FILTRO.AddItem "3.4 INCORPORAÇÃO"
    CadastroUnidades.PEP_FILTRO.AddItem "4 RELACIONAMENTO"
    CadastroUnidades.PEP_FILTRO.AddItem "5 DTAS"
    CadastroUnidades.PEP_FILTRO.AddItem "6 COMERCIAL"
    CadastroUnidades.PEP_FILTRO.AddItem "8 ADM. DE CARTEIRA"
    CadastroUnidades.PEP_FILTRO.AddItem "8.3 DESP. C/ FINANC. (CA)"
    CadastroUnidades.PEP_FILTRO.AddItem "OUTRAS RECEITAS"
End Sub
Sub CarregarCurvasLB()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    CadastroUnidades.CB_Curva.Clear
    For ºC = 2 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(260, Columns.Count).End(xlToLeft).Column
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(260, ºC).Value <> "" Then
            CadastroUnidades.CB_Curva.AddItem ºC - 1 & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Cells(260, ºC).Value
        End If
    Next
End Sub

Sub Limpar_PG_Curva()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    'Call CarregarfasesLB(True)
    With CadastroUnidades
        .CB_Fase.Value = ""
        .CB_Curva.Value = ""
        .TB_Area_Total_C.Value = ""
        .TB_Custo_Metro.Value = ""
        .TB_TT_S_TX.Value = ""
        .TB_TX_ADM_GER.Value = ""
        .TB_VLR_ADM_GER.Value = ""
        .TB_TX_ADM_EXT.Value = ""
        .TB_VLR_ADM_EXT.Value = ""
        .TB_TX_DTAS_2.Value = ""
        .TB_VLR_DTAS_2.Value = ""
        .TB_INI_OBRA.Value = ""
        .TB_DURACAO.Value = ""
        .TB_INCORRIDO.Value = ""
        .TB_CUSTO_C.Value = ""
        .TB_CUSTO_P_TAXAS.Value = ""
        .TB_CUSTO_TOTAL2.Value = ""
        .TB_Prct_Area_PVT.Value = ""
        .TB_Area_Total_PVT.Value = ""
    End With
End Sub


Sub Cont_Area_PVT(Fase As Integer)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & Fase + 497).Value = ""
    ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & Fase + 497).Value = ""
    For ºL = 3 To 33
        If ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºL).Value = Fase Then
            ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & Fase + 497).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & Fase + 497).Value + (ThisWorkbook.Sheets("BD_CAD_VND").Range("E" & ºL).Value * ThisWorkbook.Sheets("BD_CAD_VND").Range("G" & ºL).Value)
            ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & Fase + 497).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & Fase + 497).Value + (ThisWorkbook.Sheets("BD_CAD_VND").Range("E" & ºL).Value * ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºL).Value)
        End If
    Next
End Sub

Sub SalvarFase()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        Dim Check As Boolean
        Dim ºCURVA As Integer
        Check = True
        If .TB_Custo_Metro.Value = "" Then Check = False
        If .CB_Curva.Value = "" Then Check = False
        If .TB_TX_ADM_GER.Value = "" Then Check = False
        If .TB_VLR_ADM_GER.Value = "" Then Check = False
        If .TB_TX_ADM_EXT.Value = "" Then Check = False
        If .TB_VLR_ADM_EXT.Value = "" Then Check = False
        If .TB_TX_DTAS_2.Value = "" Then Check = False
        If .TB_VLR_DTAS_2.Value = "" Then Check = False
        If .TB_Area_Total_C.Value = "" Then Check = False
        If .TB_CUSTO_P_TAXAS.Value = "" Then Check = False
        If .TB_INI_OBRA.Value = "" Then Check = False
        If .TB_DURACAO.Value = "" Then Check = False
        If .TB_INCORRIDO.Value = "" Then .TB_INCORRIDO.Value = "0,00"
        If Check Then
            ºCURVA = CInt(Left(.CB_Curva.Value, Application.Search("|", .CB_Curva.Value) - 2))
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(261, 1 + ºCURVA).Value = .TB_INI_OBRA.Value
            ºFASE = CDbl(.CB_Fase.Value)
            If .LV_FasesObra.ListItems.Count >= ºFASE Then
                .LV_FasesObra.ListItems(ºFASE).SubItems(1) = Left(.CB_Curva.Value, Application.Search(" | ", .CB_Curva.Value) - 1)
                .LV_FasesObra.ListItems(ºFASE).SubItems(2) = .TB_Area_Total_PVT
                .LV_FasesObra.ListItems(ºFASE).SubItems(3) = .TB_Area_Total_C.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(4) = .TB_CUSTO_C.Value
                If .Custo_Obra_Pvt.Value = "Custo do m² Pvt. C/ Taxas" Then
                    .LV_FasesObra.ListItems(ºFASE).SubItems(5) = .TB_CUSTO_P_TAXAS.Value
                Else
                    .LV_FasesObra.ListItems(ºFASE).SubItems(5) = .TB_Custo_Metro.Value
                End If
                .LV_FasesObra.ListItems(ºFASE).SubItems(6) = .TB_TX_ADM_GER.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(7) = .TB_TX_ADM_EXT.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(8) = .TB_TX_DTAS_2.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(9) = .TB_INI_OBRA.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(10) = .TB_DURACAO.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(11) = .TB_Prct_Area_PVT.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(12) = .TB_CUSTO_TOTAL2.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(13) = .TB_INCORRIDO.Value
            Else
                .LV_FasesObra.ListItems.Add , , ºFASE
                .LV_FasesObra.ListItems(ºFASE).SubItems(1) = Left(.CB_Curva.Value, Application.Search(" | ", .CB_Curva.Value) - 1)
                .LV_FasesObra.ListItems(ºFASE).SubItems(2) = .TB_Area_Total_PVT
                .LV_FasesObra.ListItems(ºFASE).SubItems(3) = .TB_Area_Total_C.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(4) = .TB_CUSTO_C.Value
                If .Custo_Obra_Pvt.Value = "Custo do m² Pvt. C/ Taxas" Then
                    .LV_FasesObra.ListItems(ºFASE).SubItems(5) = .TB_CUSTO_P_TAXAS.Value
                Else
                    .LV_FasesObra.ListItems(ºFASE).SubItems(5) = .TB_Custo_Metro.Value
                End If
                .LV_FasesObra.ListItems(ºFASE).SubItems(6) = .TB_TX_ADM_GER.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(7) = .TB_TX_ADM_EXT.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(8) = .TB_TX_DTAS_2.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(9) = .TB_INI_OBRA.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(10) = .TB_DURACAO.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(11) = .TB_Prct_Area_PVT.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(12) = .TB_CUSTO_TOTAL2.Value
                .LV_FasesObra.ListItems(ºFASE).SubItems(13) = .TB_INCORRIDO.Value
            End If
            Call TotalizarCusto
            Call DescarregarFases
            .LV_CurvasObra.ColumnHeaders.Clear
            .LV_CurvasObra.ListItems.Clear
            Call CarregarCurvasOB
            .AlertaObra.Caption = ""
        Else
            .AlertaObra.Caption = "Todos campos devem estar preenchidos para gravar as alterações!!!"
        End If
    End With
End Sub

Sub HabilitarBTCVO()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    CadastroUnidades.CB_Fase.Enabled = True
    CadastroUnidades.TB_Custo_Metro.Enabled = True
    CadastroUnidades.TB_TX_ADM_GER.Enabled = True
    CadastroUnidades.TB_VLR_ADM_GER.Enabled = True
    CadastroUnidades.TB_TX_ADM_EXT.Enabled = True
    CadastroUnidades.TB_VLR_ADM_EXT.Enabled = True
    CadastroUnidades.TB_TX_DTAS_2.Enabled = True
    CadastroUnidades.TB_VLR_DTAS_2.Enabled = True
    CadastroUnidades.CB_Curva.Enabled = True
    CadastroUnidades.Mudar_Curva_Obra.Enabled = True
    CadastroUnidades.TB_Area_Total_C.Enabled = True
    CadastroUnidades.TB_CUSTO_C.Enabled = True
    CadastroUnidades.TB_CUSTO_P_TAXAS.Enabled = True
    CadastroUnidades.TB_Prct_Area_PVT.Enabled = True
    CadastroUnidades.TB_INI_OBRA.Enabled = True
    CadastroUnidades.TB_DURACAO.Enabled = True
    CadastroUnidades.TB_INCORRIDO.Enabled = True
End Sub
Sub DesabilitarBTCVO()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    CadastroUnidades.CB_Fase.Enabled = False
    CadastroUnidades.TB_Custo_Metro.Enabled = False
    CadastroUnidades.TB_TX_ADM_GER.Enabled = False
    CadastroUnidades.TB_VLR_ADM_GER.Enabled = False
    CadastroUnidades.TB_TX_ADM_EXT.Enabled = False
    CadastroUnidades.TB_VLR_ADM_EXT.Enabled = False
    CadastroUnidades.TB_TX_DTAS_2.Enabled = False
    CadastroUnidades.TB_VLR_DTAS_2.Enabled = False
    CadastroUnidades.Mudar_Curva_Obra.Enabled = False
    CadastroUnidades.CB_Curva.Enabled = False
    CadastroUnidades.TB_Area_Total_C.Enabled = False
    CadastroUnidades.TB_CUSTO_P_TAXAS.Enabled = False
    CadastroUnidades.TB_Prct_Area_PVT.Enabled = False
    CadastroUnidades.TB_INI_OBRA.Enabled = False
    CadastroUnidades.TB_DURACAO.Enabled = False
    CadastroUnidades.TB_INCORRIDO.Enabled = False
End Sub

Sub CarregarInfosTerreno()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        .ºCB_permuta_fin.Clear
        .ºCB_permuta_fin.AddItem "% de Permuta Fin. / VGV"
        .ºCB_permuta_fin.AddItem "% Fundo de Permuta / Parceria"
        'AREA
        .TB_Metragem_T.Value = 0
        ºR = Application.Match("ºT_Area", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text <> "" Then .TB_Metragem_T.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text
        Call FormatarNumCur("CadastroUnidades", "TB_Metragem_T", 4)
        
        'PERCENTUAL PERMUTADO
        .TB_PRTC_PRMT.Value = 0
        ºR = Application.Match("ºT_Permutado", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value <> "" Then .TB_PRTC_PRMT.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        
        'TAXA PERMUTA FINANCEIRA
        ºR = Application.Match("ºT_Permuta Financeira", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .TB_TX_Permut_Fin.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 4).Value = 2 Then
            .ºCB_permuta_fin.Value = "% Fundo de Permuta / Parceria"
        Else
            .ºCB_permuta_fin.Value = "% de Permuta Fin. / VGV"
        End If
        
        'VALOR DO TERRENO ESCRITURA
        ºR = Application.Match("ºT_Valor do terreno Escritura", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .TB_VGV_Terreno_Fiscal.Value = 0
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text <> "" Then .TB_VGV_Terreno_Fiscal.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text
        
        'VALOR DA PERMUTA ESCRITURA
        ºR = Application.Match("ºT_Valor da Permuta Escritura", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .TB_VGV_Permuta_Fiscal.Value = 0
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text <> "" Then .TB_VGV_Permuta_Fiscal.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text
        
        'ALIQUOTA
        ºR = Application.Match("ºT_Aliquota", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .TB_TX_Permuta.Value = 0
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text <> "" Then .TB_TX_Permuta.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text
        
        'MES DE PAGAMENTO
        ºR = Application.Match("ºT_Pagamento", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .TB_MES_PGTO.Value = 0
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text <> "" Then .TB_MES_PGTO.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Text
        
        'ALIQUOTA ITBI
        ºR = Application.Match("ºT_Aliquota_ITBI", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
         .TB_TX_ITBI.Value = 0
         If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value <> "" Then .TB_TX_ITBI.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        
        'MES DE PAGAMENTO ITBI
        ºR = Application.Match("ºT_Pagamento_ITBI", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .TB_PG_ITBI.Value = 0
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value <> "" Then .TB_PG_ITBI.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        
        'VALOR LIQUIDO TERRENO
        ºR = Application.Match("ºT_Valor_Liquido", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        .TB_Valor_Liquido.Value = 0
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value <> "" Then .TB_Valor_Liquido.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
    End With
    Call Carregar_Prmt_Terreno
End Sub
Sub DescarregarInfosTerreno()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        'AREA
        ºR = Application.Match("ºT_Area", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_Metragem_T.Value
        'PERCENTUAL PERMUTADO
        ºR = Application.Match("ºT_Permutado", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_PRTC_PRMT.Value
        'TAXA PERMUTA FINANCEIRA
        ºR = Application.Match("ºT_Permuta Financeira", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_TX_Permut_Fin.Value
        If .ºCB_permuta_fin.Value = "% Fundo de Permuta / Parceria" Then
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 4).Value = 2
        Else
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 4).Value = 1
        End If
        'VALOR DO TERRENO ESCRITURA
        ºR = Application.Match("ºT_Valor do terreno Escritura", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_VGV_Terreno_Fiscal.Value
        'VALOR DA PERMUTA ESCRITURA
        ºR = Application.Match("ºT_Valor da Permuta Escritura", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_VGV_Permuta_Fiscal.Value
        'ALIQUOTA
        ºR = Application.Match("ºT_Aliquota", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_TX_Permuta.Value
        'MES DE PAGAMENTO
        ºR = Application.Match("ºT_Pagamento", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_MES_PGTO.Value
        'ALIQUOTA ITBI
        ºR = Application.Match("ºT_Aliquota_ITBI", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_TX_ITBI.Value
        'MES DE PAGAMENTO ITBI
        ºR = Application.Match("ºT_Pagamento_ITBI", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_PG_ITBI.Value
        'MES DE PAGAMENTO ITBI
        ºR = Application.Match("ºT_Pagamento_ITBI", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_PG_ITBI.Value
        'VALOR LIQUIDO TERRENO
        ºR = Application.Match("ºT_Valor_Liquido", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = .TB_Valor_Liquido.Value
    End With
End Sub


Sub TotalizarCusto()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    
    With CadastroUnidades
        .TB_Area_Construída.Value = 0
        .TB_AREA_PVT_TT.Value = 0
        .TB_CUSTO_TOTAL.Value = 0
        .TB_TOTAL_INCORRIDO.Value = 0
        .TB_Custo_Area_C.Value = 0
        .TB_Custo_Raso.Value = 0
        .TB_Valor_Ger.Value = 0
        .TB_Valor_EXT.Value = 0
        .TB_Valor_DTAS.Value = 0
        .TB_Custo_S_TX.Value = 0
        .TB_Custo_C_TX.Value = 0
        For ºL = 1 To .LV_FasesObra.ListItems.Count
            'AREA CONSTRUIDA
            .TB_Area_Construída.Value = CDbl(.TB_Area_Construída.Value) + CDbl(.LV_FasesObra.ListItems(ºL).SubItems(3))
            Call FormatarNumCur("CadastroUnidades", "TB_Area_Construída", 3)
            
            'AREA PRIVATIVA
            .TB_AREA_PVT_TT.Value = CDbl(.TB_AREA_PVT_TT.Value) + CDbl(.LV_FasesObra.ListItems(ºL).SubItems(2))
            Call FormatarNumCur("CadastroUnidades", "TB_AREA_PVT_TT", 3)
            
            'CUSTO OBRA COM TAXAS
            If .LV_FasesObra.ListItems(ºL).SubItems(13) <> "" Then ºCustoI = CDbl(.LV_FasesObra.ListItems(ºL).SubItems(13))
            ºCusto_total = (CDbl(.LV_FasesObra.ListItems(ºL).SubItems(2)) * CDbl(.LV_FasesObra.ListItems(ºL).SubItems(5))) '+ ºCustoI
            .TB_CUSTO_TOTAL.Value = CDbl(.TB_CUSTO_TOTAL.Value) + ºCusto_total
            Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_TOTAL", 3)
            
            'INCORRIDO DE OBRA
            .TB_TOTAL_INCORRIDO.Value = CDbl(.TB_TOTAL_INCORRIDO.Value) + ºCustoI
            Call FormatarNumCur("CadastroUnidades", "TB_TOTAL_INCORRIDO", 3)
            
            'CUSTO M² PRIVATIVO COM TAXAS
            .TB_Custo_C_TX.Value = CDbl(.TB_Custo_C_TX.Value) + CDbl(.LV_FasesObra.ListItems(ºL).SubItems(5))
            Call FormatarNumCur("CadastroUnidades", "TB_Custo_C_TX", 3)
            
            'CUSTO RASO
            'TAXA DE ADMINISTRAÇÃO GERENCIAL
            ºTX_ADM = CDbl(Replace(.LV_FasesObra.ListItems(ºL).SubItems(6), "%", "")) / 100
            ºTX_EXT = CDbl(Replace(.LV_FasesObra.ListItems(ºL).SubItems(7), "%", "")) / 100
            ºTX_DTAS = CDbl(Replace(.LV_FasesObra.ListItems(ºL).SubItems(8), "%", "")) / 100
            ºCusto_Raso = (ºCusto_total / (1 + (CDbl(ºTX_DTAS) + CDbl(ºTX_EXT) + CDbl(ºTX_ADM))))
            .TB_Custo_Raso.Value = CDbl(.TB_Custo_Raso.Value) + ºCusto_Raso
            Call FormatarNumCur("CadastroUnidades", "TB_Custo_Raso", 3)
            
            'TAXA DE ADMINISTRAÇÃO GERENCIAL
            ºTX = CDbl(Replace(.LV_FasesObra.ListItems(ºL).SubItems(6), "%", "")) / 100
            .TB_Valor_Ger.Value = CDbl(.TB_Valor_Ger.Value) + (ºCusto_Raso * ºTX)
            Call FormatarNumCur("CadastroUnidades", "TB_Valor_Ger", 3)
            
            'TAXA DE ADMINISTRAÇÃO EFETIVA
            ºTX = CDbl(Replace(.LV_FasesObra.ListItems(ºL).SubItems(7), "%", "")) / 100
            .TB_Valor_EXT.Value = CDbl(.TB_Valor_EXT.Value) + (ºCusto_Raso * ºTX)
            Call FormatarNumCur("CadastroUnidades", "TB_Valor_EXT", 3)
            
            'TAXA DTAS
            ºTX = CDbl(Replace(.LV_FasesObra.ListItems(ºL).SubItems(8), "%", "")) / 100
            .TB_Valor_DTAS.Value = CDbl(.TB_Valor_DTAS.Value) + (ºCusto_Raso * ºTX)
            Call FormatarNumCur("CadastroUnidades", "TB_Valor_DTAS", 3)
            
            'CUSTO M² CONSTRUÍDO SEM TAXAS
            .TB_Custo_Area_C.Value = CDbl(.TB_Custo_Area_C.Value) + (ºCusto_Raso / CDbl(.LV_FasesObra.ListItems(ºL).SubItems(3)))
            Call FormatarNumCur("CadastroUnidades", "TB_Custo_Area_C", 3)
         
            'CUSTO M² PRIVATIVO SEM TAXAS
            .TB_Custo_S_TX.Value = CDbl(.TB_Custo_Area_C.Value) + (ºCusto_Raso / CDbl(.LV_FasesObra.ListItems(ºL).SubItems(2)))
            Call FormatarNumCur("CadastroUnidades", "TB_Custo_S_TX", 3)
            
            '% taxa gerencial
            If .TB_CUSTO_TOTAL.Value > 0 And .TB_CUSTO_TOTAL.Value <> "" Then .TB_TX_Ger.Value = Format((.TB_Valor_Ger.Value / .TB_Custo_Raso.Value) * 100, "#,##0.00") & "%"
            '% taxa efetiva
            If .TB_CUSTO_TOTAL.Value > 0 And .TB_CUSTO_TOTAL.Value <> "" Then .TB_TX_Ext.Value = Format((.TB_Valor_EXT.Value / .TB_Custo_Raso.Value) * 100, "#,##0.00") & "%"
            '% taxa dtas
            If .TB_CUSTO_TOTAL.Value > 0 And .TB_CUSTO_TOTAL.Value <> "" Then .TB_TX_DTAS.Value = Format((.TB_Valor_DTAS.Value / .TB_Custo_Raso.Value) * 100, "#,##0.00") & "%"
        Next
   
        If .Associativo Then .AS_TB_Custo_Raso.Caption = .TB_Custo_Raso.Value
    End With
End Sub

Sub TotalizarCusto2()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        ºAreaCon = Application.Sum(ThisWorkbook.Sheets("BD_CAD_VND").Range("II3:II22"))
        If ºAreaCon > 0 Then .TB_Area_Construída.Value = Format(ºAreaCon, "#,##0")
        ºAREAPVT = Application.Sum(ThisWorkbook.Sheets("BD_CAD_VND").Range("B21:B40"))
        If ºAREAPVT > 0 Then .TB_AREA_PVT_TT.Value = Format(ºAREAPVT, "#,##0")
        ºCustoA = 0
        For ºL = 3 To 22
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("IJ" & ºL).Value <> "" Then
                ºAREA = ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL + 18).Value
                ºCustoA = ºCustoA + ºAREA * ThisWorkbook.Sheets("BD_CAD_VND").Range("IJ" & ºL).Value
            End If
        Next
        ºCustoPVT = Format(ºCustoA / ºAREAPVT, "#,##0.00")
        If ºCustoPVT > 0 Then
            .TB_Custo_Area_C.Value = Format((ºAREAPVT * ºCustoPVT) / ºAreaCon, "#,##0.00")
            .TB_Custo_S_TX.Value = Format(ºCustoPVT, "#,##0.00")
            .TB_Custo_Raso.Value = Format(ºAREAPVT * ºCustoPVT, "#,##0.00")
        End If
        .TB_Valor_Ger.Value = 0
        For ºL = 3 To 22
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("IK" & ºL).Value <> "" Then
                ºAREA = ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL + 18).Value
                ºCustoA = ºAREA * ThisWorkbook.Sheets("BD_CAD_VND").Range("IJ" & ºL).Value
                .TB_Valor_Ger.Value = Format(CDbl(.TB_Valor_Ger.Value) + (ThisWorkbook.Sheets("BD_CAD_VND").Range("IK" & ºL).Value * ºCustoA), "#,##0.00")
            End If
        Next
        .TB_TX_Ger.Value = Format((.TB_Valor_Ger.Value / .TB_Custo_Raso.Value) * 100, "#,##0.00") & "%"
        .TB_Valor_EXT.Value = 0
        For ºL = 3 To 22
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("IL" & ºL).Value <> "" Then
                ºAREA = ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL + 18).Value
                ºCustoA = ºAREA * ThisWorkbook.Sheets("BD_CAD_VND").Range("IJ" & ºL).Value
                .TB_Valor_EXT.Value = Format(CDbl(.TB_Valor_EXT.Value) + (ThisWorkbook.Sheets("BD_CAD_VND").Range("IL" & ºL).Value * ºCustoA), "#,##0.00")
            End If
        Next
        .TB_TX_Ext.Value = Format((.TB_Valor_EXT.Value / .TB_Custo_Raso.Value) * 100, "#,##0.00") & "%"
        .TB_CUSTO_ABC.Value = Format(CDbl(.TB_Custo_Raso.Value) + CDbl(.TB_Valor_Ger.Value) + CDbl(.TB_Valor_EXT.Value), "#,##0.00")
        .TB_Valor_DTAS.Value = 0
        For ºL = 3 To 22
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("IM" & ºL).Value <> "" Then
                ºAREA = ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL + 18).Value
                ºCustoA = ºAREA * ThisWorkbook.Sheets("BD_CAD_VND").Range("IJ" & ºL).Value
                .TB_Valor_DTAS.Value = Format(CDbl(.TB_Valor_DTAS.Value) + (ThisWorkbook.Sheets("BD_CAD_VND").Range("IM" & ºL).Value * ºCustoA), "#,##0.00")
            End If
        Next
        .TB_TX_DTAS.Value = Format((.TB_Valor_DTAS.Value / .TB_Custo_Raso.Value) * 100, "#,##0.00") & "%"
        '.TB_CUSTO_AD.Value = Format(CDbl(.TB_Custo_Raso.Value) + CDbl(.TB_Valor_DTAS.Value), "#,##0.00")
        .TB_CUSTO_TOTAL.Value = Format(CDbl(.TB_Custo_Raso.Value) + CDbl(.TB_Valor_Ger.Value) + CDbl(.TB_Valor_EXT.Value) + CDbl(.TB_Valor_DTAS.Value), "#,##0.00")
        .TB_Custo_C_TX.Value = Format(.TB_CUSTO_TOTAL.Value / ºAREAPVT, "#,##0.00")
    End With
End Sub
Function Identificar_Meses_Obra(ºCURVA As Integer)
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Function
    
    For ºL = 261 To 459
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºCURVA + 2).Value <> "" And ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºCURVA + 2).Value > 0 Then
            ºINICIO = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, 2).Value
            Exit For
        End If
    Next
    For ºL = 459 To 261 Step -1
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºCURVA + 2).Value <> "" And ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºCURVA + 2).Value > 0 Then
            ºFIM = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, 2).Value
            Exit For
        End If
    Next
    ºDURAÇÃO = ºFIM - ºINICIO + 1
    Identificar_Meses_Obra = ºINICIO & ";" & ºDURAÇÃO
End Function
Sub C_Totais_2()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        If .TB_CUSTO_P_TAXAS.Value <> "" And .TB_CUSTO_P_TAXAS.Value > 0 Then
            .TB_CUSTO_TOTAL2.Value = Format(.TB_Area_Total_PVT.Value * .TB_CUSTO_P_TAXAS.Value, "#,##0")
            .TB_TT_S_TX.Value = Format((CadastroUnidades.TB_Area_Total_PVT.Value * CadastroUnidades.TB_CUSTO_P_TAXAS.Value) / (1 + (CDbl(Replace(CadastroUnidades.TB_TX_ADM_EXT.Value, "%", "")) / 100) + _
            (CDbl(Replace(CadastroUnidades.TB_TX_ADM_GER.Value, "%", "")) / 100) + (CDbl(Replace(CadastroUnidades.TB_TX_DTAS_2.Value, "%", "")) / 100)), "#,##0.00")
            .TB_VLR_ADM_GER.Value = Format(.TB_TT_S_TX.Value * (CDbl(Replace(.TB_TX_ADM_GER.Value, "%", "")) / 100), "#,##0")
            .TB_VLR_ADM_EXT.Value = Format(.TB_TT_S_TX.Value * (CDbl(Replace(.TB_TX_ADM_EXT.Value, "%", "")) / 100), "#,##0")
            .TB_VLR_DTAS_2.Value = Format(.TB_TT_S_TX.Value * (CDbl(Replace(.TB_TX_DTAS_2.Value, "%", "")) / 100), "#,##0")
            .TB_CUSTO_C.Value = Format((CDbl(.TB_TT_S_TX.Value) + CDbl(.TB_VLR_ADM_GER) + CDbl(.TB_VLR_ADM_EXT) + CDbl(.TB_VLR_DTAS_2)) / CDbl(.TB_Area_Total_C), "#,##0.00")
            If CDbl(.TB_Area_Total_PVT) <> 0 Then
                .TB_Custo_Metro.Value = Format(CDbl(.TB_TT_S_TX) / CDbl(.TB_Area_Total_PVT), "#,##0.00")
            Else
                .TB_Custo_Metro.Value = Format(0, "#,##0.00")
            End If
        End If
    End With
End Sub
Sub C_Totais()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
    If .Custo_Obra_Pvt.Value = "Custo do m² Pvt. C/ Taxas" Then
        .TB_TT_S_TX.Value = Format((CadastroUnidades.TB_Area_Total_PVT.Value * CadastroUnidades.TB_CUSTO_P_TAXAS.Value) / (1 + (CDbl(Replace(CadastroUnidades.TB_TX_ADM_EXT.Value, "%", "")) / 100) + _
        (CDbl(Replace(CadastroUnidades.TB_TX_ADM_GER.Value, "%", "")) / 100) + (CDbl(Replace(CadastroUnidades.TB_TX_DTAS_2.Value, "%", "")) / 100)), "#,##0.00")
        .TB_VLR_ADM_GER.Value = Format(.TB_TT_S_TX.Value * (CDbl(Replace(.TB_TX_ADM_GER.Value, "%", "")) / 100), "#,##0")
        .TB_VLR_ADM_EXT.Value = Format(.TB_TT_S_TX.Value * (CDbl(Replace(.TB_TX_ADM_EXT.Value, "%", "")) / 100), "#,##0")
        .TB_VLR_DTAS_2.Value = Format(.TB_TT_S_TX.Value * (CDbl(Replace(.TB_TX_DTAS_2.Value, "%", "")) / 100), "#,##0")
        .TB_CUSTO_C.Value = Format((CDbl(.TB_TT_S_TX.Value) + CDbl(.TB_VLR_ADM_GER) + CDbl(.TB_VLR_ADM_EXT) + CDbl(.TB_VLR_DTAS_2)) / CDbl(.TB_Area_Total_C), "#,##0.00")
        .TB_Custo_Metro = Format(CDbl(.TB_TT_S_TX.Value) / CDbl(.TB_Area_Total_PVT), "#,##0.00")
        '.TB_CUSTO_P_TAXAS.Value = Format((CDbl(.TB_TT_S_TX.Value) + CDbl(.TB_VLR_ADM_GER) + CDbl(.TB_VLR_ADM_EXT) + CDbl(.TB_VLR_DTAS_2)) / CDbl(.TB_Area_Total_PVT), "#,##0.00")
        .TB_CUSTO_TOTAL2.Value = Format(CDbl(.TB_TT_S_TX.Value) + CDbl(.TB_VLR_ADM_GER) + CDbl(.TB_VLR_ADM_EXT) + CDbl(.TB_VLR_DTAS_2), "#,##0.00")
    Else
        .TB_TT_S_TX.Value = Format((CadastroUnidades.TB_Area_Total_PVT.Value * CadastroUnidades.TB_Custo_Metro.Value) / (1 + (CDbl(Replace(CadastroUnidades.TB_TX_ADM_EXT.Value, "%", "")) / 100) + _
        (CDbl(Replace(CadastroUnidades.TB_TX_ADM_GER.Value, "%", "")) / 100) + (CDbl(Replace(CadastroUnidades.TB_TX_DTAS_2.Value, "%", "")) / 100)), "#,##0.00")
        .TB_VLR_ADM_GER.Value = Format(.TB_TT_S_TX.Value * (CDbl(Replace(.TB_TX_ADM_GER.Value, "%", "")) / 100), "#,##0")
        .TB_VLR_ADM_EXT.Value = Format(.TB_TT_S_TX.Value * (CDbl(Replace(.TB_TX_ADM_EXT.Value, "%", "")) / 100), "#,##0")
        .TB_VLR_DTAS_2.Value = Format(.TB_TT_S_TX.Value * (CDbl(Replace(.TB_TX_DTAS_2.Value, "%", "")) / 100), "#,##0")
        .TB_CUSTO_C.Value = Format((CDbl(.TB_TT_S_TX.Value) + CDbl(.TB_VLR_ADM_GER) + CDbl(.TB_VLR_ADM_EXT) + CDbl(.TB_VLR_DTAS_2)) / CDbl(.TB_Area_Total_C), "#,##0.00")
        .TB_CUSTO_P_TAXAS = Format(CDbl(.TB_TT_S_TX.Value) / CDbl(.TB_Area_Total_PVT), "#,##0.00")
        '.TB_CUSTO_P_TAXAS.Value = Format((CDbl(.TB_TT_S_TX.Value) + CDbl(.TB_VLR_ADM_GER) + CDbl(.TB_VLR_ADM_EXT) + CDbl(.TB_VLR_DTAS_2)) / CDbl(.TB_Area_Total_PVT), "#,##0.00")
        .TB_CUSTO_TOTAL2.Value = Format(CDbl(.TB_TT_S_TX.Value) + CDbl(.TB_VLR_ADM_GER) + CDbl(.TB_VLR_ADM_EXT) + CDbl(.TB_VLR_DTAS_2), "#,##0.00")
    End If
    End With
End Sub


Sub Carregar_CB_PERIODICIDADE()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
    .CB_PERIODICIDADE_TI.Clear
    For ºL = 523 To 528
        If ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value <> "" Then
            .CB_PERIODICIDADE_TI.AddItem ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºL).Value
        End If
    Next
    .CB_PERIODICIDADE_TI.AddItem "Curva de Obra"
    End With
End Sub
Sub Carregar_CB_FASES()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        .CB_FASE_TI.Clear
        For ºL = 1 To 10
            .CB_FASE_TI.AddItem ºL
        Next
    End With
End Sub
Sub Carregar_LV_TI()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºLinhas = ThisWorkbook.Sheets("Lançamentos").Cells(Rows.Count, 2).End(xlUp).Row
    With CadastroUnidades
        .TOTAL_LCTO.Caption = "0"
        .LV_Lançamentos_TI.ColumnHeaders.Clear
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "FASE", 30
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "PEP RELACIONADO", 85
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "DESCRIÇÃO", 200
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "VALOR DO LANÇAMENTO", 100, lvwColumnRight
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "FATOR DE CALCULO", 85
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "PARCELAS", 50
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "PERIODICIDADE", 70
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "MES DE INICIO", 70
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "DATA DE INICIO", 70
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "EVENTO VINCULADO", 85
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "TIPO DE LANÇAMENTO", 150
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "VALOR TOTAL R$", 150, lvwColumnRight
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "COD", 0
        .LV_Lançamentos_TI.ColumnHeaders.Add , , "OBSERVAÇÕES", 200
        .LV_Lançamentos_TI.ListItems.Clear
        ThisWorkbook.Worksheets("Lançamentos").Sort.SortFields.Clear
        ThisWorkbook.Worksheets("Lançamentos").Sort.SortFields.Add Key:=Range("G2:G" & ºLinhas), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        ThisWorkbook.Worksheets("Lançamentos").Sort.SetRange Range("A2:DH" & ºLinhas)
        ThisWorkbook.Worksheets("Lançamentos").Sort.Apply
        ThisWorkbook.Worksheets("Lançamentos").Sort.SortFields.Clear
        ThisWorkbook.Worksheets("Lançamentos").Sort.SortFields.Add Key:=Range("C2:C" & ºLinhas), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        ThisWorkbook.Worksheets("Lançamentos").Sort.SetRange Range("A2:DH" & ºLinhas)
        ThisWorkbook.Worksheets("Lançamentos").Sort.Apply
        
        For ºL = 2 To ºLinhas
            If ThisWorkbook.Sheets("Lançamentos").Range("C" & ºL).Value = .PEP_FILTRO.Value Or CadastroUnidades.FiltrarLançamentos = False Then
                'FASE
                Set ºLi = .LV_Lançamentos_TI.ListItems.Add(, , ThisWorkbook.Sheets("Lançamentos").Range("A" & ºL).Value)
                
                'TIPO DE LANÇAMENTO
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "TIPO DE LANÇAMENTO") - 1) = ThisWorkbook.Sheets("Lançamentos").Range("B" & ºL).Value
                 
                'VALOR DO LANÇAMENTO
                If Application.IfError(Application.Search("%", ThisWorkbook.Sheets("Lançamentos").Range("D" & ºL).Value), 0) > 0 Then
                    ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR DO LANÇAMENTO") - 1) = Format(ThisWorkbook.Sheets("Lançamentos").Range("I" & ºL).Value, "#,##0.000") & "%"
                Else
                    ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR DO LANÇAMENTO") - 1) = Format(ThisWorkbook.Sheets("Lançamentos").Range("I" & ºL).Value, "#,##0.00")
                End If
                ºVLR_LCTO = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR DO LANÇAMENTO") - 1)
                
                'FATOR DE CALCULO
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1) = ThisWorkbook.Sheets("Lançamentos").Range("D" & ºL).Value
                 
                'PARCELAS
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "PARCELAS") - 1) = ThisWorkbook.Sheets("Lançamentos").Range("E" & ºL).Value
                 
                'PERIODICIDADE
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "PERIODICIDADE") - 1) = ThisWorkbook.Sheets("Lançamentos").Range("F" & ºL).Value
                 
                'MES DE INICIO
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "MES DE INICIO") - 1) = ThisWorkbook.Sheets("Lançamentos").Range("G" & ºL).Value
                 
                'DATA DE INICIO
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "DATA DE INICIO") - 1) = Format(Application.EDate(Application.EDate(DateValue(ºDATA_BASE("")), 1), ThisWorkbook.Sheets("Lançamentos").Range("G" & ºL).Value), "DD/MM/YYYY")
                 
                'EVENTO VINCULADO
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "EVENTO VINCULADO") - 1) = ThisWorkbook.Sheets("Lançamentos").Range("H" & ºL).Value
                 
                 'PEP RELACIONADO
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "PEP RELACIONADO") - 1) = ThisWorkbook.Sheets("Lançamentos").Range("C" & ºL).Value
               
                 'DESCRIÇÃO
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "DESCRIÇÃO") - 1) = ThisWorkbook.Sheets("Lançamentos").Range("DH" & ºL).Value
                
                'OBSERVAÇÕES
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "OBSERVAÇÕES") - 1) = ThisWorkbook.Sheets("Lançamentos").Range("DI" & ºL).Value
                
                a = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1)
                'TOTAL EM R$
                If ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1) = "R$" Then
                    ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) = ºVLR_LCTO
                ElseIf ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1) = "% VGV" Then
                    If CadastroUnidades.LB_TT_V_3.Caption <> "" Then ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) = Format((Replace(ºVLR_LCTO, "%", "") / 100) * CDbl(CadastroUnidades.LB_TT_V_3.Caption), "#,#00.00")
                ElseIf ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1) = "% Marketing" Then
                    If CadastroUnidades.LB_TT_V_3.Caption <> "" And CadastroUnidades.TB_MKTG.Value <> "" Then ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) = _
                    Format((Replace(ºVLR_LCTO, "%", "") / 100) * (Replace(CadastroUnidades.TB_MKTG, "%", "") / 100) * CDbl(CadastroUnidades.LB_TT_V_3.Caption), "#,#00.00")
                ElseIf ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1) = "% E-Business" Then
                    If CadastroUnidades.LB_TT_V_3.Caption <> "" And CadastroUnidades.TB_EBUSINESS.Value <> "" Then ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) = _
                    Format((Replace(ºVLR_LCTO, "%", "") / 100) * (Replace(CadastroUnidades.TB_EBUSINESS, "%", "") / 100) * CDbl(CadastroUnidades.LB_TT_V_3.Caption), "#,#00.00")
                ElseIf ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1) = "% PDV" Then
                    If CadastroUnidades.LB_TT_V_3.Caption <> "" And CadastroUnidades.TB_PDV.Value <> "" Then ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) = _
                    Format((Replace(ºVLR_LCTO, "%", "") / 100) * (Replace(CadastroUnidades.TB_PDV, "%", "") / 100) * CDbl(CadastroUnidades.LB_TT_V_3.Caption), "#,#00.00")
                ElseIf ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1) = "% Prêmio" Then
                    If CadastroUnidades.LB_TT_V_3.Caption <> "" And CadastroUnidades.TB_PREMIO.Value <> "" Then ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) = _
                    Format((Replace(ºVLR_LCTO, "%", "") / 100) * (Replace(CadastroUnidades.TB_PREMIO, "%", "") / 100) * CDbl(CadastroUnidades.LB_TT_V_3.Caption), "#,#00.00")
                ElseIf ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1) = "% Terreno Fiscal" Then
                    ºR = Application.Match("ºT_Valor do terreno Escritura", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
                    If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value <> "" Then ºVGV_Terreno = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value Else ºVGV_Terreno = 0
                    ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) = Format(CDbl(ºVGV_Terreno) * CDbl(Replace(ºVLR_LCTO, "%", "") / 100), "#,#00.00")
                ElseIf ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1) = "% DTAS" Then
                    ºDtas = ThisWorkbook.Sheets("BD_CAD_VND").Range("R" & 209 + ºLi).Value
                    If CadastroUnidades.LB_TT_V_3.Caption <> "" And ºDtas <> "" Then ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) = _
                    Format((Replace(ºVLR_LCTO, "%", "") / 100) * CDbl(ºDtas), "#,#00.00")
                ElseIf ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "FATOR DE CALCULO") - 1) = "% Custo Raso Fase" Then
                    ºFASE = ºLi
                    If ThisWorkbook.Sheets("BD_CAD_VND").Cells(209 + ºFASE, 15).Value <> "" Then
                        ºCustoRasoFase = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Cells(209 + ºFASE, 15).Value)
                        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(209 + ºFASE, 19).Value <> "" Then
                            ºCustoRasoFase = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Cells(209 + ºFASE, 19).Value)
                        End If
                        ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) = Format((Replace(ºVLR_LCTO, "%", "") / 100) * ºCustoRasoFase, "#,#00.00")
                    Else
                        ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) = "0,00"
                    End If
                End If
                If ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1) <> "" Then
                    .TOTAL_LCTO.Caption = CDbl(.TOTAL_LCTO.Caption) + CDbl(ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR TOTAL R$") - 1))
                End If
                'COD
                ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "COD") - 1) = CStr(ºL)
            End If
        Next
         .TOTAL_LCTO.Caption = Format(.TOTAL_LCTO.Caption, "#,#00.00")
    End With
    
End Sub

Sub Carregar_Perf_Vnd()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    'Call Carregar_PRF_VND(0)
    Call AttBDTipologias
    With CadastroUnidades
        .TB_NAME_PERF.Value = ""
        .TB_Juros_TP.Value = ""
        ºSenha = "1"
        .prf_associativo.Value = False
        ºSenha = ""
        .tb_ini_pos.Value = ""
        If .LIST_Perfil_Venda.ListItems.Count > 0 Then
            ºCod = .LIST_Perfil_Venda.SelectedItem
            Call Carregar_PRF_VND(.LIST_Perfil_Venda.SelectedItem)
            ºL = Application.IfError(Application.Match(CDbl(ºCod), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
            If ºL = 0 Then ºL = Application.IfError(Application.Match(CDbl(.LIST_Perfil_Venda.SelectedItem), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
            .TB_NAME_PERF.Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL + 900).Value
            .TB_Juros_TP.Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("F" & ºL + 900).Text
            ºSenha = "1"
            .prf_associativo.Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("G" & ºL + 900).Value
            ºSenha = ""
            .tb_ini_pos.Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºL + 900).Value
            .ERASE_PERF_VEND.Enabled = True
            .TB_NAME_PERF.Enabled = True
            .TB_Juros_TP.Enabled = True
            .LIST_Perfil_Venda.ListItems(ºL).Selected = True
        Else
            Call Carregar_PRF_VND(0)
        End If
        .SELECT_ALL.Value = False
    End With
    Call ATT_Percentual_vel
    Call Feed_List_Tipologias
End Sub

Sub Carregar_PRF_VND(ºIndice As Integer)
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades.LIST_Perfil_Venda
        .ColumnHeaders.Clear
        .ListItems.Clear
        .ColumnHeaders.Add , , "Cód", 45
        .ColumnHeaders.Add , , "Descrição", 100
        .ColumnHeaders.Add , , "Velocidade", 0
        .ColumnHeaders.Add , , "Tabela Padrão", 90
        .ColumnHeaders.Add , , "Tabela Pos", 90
        .ColumnHeaders.Add , , "Juros TP(a.a.)", 80
        .ColumnHeaders.Add , , "Associativo?", 80
        For ºlIN = 901 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(951, 2).End(xlUp).Row
            If ºlIN > 900 Then
                Set ºLi = .ListItems.Add(, , ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 1).Value)
                ºLi.SubItems(1) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 2).Value
                ºLi.SubItems(2) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 3).Value
                
                ºTabela = Replace(Left(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 4).Value, 2), " ", "")
                If ºTabela <> "" Then
                    ºnomeTabela = ThisWorkbook.Sheets("BD_CAD_VND").Cells(107 + ºTabela, 2).Value
                    ºLi.SubItems(3) = ºTabela & " | " & ºnomeTabela
                Else
                    ºLi.SubItems(3) = ""
                End If
                
                ºTabela = Replace(Left(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 5).Value, 2), " ", "")
                If ºTabela <> "" Then
                    ºnomeTabela = ThisWorkbook.Sheets("BD_CAD_VND").Cells(107 + ºTabela, 2).Value
                    ºLi.SubItems(4) = ºTabela & " | " & ºnomeTabela
                Else
                    ºLi.SubItems(4) = ""
                End If
                
                ºLi.SubItems(5) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 6).Text
                If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 7).Value Then ºLi.SubItems(6) = "Sim" Else ºLi.SubItems(6) = "Não"
            End If
        Next
        .Visible = False
        .Visible = True
        .View = lvwReport
        .FullRowSelect = True
    End With
    With CadastroUnidades.LIST_Perfil_Venda_B
        .ColumnHeaders.Clear
        .ListItems.Clear
        .ColumnHeaders.Add , , "Cód", 45
        .ColumnHeaders.Add , , "Descrição", 60
        .ColumnHeaders.Add , , "Velocidade", 0
        .ColumnHeaders.Add , , "Tabela Padrão", 65
        .ColumnHeaders.Add , , "Tabela Pos", 65
        .ColumnHeaders.Add , , "Taxa Juros (a.a.)", 65
        For ºlIN = 901 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(951, 2).End(xlUp).Row
            If ºlIN > 900 Then
                Set ºLi = .ListItems.Add(, , ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 1).Value)
                ºLi.SubItems(1) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 2).Value
                ºLi.SubItems(2) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 3).Value
                
                ºTabela = Replace(Left(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 4).Value, 2), " ", "")
                If ºTabela <> "" Then
                    ºnomeTabela = ThisWorkbook.Sheets("BD_CAD_VND").Cells(107 + ºTabela, 2).Value
                    ºLi.SubItems(3) = ºTabela & " | " & ºnomeTabela
                Else
                    ºLi.SubItems(3) = ""
                End If
                
                ºTabela = Replace(Left(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 5).Value, 2), " ", "")
                If ºTabela <> "" Then
                    ºnomeTabela = ThisWorkbook.Sheets("BD_CAD_VND").Cells(107 + ºTabela, 2).Value
                    ºLi.SubItems(4) = ºTabela & " | " & ºnomeTabela
                Else
                    ºLi.SubItems(4) = ""
                End If
                
                'ºLi.SubItems(3) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 4).Value
                'ºLi.SubItems(4) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 5).Value
                ºLi.SubItems(5) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, 6).Text
            End If
        Next
        .View = lvwReport
        .FullRowSelect = True
        .Visible = False
        .Visible = True
    End With
    If ºIndice > 0 And ºIndice <= CadastroUnidades.LIST_Perfil_Venda.ListItems.Count Then CadastroUnidades.LIST_Perfil_Venda.ListItems(ºIndice).Selected = True
    If ºIndice > 0 And ºIndice <= CadastroUnidades.LIST_Perfil_Venda_B.ListItems.Count Then CadastroUnidades.LIST_Perfil_Venda_B.ListItems(ºIndice).Selected = True
    If ºIndice > 0 And ºIndice <= CadastroUnidades.LIST_Perfil_Venda.ListItems.Count Then
        Set ºLi = CadastroUnidades.LIST_Perfil_Venda.ListItems(ºIndice)
        If CadastroUnidades.MP_TBL_VND.Value = 0 Then
            CadastroUnidades.CB_Select_Tbl.Value = ºLi.SubItems(3)
        Else
            CadastroUnidades.CB_Select_Tbl.Value = ºLi.SubItems(4)
        End If
    End If
    If CadastroUnidades.LIST_Perfil_Venda.ListItems.Count > 0 Then
        CarregarVelocidades (CadastroUnidades.LIST_Perfil_Venda.SelectedItem)
    Else
        CarregarVelocidades (0)
    End If
End Sub
Sub Load_show_tbl()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    CadastroUnidades.LV_Show_TBL_VND.ListItems.Clear
    CadastroUnidades.LV_Show_TBL_VND.ColumnHeaders.Clear
    CadastroUnidades.LV_Show_TBL_VND.ColumnHeaders.Add , , "Tipo", 50
    CadastroUnidades.LV_Show_TBL_VND.ColumnHeaders.Add , , "Parcelas", 50
    CadastroUnidades.LV_Show_TBL_VND.ColumnHeaders.Add , , "Inicio", 60
    CadastroUnidades.LV_Show_TBL_VND.ColumnHeaders.Add , , "Final", 60
    CadastroUnidades.LV_Show_TBL_VND.ColumnHeaders.Add , , "% do VGV", 60
    CadastroUnidades.LV_Show_TBL_VND.ColumnHeaders.Add , , "Inicio dos Juros", 60
    
    ºperfil = CadastroUnidades.LIST_Perfil_Venda_B.SelectedItem
    ºTabela_Pre = CadastroUnidades.LIST_Perfil_Venda_B.SelectedItem.SubItems(3)
    If ºTabela_Pre = "" Then Exit Sub
    ºTabela_Pre = Left(ºTabela_Pre, Application.Search("|", ºTabela_Pre) - 2)
    ºTabela_pos = CadastroUnidades.LIST_Perfil_Venda_B.SelectedItem.SubItems(4)
    If ºTabela_pos <> "" Then ºTabela_pos = Left(ºTabela_pos, Application.Search("|", ºTabela_pos) - 2)
    ºVelocidade = CadastroUnidades.LIST_Perfil_Venda_B.SelectedItem.SubItems(2)
    'ºVelocidade = Left(ºVelocidade, Application.Search("|", ºVelocidade) - 2)
    
    ºDatab = DateValue(ºDATA_BASE_FLX)
    Inicio = DIF_DT_LCTO(ThisWorkbook.Sheets("BD_CAD_VND").Cells(56 + ºVelocidade, 5).Value, 0)
    For ºI = 1 To 30
        ºC = Application.Match("Perfil Venda", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value <> "" Then ºPerfil_2 = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value)
        If ºperfil = ºPerfil_2 Then
            ºC = Application.Match("Unidades", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
            CadastroUnidades.Controls("TB_Und_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
            ºC = Application.Match("Permutas", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
            CadastroUnidades.Controls("TB_Permt_Tipologia_" & ºI).Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
            
            If CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value <> "" Then
                If CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value > 0 And CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value > 0 Then
                    ºVGV_Perfil = ºVGV_Perfil + (CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value * CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value) + (CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value * CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value * CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value)
                Else
                    ºVGV_Perfil = ºVGV_Perfil + CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value * CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value
                End If
            End If
        End If
    Next
    For ºI = 1 To 10
        ºC = Application.Match("Perfil Venda", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value <> "" Then ºPerfil_2 = CDbl(Left(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value, Application.Search("|", ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value) - 2))
        If ºperfil = ºPerfil_2 Then
            If CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value <> "" Then
               ºVGV_Perfil = ºVGV_Perfil + Format(CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value / (CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value - CadastroUnidades.Controls("TB_Permt_Vaga_" & ºI).Value), "#,##0.00")
            End If
        End If
    Next
    For ºC_TBL = 3 To 172 Step 9
        'Categorização
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL).Text <> "" Then
            '---------------------------------------------------------  TIPO  ---------------------------------------------------------------------------------------------------------------------------------
            ºCTIPO = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL).Text)
            Set Li = CadastroUnidades.LV_Show_TBL_VND.ListItems.Add(, , ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & Application.Match(ºCTIPO, ThisWorkbook.Sheets("BD_CAD_VND").Range("B523:B550")) + 522))
            '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
            Li.SubItems(1) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 1).Text
            '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
            If Application.IfError(Application.Search("OBR", ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 2).Text), 0) <> 0 Then
                Li.SubItems(2) = "#-#-#"
            Else
                Li.SubItems(2) = Inicio + ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 2).Text & " - " & Format(Application.EDate(ºDatab, Inicio + ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 2).Text), "mm/yyyy")
            End If
            '---------------------------------------------------------  MES FIM  ------------------------------------------------------------------------------------------------------------------------------
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 8).Text > 0 Then
                If Application.IfError(Application.Search("OBR", ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 8).Text), 0) <> 0 Then
                     Li.SubItems(3) = "#-#-#"
                Else
                    ºMFIM = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 8).Text
                    Li.SubItems(3) = Inicio + ºMFIM & " - " & Format(Application.EDate(ºDatab, Inicio + ºMFIM), "mm/yyyy")
                End If
            Else
                Li.SubItems(3) = "#-#-#"
            End If
            '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(4) = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 3).Text
            '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 4).Text = 1 Then
                If Application.IfError(Application.Search("OBR", ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 5).Text), 0) <> 0 Then
                    Li.SubItems(5) = "#-#-#"
                Else
                    Li.SubItems(5) = Inicio + ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 5).Text & " - " & Format(Application.EDate(ºDatab, Inicio + ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºTabela_Pre + 107, ºC_TBL + 5).Text), "mm/yyyy")
                End If
            Else
                 Li.SubItems(5) = "#-#-#"
            End If
        End If
    Next
    CadastroUnidades.LV_Show_TBL_VND.View = lvwReport
    CadastroUnidades.LV_Show_TBL_VND.FullRowSelect = True
    CadastroUnidades.LV_Show_TBL_VND.Visible = False
    CadastroUnidades.LV_Show_TBL_VND.Visible = True

End Sub


Sub Load_LV_Show_Curvas_Velocidade()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades.LV_Show_Curvas_Velocidade
        .ColumnHeaders.Clear
        .ListItems.Clear
        .ColumnHeaders.Add , , "Mes", 60
        .ColumnHeaders.Add , , "% de Venda", 55
        .ColumnHeaders.Add , , "Unidades", 55
        .ColumnHeaders.Add , , "VGV", 90
        
        ºperfil = CDbl(CadastroUnidades.LIST_Perfil_Venda_B.SelectedItem)
        ºVelocidade = CadastroUnidades.LIST_Perfil_Venda_B.SelectedItem.SubItems(2)
        
        ºDatab = DateValue(ºDATA_BASE_FLX)
        Inicio = ThisWorkbook.Sheets("BD_CAD_VND").Cells(56 + ºVelocidade, 5).Value
        
        For ºI = 1 To 30
            ºC = Application.Match("Perfil Venda", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value <> "" Then ºPerfil_2 = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value)
            If ºperfil = ºPerfil_2 Then
                ºC = Application.Match("Unidades", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
                ºUNIDADES = ºUNIDADES + ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
                ºUnid_1 = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
                ºC = Application.Match("Permutas", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
                ºUnid_1 = ºUnid_1 - ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
                ºUNIDADES = ºUNIDADES - ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 2, ºC).Value
                If CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value <> "" Then
                    If CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value > 0 And CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value > 0 Then
                        ºVGV_Perfil = ºVGV_Perfil + ((CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value * CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value) * ºUnid_1) + (CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value * (Replace(CadastroUnidades.Controls("TB_Fator_Tipologia_" & ºI).Value, "%", "") / 100) * CadastroUnidades.Controls("TB_M²_D_Tipologia_" & ºI).Value * ºUnid_1)
                    Else
                        ºVGV_Perfil = ºVGV_Perfil + (CadastroUnidades.Controls("TB_M²_Tipologia_" & ºI).Value * CadastroUnidades.Controls("TB_ValorM²_Tipologia_" & ºI).Value) * ºUnid_1
                    End If
                End If
            End If
        Next
        For ºI = 1 To 10
            ºC = Application.Match("Perfil Venda", ThisWorkbook.Sheets("BD_CAD_VND").Rows(2), 0)
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value <> "" Then ºPerfil_2 = CDbl(Left(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value, Application.Search("|", ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºI + 34, ºC).Value) - 2))
            If ºperfil = ºPerfil_2 Then
                If CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value <> "" And CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value <> "" Then
                   ºVGV_Perfil = ºVGV_Perfil + Format(CadastroUnidades.Controls("TB_TT_VGV_Vaga_" & ºI).Value / (CadastroUnidades.Controls("TB_Und_Vaga_" & ºI).Value), "#,##0.00")
                End If
            End If
        Next
        For ºVel = 3 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºVelocidade + 56, Columns.Count).End(xlToLeft).Column Step 3
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºVelocidade + 56, ºVel).Value <> "" Then
                ºVel_percent = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºVelocidade + 56, ºVel).Value
                If Len(ºVel_percent) > Len(Replace(ºVel_percent, "%", "")) Then ºVel_percent = Replace(ºVel_percent, "%", "") / 100
                ºVel_Tempo = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºVelocidade + 56, ºVel + 1).Value
                ºVel_Ini = DIF_DT_LCTO(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºVelocidade + 56, ºVel + 2).Value, 0)
                ºVel_Tempo = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºVelocidade + 56, ºVel + 1).Value
                ºPercentM = ºVel_percent / ºVel_Tempo
                ºLast = ºVel_Ini + ºVel_Tempo - 1
                ºL_II = 1
                ºOK = False
                For ºL = 1 To ºVel_Tempo
                    For Each ºLT In .ListItems
                        If Replace(Replace(Left(ºLT, 4), "-", ""), " ", "") = ºVel_Ini + (ºL - 1) Then
                            ºOK = True
                            Set Li = ºLT
                            Exit For
                        End If
                    Next
                    If Not ºOK Then
                        Set Li = .ListItems.Add(, , ºVel_Ini + (ºL - 1) & " - " & Format(Application.EDate(ºDatab, ºVel_Ini + (ºL - 1)), "mm/yyyy"))
                        If ºL >= ºVel_Ini Then
                            Li.SubItems(1) = Format(ºPercentM, "0.0000%")
                            Li.SubItems(2) = Format(ºPercentM * ºUNIDADES, "0.000")
                            Li.SubItems(3) = Format(ºPercentM * ºVGV_Perfil, "#,##0.000")
                            ºLinhasCriadas = ºLinhasCriadas + 1
                        Else
                            If Li.SubItems(1) = "" Then Li.SubItems(1) = Format(0, "0.0000%")
                            Li.SubItems(1) = Format(ºPercentM, "0.0000%")
                            Li.SubItems(2) = Format(ºPercentM * ºUNIDADES, "0.000")
                            Li.SubItems(3) = Format(ºPercentM * ºVGV_Perfil, "#,##0.000")
                            ºLinhasCriadas = ºLinhasCriadas + 1
                        End If
                    Else
                        If Li.SubItems(1) > 0 And Li.SubItems(1) <> "" Then
                            If ºPercentM > 0 Then
                                Li.SubItems(1) = Format((CDbl(Replace(Li.SubItems(1), "%", "")) / 100) + CDbl(ºPercentM), "0.0000%")
                                Li.SubItems(2) = Format(CDbl(Li.SubItems(2)) + CDbl(ºPercentM * ºUNIDADES), "0.000")
                                Li.SubItems(3) = Format(CDbl(Li.SubItems(3)) + CDbl(ºPercentM * ºVGV_Perfil), "#,##0.000")
                            End If
                        Else
                            If ºPercentM > 0 And ºPercentM <> "" Then
                                Li.SubItems(1) = Format(ºPercentM, "0.0000%")
                                Li.SubItems(2) = Format(ºPercentM * ºUNIDADES, "0.000")
                                Li.SubItems(3) = Format(ºPercentM * ºVGV_Perfil, "#,##0.000")
                            Else
                                Li.SubItems(1) = Format(0, "0.0000%")
                                Li.SubItems(2) = Format(0, "0.000")
                                Li.SubItems(3) = Format(0, "#,##0.000")
                            End If
                        End If
                    End If
                Next
            End If
        Next
        .View = lvwReport
        .FullRowSelect = True
    End With
End Sub

Sub Carregar_Prmt_Terreno()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Dim ºTerrenoVP, ºCusto_Obra, ºP_Fisica As Variant
    ºTerrenoVP = CDbl(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E575").Value, 0))
    ºCusto_Obra = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("E561").Value)
    ºP_Fisica = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("E576").Value)
    ºP_Financeira = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("E577").Value)
    With CadastroUnidades
        If ºTerrenoVP <> 0 Then
            .TB_VGV_Terreno.Value = ºTerrenoVP
            Call FormatarNumCur("CadastroUnidades", "TB_VGV_Terreno", 2)
            If .TB_Metragem_T.Value <> "" Then
                If CDbl(.TB_Metragem_T.Value) < 1 Then .TB_Metragem_T.Value = 1
                .TB_Valor_metro.Value = .TB_VGV_Terreno.Value / .TB_Metragem_T.Value
            Else
                .TB_Metragem_T.Value = 1
                .TB_Valor_metro.Value = .TB_VGV_Terreno.Value / .TB_Metragem_T.Value
            End If
            Call FormatarNumCur("CadastroUnidades", "TB_Valor_metro", 2)
            If Application.IfError(ºCusto_Obra, 0) <> 0 Then
                .PRTC_PRMT.Value = (.TB_VGV_Terreno.Value / ºCusto_Obra) * 100
                Call FormatarNum("CadastroUnidades", "PRTC_PRMT", 2)
            End If
            .PRTC_PRMT.Value = 0
            If Application.IfError(ºCusto_Obra, 0) <> 0 Then
                a = ºP_Fisica + ºP_Financeira
                .PRTC_PRMT.Value = ((a * ºCusto_Obra) / ºTerrenoVP) * 100
            End If
            Call FormatarNum("CadastroUnidades", "PRTC_PRMT", 2)
            .TB_TX_Permut_Fis.Value = 0
            If Application.IfError(ThisWorkbook.Sheets("Fluxo Operacional").Range("ag21").Value, "E") <> "E" And Application.IfError(ThisWorkbook.Sheets("Fluxo Operacional").Range("l11").Value, "E") <> "E" And Application.IfError(ThisWorkbook.Sheets("Fluxo Operacional").Range("f15").Value, "E") <> "E" Then
                .TB_TX_Permut_Fis.Value = ((ºP_Fisica * ºCusto_Obra) / ºTerrenoVP) * 100
            End If
            Call FormatarNum("CadastroUnidades", "TB_TX_Permut_Fis", 2)
            ºC_TOT_ANT = Application.IfError(Application.Match("PERMUTA FINANCEIRA", ThisWorkbook.Sheets("Fluxo Operacional").Rows(5), 0), 0)
            .TB_TX_Permut_Financ.Value = 0
            If ºC_TOT_ANT <> 0 Then
                .TB_TX_Permut_Financ.Value = ((ºP_Financeira * ºCusto_Obra) / ºTerrenoVP) * 100
            End If
            Call FormatarNum("CadastroUnidades", "TB_TX_Permut_Financ", 2)
        End If
    End With
End Sub

Sub CLIQUE_ASS()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        If ThisWorkbook.Sheets("BD_CAD_VND").Range("B480").Value Then
            .Backs.BackStyle = fmBackStyleTransparent
            .AS_PZ_DOC.Enabled = True
            .AS_TX_MD_OBRA.Enabled = True
            .AS_PRCT_DEFLA.Enabled = True
            .AS_PRCT_SEG_OBRA.Enabled = True
            .AS_ADM_P_UNID.Enabled = True
            .AS_ADM_TOTAL.Enabled = True
            .AS_TX_CONTRATO.Enabled = True
            .AS_TOTAL_CONTRATO.Enabled = True
            .AS_PZ_LIBERACAO.Enabled = True
            .AS_PZ_ULTIMA.Enabled = True
            .AS_VLR_TERRENO.Enabled = True
            .CB_DEFLA.Enabled = True
            
            .CB_DEFLA.Clear
            .CB_DEFLA.AddItem "Primeira Venda"
            .CB_DEFLA.AddItem "Venda da Unidade"
            .CB_DEFLA.AddItem "Inicio do Repasse"
            
            Call CarregarTotais
            Call TotalizarCusto
            
            'TAXA DE MEDIÇÃO
            ºR = Application.Match("ºAS_TX_MD_OBRA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            .AS_TX_MD_OBRA.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
            Call FormatarNumCur("CadastroUnidades", "AS_TX_MD_OBRA", 2)
            
            'TAXA DE DEFLAÇÃO
            ºR = Application.Match("ºAS_PRCT_DEFLA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            .AS_PRCT_DEFLA.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        
            'TAXA DE SEGURO DE OBRA
            ºR = Application.Match("ºAS_PRCT_SEG_OBRA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            .AS_PRCT_SEG_OBRA.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
            
            'TAXA DE ADMINISTRAÇÃO
            ºR = Application.Match("ºAS_ADM_P_UNID", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            .AS_ADM_P_UNID.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
            If .AS_ADM_P_UNID.Value <> "" And .AS_UNID_TOTAL <> "" Then .AS_ADM_TOTAL = Format((.AS_UNID_TOTAL.Caption * .AS_ADM_P_UNID.Value), "#,##0.00")
            
            'TAXA DE EMISSÃO DO CONTRATO
            ºR = Application.Match("ºAS_TX_CONTRATO", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            .AS_TX_CONTRATO.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
            If .AS_TX_CONTRATO.Value <> "" And .AS_UNID_TOTAL <> "" Then .AS_TOTAL_CONTRATO = Format((.AS_UNID_TOTAL.Caption * .AS_TX_CONTRATO.Value), "#,##0.00")
            
            'PRAZO DE DOCUMENTAÇAO
            ºR = Application.Match("ºAS_PZ_DOC", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            .AS_PZ_DOC.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
            
            'PRAZO DE LIBERAÇÃO
            ºR = Application.Match("ºAS_PZ_LIBERACAO", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            .AS_PZ_LIBERACAO.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        
            'ULTIMA PARCELA
            ºR = Application.Match("ºAS_PZ_ULTIMA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            .AS_PZ_ULTIMA.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
        
            'TAXA DE DEFLAÇÃO
            ºR = Application.Match("ºAS_PRCT_DEFLA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            .AS_PRCT_DEFLA.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
            
            'VALOR DO TERRENO
            ºR = Application.Match("ºAS_VLR_TERRENO", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            .AS_VLR_TERRENO.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
            
            'INICIO DEFLAÇÃO
            ºR = Application.Match("ºAS_DEFLA_Vend", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
            
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = True Then
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = "Venda da Unidade"
                .CB_DEFLA.Value = "Venda da Unidade"
            ElseIf ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = False Then
                ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = "Primeira Venda"
                .CB_DEFLA.Value = "Primeira Venda"
            Else
                .CB_DEFLA.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value
            End If

            
        Else
            .Backs.BackStyle = fmBackStyleOpaque
            .AS_PZ_DOC.Enabled = False
            .AS_PZ_DOC.Value = ""
            .AS_TX_MD_OBRA.Enabled = False
            .AS_TX_MD_OBRA.Value = ""
            .AS_PRCT_DEFLA.Enabled = False
            .AS_PRCT_DEFLA.Value = ""
            .AS_PRCT_SEG_OBRA.Enabled = False
            .AS_PRCT_SEG_OBRA.Value = ""
            .AS_ADM_P_UNID.Enabled = False
            .AS_ADM_P_UNID.Value = ""
            .AS_ADM_TOTAL.Enabled = False
            .AS_ADM_TOTAL.Value = ""
            .AS_TX_CONTRATO.Enabled = False
            .AS_TX_CONTRATO.Value = ""
            .AS_TOTAL_CONTRATO.Enabled = False
            .AS_TOTAL_CONTRATO.Value = ""
            .AS_PZ_LIBERACAO.Enabled = False
            .AS_PZ_LIBERACAO.Value = ""
            .AS_PZ_ULTIMA.Enabled = False
            .AS_PZ_ULTIMA.Value = ""
            .AS_VLR_TERRENO.Enabled = False
            .CB_DEFLA.Enabled = False
            .AS_VLR_TERRENO.Value = ""
            .AS_TB_Custo_Raso = ""
            .AS_UNID_TOTAL = ""
        End If
    End With
End Sub

Sub RefreshListViews()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    CadastroUnidades.LIST_Perfil_Venda_B.Visible = False
    CadastroUnidades.LV_Show_TBL_VND.Visible = False
    CadastroUnidades.LV_Show_Curvas_Velocidade.Visible = False
    CadastroUnidades.LIST_Perfil_Venda.Visible = False
    CadastroUnidades.List_Tabela.Visible = False
    CadastroUnidades.LIST_Velocidade.Visible = False
    CadastroUnidades.LV_FasesObra.Visible = False
    CadastroUnidades.LV_CurvasObra.Visible = False
    CadastroUnidades.LV_Lançamentos_TI.Visible = False
    
    CadastroUnidades.LIST_Perfil_Venda_B.Visible = True
    CadastroUnidades.LV_Show_TBL_VND.Visible = True
    CadastroUnidades.LV_Show_Curvas_Velocidade.Visible = True
    CadastroUnidades.LIST_Perfil_Venda.Visible = True
    CadastroUnidades.List_Tabela.Visible = True
    CadastroUnidades.LIST_Velocidade.Visible = True
    CadastroUnidades.LV_FasesObra.Visible = True
    CadastroUnidades.LV_CurvasObra.Visible = True
    CadastroUnidades.LV_Lançamentos_TI.Visible = True
End Sub
Sub Carregar_Curva_Lcto(ºItem As Double)
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    CadastroUnidades.LV_Curva_LCTO.ColumnHeaders.Clear
    CadastroUnidades.LV_Curva_LCTO.ListItems.Clear
    CadastroUnidades.LV_Curva_LCTO.ColumnHeaders.Add , , "%", 60
    CadastroUnidades.LV_Curva_LCTO.ColumnHeaders.Add , , "Mês Flx.", 40
    ºLinha = CadastroUnidades.LV_Lançamentos_TI.ListItems(ºItem).SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "COD") - 1)
    
    ºvalor = ThisWorkbook.Sheets("Lançamentos").Range("I" & ºLinha).Value
    ºFATOR = ThisWorkbook.Sheets("Lançamentos").Range("D" & ºLinha).Value
    ºINICIO = ThisWorkbook.Sheets("Lançamentos").Range("G" & ºLinha).Value
    CadastroUnidades.CB_MESES_TI.Enabled = True
    If ThisWorkbook.Sheets("Lançamentos").Range("J" & ºLinha).Value Then
        CadastroUnidades.DEL_CURVA_LCTO.Enabled = True
        CadastroUnidades.TB_Parcelas_TI.Enabled = False
        CadastroUnidades.CB_PERIODICIDADE_TI.Enabled = False
        ºcolunas = ThisWorkbook.Sheets("LANÇAMENTOS").Cells(ºLinha, 112).End(xlToLeft).Column
        For ºI = 11 To ºcolunas
            ºvalor = ThisWorkbook.Sheets("LANÇAMENTOS").Cells(ºLinha, ºI).Value
            Set ºLi = CadastroUnidades.LV_Curva_LCTO.ListItems.Add(, , Format(ºvalor, "0.00000%"))
            ºLi.SubItems(1) = ºINICIO + ºI - 11
        Next
    Else
        ºPARCELAS = ThisWorkbook.Sheets("Lançamentos").Range("E" & ºLinha).Value
        ºTipo = ThisWorkbook.Sheets("Lançamentos").Range("F" & ºLinha).Value
        If ºTipo <> "Curva de Obra" And ºTipo <> "" Then
            ºPeriod = ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & Application.Match(ºTipo, ThisWorkbook.Sheets("BD_CAD_VND").Range("C523:C550"), 0) + 522).Value
            For ºP = 1 To ºPARCELAS
                Set ºLi = CadastroUnidades.LV_Curva_LCTO.ListItems.Add(, , Format(1 / ºPARCELAS, "0.00000%"))
                ºLi.SubItems(1) = ºINICIO + ((ºP - 1) * ºPeriod)
            Next
        Else
            ºCURVA = CInt(ThisWorkbook.Sheets("BD_CAD_VND").Cells(209 + CadastroUnidades.LV_Lançamentos_TI.ListItems(ºItem), 3).Value)
            If ºCURVA <> "" Then
                ºINICIO = DIF_DT_LCTO(ThisWorkbook.Sheets("BD_CAD_VND").Cells(261, 1 + ºCURVA).Value, 0)
                For ºP = 262 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(461, 1 + ºCURVA).End(xlUp).Row
                    Set ºLi = CadastroUnidades.LV_Curva_LCTO.ListItems.Add(, , Format(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºP, 1 + ºCURVA).Value, "0.00000%"))
                    ºLi.SubItems(1) = ºINICIO + ºP - 262
                Next
            Else
                MsgBox "Não existe curva de obra cadastrada"
            End If
        End If
    End If
End Sub
Sub Descarregar_Curva_Lcto(ºLinha As Double)
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If CadastroUnidades.LV_Curva_LCTO.ListItems.Count > 0 Then
        If CadastroUnidades.LV_Curva_LCTO.ColumnHeaders.Count > 2 Then ThisWorkbook.Sheets("LANÇAMENTOS").Range("J" & ºLinha).Value = True
        For ºI = 11 To 10 + CadastroUnidades.LV_Curva_LCTO.ListItems.Count
            ThisWorkbook.Sheets("LANÇAMENTOS").Cells(ºLinha, ºI).Value = Replace(CadastroUnidades.LV_Curva_LCTO.ListItems(ºI - 10), ",", ".")
        Next
    End If
    ThisWorkbook.Sheets("LANÇAMENTOS").Range("J" & ºLinha).Value = True
    CadastroUnidades.LV_Curva_LCTO.ColumnHeaders.Clear
    CadastroUnidades.LV_Curva_LCTO.ListItems.Clear
End Sub

Function Check_Curva_Lcto(ºLinha As Double) As Boolean
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Function
    
    Check_Curva_Lcto = True
    If CadastroUnidades.LV_Curva_LCTO.ListItems.Count > 0 Then
        For ºI = 11 To 10 + CadastroUnidades.LV_Curva_LCTO.ListItems.Count
            ºTotal = ºTotal + CDbl(Replace(CadastroUnidades.LV_Curva_LCTO.ListItems(ºI - 10), "%", ""))
        Next
        If Round(ºTotal, 0) = 100 Then Check_Curva_Lcto = True Else Check_Curva_Lcto = False
    End If
End Function

Sub Inserir_Curva_Lançamento()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With Application.FileDialog(msoFileDialogOpen)
        .Filters.Clear
        .Filters.Add "Arquivo do Excel", "*.xls*"
        .Show
        If .SelectedItems.Count > 0 Then ºARQUIVO = .SelectedItems(1)
    End With
    If ºARQUIVO <> "" Then
        CadastroUnidades.LV_Curva_LCTO.ColumnHeaders.Clear
        CadastroUnidades.LV_Curva_LCTO.ListItems.Clear
        CadastroUnidades.LV_Curva_LCTO.ColumnHeaders.Add , , "Mês Flx.", 40
        CadastroUnidades.LV_Curva_LCTO.ColumnHeaders.Add , , "%", 60
        CadastroUnidades.LV_Curva_LCTO.ColumnHeaders.Add , , " ", 1
        If CadastroUnidades.CB_MESES_TI.Value <> "" Then ºINICIO = CadastroUnidades.CB_MESES_TI.Value Else ºINICIO = 0
        Workbooks.Open ºARQUIVO, False, True
        CadastroUnidades.TB_Parcelas_TI = Workbooks(Dir(ºARQUIVO)).Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row
        CadastroUnidades.TB_Parcelas_TI.Enabled = False
        CadastroUnidades.CB_PERIODICIDADE_TI.Value = "Mensal"
        CadastroUnidades.CB_PERIODICIDADE_TI.Enabled = False
        
        If Workbooks(Dir(ºARQUIVO)).Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row > 1 Then
            ºTotal = Application.Sum(Workbooks(Dir(ºARQUIVO)).Sheets(1).Columns(1))
            For ºL = 1 To Workbooks(Dir(ºARQUIVO)).Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row
                Set ºLi = CadastroUnidades.LV_Curva_LCTO.ListItems.Add(, , ºINICIO + ºL - 1)
                If Application.IfError(Application.Search("%", Workbooks(Dir(ºARQUIVO)).Sheets(1).Cells(ºL, 1).Text), 0) <> 0 Then
                    ºLi.SubItems(1) = Format(Workbooks(Dir(ºARQUIVO)).Sheets(1).Cells(ºL, 1).Value, "0.00000%")
                Else
                    ºLi.SubItems(1) = Format(Workbooks(Dir(ºARQUIVO)).Sheets(1).Cells(ºL, 1).Value / ºTotal, "0.00000%")
                End If
            Next
        End If
        Workbooks(Dir(ºARQUIVO)).Close , False
    End If
End Sub

Sub CARREGAR_CAPA()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    With CadastroUnidades
        '___________________________________________________________________________________________________
        '|||||||||||||||||||||INFORMAÇÕES DO ESTUDO E PARAMETROS SENSIBILIDADE||||||||||||||||||||||||||||||
        '¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
        'NOME DO ESTUDO
        .TB_NOME_ESTUDO.Value = ºNOME_VERSÃO("")
        
        'INDEXADO A
        .CB_INDEXADO.Clear
        .CB_INDEXADO.AddItem "CDI"
        .CB_INDEXADO.AddItem "WACC"
        If ºINDEX("") <> "" Then .CB_INDEXADO.Value = ºINDEX("") Else .CB_INDEXADO.Value = "WACC"
        If ºINDEX("") = "" Then ºINDEX ("WACC")
        
        'DATA BASE
        .DT_Base.Value = ºDATA_BASE("")
        
        'LCTO FASE 1
        .DT_Fase_1.Value = ºDATA_FASE_1("")
        
        'VARIAVEL 1 SENSIBILIDADE
        If ºVAR_1("") <> "" Then .TB_VAR_1.Value = Round(ºVAR_1(""), 0) Else .TB_VAR_1.Value = 0
        
        'VARIAVEL 2 SENSIBILIDADE
        If ºVAR_2("") <> "" Then .TB_VAR_2.Value = Round(ºVAR_2(""), 0) Else .TB_VAR_2.Value = 0
        
        
        'FATOR 1 SENSIBILIDADE
        .CB_FATOR_1.Clear
        .CB_FATOR_1.AddItem "R$"
        .CB_FATOR_1.AddItem "%"
        If ºFTR_1("") <> "" Then .CB_FATOR_1.Value = ºFTR_1("") Else .CB_FATOR_1.Value = "R$"
        If ºFTR_1("") = "" Then ºFTR_1 ("R$")
        
        'FATOR 2 SENSIBILIDADE
        .CB_FATOR_2.Clear
        .CB_FATOR_2.AddItem "R$"
        .CB_FATOR_2.AddItem "%"
        If ºFTR_2("") <> "" Then .CB_FATOR_2.Value = ºFTR_2("") Else .CB_FATOR_2.Value = "R$"
        If ºFTR_2("") = "" Then ºFTR_2 ("R$")
        '___________________________________________________________________________________________________
        '||||||||||||||||||||||||||||||||||||| REALIZADO |||||||||||||||||||||||||||||||||||||||||||||||||||
        '¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
        'RECEITA
        'Total
        .RN_R_RECEITA.Caption = Format(CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b556").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b557").Value) - CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b558").Value), "#,##0")
        'Vendas
        .RN_R_VENDAS.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B556").Value, 0), "#,##0")
        'Receita Financeira
        .RN_R_RECFIN.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B557").Value, 0), "#,##0")
        'Deflação
        .RN_R_DEFLA.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B558").Value, 0), "#,##0")
        
        'IMPOSTOS
        .RN_R_IMP.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B559").Value, 0), "#,##0")
        
        'TERRENOS
        'Total
        .RN_R_TP1.Caption = Format(CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b560").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b561").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b562").Value), "#,##0")
        'Pagamento
        .RN_R_PG.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B560").Value, 0), "#,##0")
        'Cepac/Outorga
        .RN_R_CPCOTG.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B561").Value, 0), "#,##0")
        'Outros
        .RN_R_OUTROS.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B562").Value, 0), "#,##0")

        'PROPAGANDA
        .RN_R_P2.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B563").Value, 0), "#,##0")
    
        'OBRA
        'Total
        .RN_R_P3.Caption = Format(CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b564").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b565").Value), "#,##0")
        'Custo raso
        .RN_R_CST_C.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B564").Value, 0), "#,##0")
        'Custo de Administração
        .RN_R_CST_ADM.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B565").Value, 0), "#,##0")
    
        'INCORPORAÇÃO
        .RN_R_P34.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B566").Value, 0), "#,##0")
    
        'RELACIONAMENTO
        .RN_R_P4.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B567").Value, 0), "#,##0")
    
        'DTAS
        .RN_R_P5.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B568").Value, 0), "#,##0")
    
        'COMERCIAL
        'Total
        .RN_R_P6.Caption = Format(CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b569").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b570").Value), "#,##0")
        'Comissão
        .RN_R_COMSS.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B569").Value, 0), "#,##0")
        'Prêmio
        .RN_R_PREMIO.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B570").Value, 0), "#,##0")
    
        'ADM CARTEIRA
        .RN_R_P8.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B571").Value, 0), "#,##0")
        
        'DESPESAS COM CREDITO ASSOCIATIVO
        'Total
        .RN_R_P7.Caption = Format(CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("B572").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("b573").Value), "#,##0")
        'Taxa de Medição
        .RN_R_TXMD.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B572").Value, 0), "#,##0")
        'Emissão de Contrato
        .RN_R_EMC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B573").Value, 0), "#,##0")
                
        'OUTRAS DESPESAS
        .RN_R_OD.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B574").Value, 0), "#,##0")

        'TOTAL
        .RN_R_RL.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("B575").Value, 0), "#,##0")

        '___________________________________________________________________________________________________
        '||||||||||||||||||||||||||||||||||||| A REALIZAR ||||||||||||||||||||||||||||||||||||||||||||||||||
        '¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
        'RECEITA
        'Total
        ºSoma = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C556").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C557").Value) - CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C558").Value)
        .RN_AR_RECEITA.Caption = Format(ºSoma, "#,##0")
        'Vendas
        .RN_AR_VENDAS.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C556").Value, 0), "#,##0")
        'Receita Financeira
        .RN_AR_RECFIN.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C557").Value, 0), "#,##0")
        'Deflação
        .RN_AR_DEFLA.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C558").Value, 0), "#,##0")
        
        'IMPOSTOS
        .RN_AR_IMP.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C559").Value, 0), "#,##0")
        
        'TERRENOS
        'Total
        ºSoma = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C560").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C561").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C562").Value)
        .RN_AR_TP1.Caption = Format(ºSoma, "#,##0")
        'Pagamento
        .RN_AR_PG.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C560").Value, 0), "#,##0")
        'Cepac/Outorga
        .RN_AR_CPCOTG.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C561").Value, 0), "#,##0")
        'Outros
        .RN_AR_OUTROS.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C562").Value, 0), "#,##0")

        'PROPAGANDA
        .RN_AR_P2.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C563").Value, 0), "#,##0")
    
        'OBRA
        'Total
        ºSoma = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C564").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C565").Value)
        .RN_AR_P3.Caption = Format(ºSoma, "#,##0")
        'Custo raso
        .RN_AR_CST_C.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C564").Value, 0), "#,##0")
        'Custo de Administração
        .RN_AR_CST_ADM.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C565").Value, 0), "#,##0")
    
        'INCORPORAÇÃO
        .RN_AR_P34.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C566").Value, 0), "#,##0")
    
        'RELACIONAMENTO
        .RN_AR_P4.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C567").Value, 0), "#,##0")
    
        'DTAS
        .RN_AR_P5.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C568").Value, 0), "#,##0")
    
        'COMERCIAL
        'Total
        ºSoma = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C569").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C570").Value)
        .RN_AR_P6.Caption = Format(ºSoma, "#,##0")
        'Comissão
        .RN_AR_COMSS.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C569").Value, 0), "#,##0")
        'Prêmio
        .RN_AR_PREMIO.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C570").Value, 0), "#,##0")
    
        'ADM CARTEIRA
        .RN_AR_P8.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C571").Value, 0), "#,##0")
        
        'DESPESAS COM CREDITO ASSOCIATIVO
        'Total
        ºSoma = CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C572").Value) + CDbl(ThisWorkbook.Sheets("BD_CAD_VND").Range("C573").Value)
        .RN_AR_P7.Caption = Format(ºSoma, "#,##0")
        'Taxa de Medição
        .RN_AR_TXMD.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C572").Value, 0), "#,##0")
        'Emissão de Contrato
        .RN_AR_EMC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C573").Value, 0), "#,##0")
        
        'OUTRAS DESPESAS
        .RN_AR_OD.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C574").Value, 0), "#,##0")

        'TOTAL
        .RN_AR_RL.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("C575").Value, 0), "#,##0")
        '___________________________________________________________________________________________________
        '||||||||||||||||||||||||||||||||||||||| TOTAL |||||||||||||||||||||||||||||||||||||||||||||||||||||
        '¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
        'RECEITA
        'Total
        .RN_T_RECEITA.Caption = Format(CDbl(.RN_R_RECEITA.Caption) + CDbl(.RN_AR_RECEITA.Caption), "#,##0")
        .RN_P_RECEITA.Caption = "100%"
        'Vendas
        .RN_T_VENDAS.Caption = Format(CDbl(.RN_R_VENDAS.Caption) + CDbl(.RN_AR_VENDAS.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_VENDAS.Caption = Format(.RN_T_VENDAS.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_VENDAS.Caption = "0,0%"
        'Receita Financeira
        .RN_T_RECFIN.Caption = Format(CDbl(.RN_R_RECFIN.Caption) + CDbl(.RN_AR_RECFIN.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_RECFIN.Caption = Format(.RN_T_RECFIN.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_RECFIN.Caption = "0,0%"
        'Deflação
        .RN_T_DEFLA.Caption = Format(CDbl(.RN_R_DEFLA.Caption) + CDbl(.RN_AR_DEFLA.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_DEFLA.Caption = Format(.RN_T_DEFLA.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_DEFLA.Caption = "0,0%"
        
        'IMPOSTOS
        .RN_T_IMP.Caption = Format(CDbl(.RN_R_IMP.Caption) + CDbl(.RN_AR_IMP.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_IMP.Caption = Format(.RN_T_IMP.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_IMP.Caption = "0,0%"
        
        'TERRENOS
        'Total
        .RN_T_TP1.Caption = Format(CDbl(.RN_R_TP1.Caption) + CDbl(.RN_AR_TP1.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_TP1.Caption = Format(.RN_T_TP1.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_TP1.Caption = "0,0%"
        'Pagamento
        .RN_T_PG.Caption = Format(CDbl(.RN_R_PG.Caption) + CDbl(.RN_AR_PG.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_PG.Caption = Format(.RN_T_PG.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_PG.Caption = "0,0%"
        'Cepac/Outorga
        .RN_T_CPCOTG.Caption = Format(CDbl(.RN_R_CPCOTG.Caption) + CDbl(.RN_AR_CPCOTG.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_CPCOTG.Caption = Format(.RN_T_CPCOTG.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_CPCOTG.Caption = "0,0%"
        'Outros
        .RN_T_OUTROS.Caption = Format(CDbl(.RN_R_OUTROS.Caption) + CDbl(.RN_AR_OUTROS.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_OUTROS.Caption = Format(.RN_T_OUTROS.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_OUTROS.Caption = "0,0%"

        'PROPAGANDA
        .RN_T_P2.Caption = Format(CDbl(.RN_R_P2.Caption) + CDbl(.RN_AR_P2.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_P2.Caption = Format(.RN_T_P2.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_P2.Caption = "0,0%"
    
        'OBRA
        'Total
        .RN_T_P3.Caption = Format(CDbl(.RN_R_P3.Caption) + CDbl(.RN_AR_P3.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_P3.Caption = Format(.RN_T_P3.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_P3.Caption = "0,0%"
        'Custo raso
        .RN_T_CST_C.Caption = Format(CDbl(.RN_R_CST_C.Caption) + CDbl(.RN_AR_CST_C.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_CST_C.Caption = Format(.RN_T_CST_C.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_CST_C.Caption = "0,0%"
        'Custo de Administração
        .RN_T_CST_ADM.Caption = Format(CDbl(.RN_R_CST_ADM.Caption) + CDbl(.RN_AR_CST_ADM.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_CST_ADM.Caption = Format(.RN_T_CST_ADM.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_CST_ADM.Caption = "0,0%"
    
        'INCORPORAÇÃO
        .RN_T_P34.Caption = Format(CDbl(.RN_R_P34.Caption) + CDbl(.RN_AR_P34.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_P34.Caption = Format(.RN_T_P34.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_P34.Caption = "0,0%"
    
        'RELACIONAMENTO
        .RN_T_P4.Caption = Format(CDbl(.RN_R_P4.Caption) + CDbl(.RN_AR_P4.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_P4.Caption = Format(.RN_T_P4.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_P4.Caption = "0,0%"
    
        'DTAS
        .RN_T_P5.Caption = Format(CDbl(.RN_R_P5.Caption) + CDbl(.RN_AR_P5.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_P5.Caption = Format(.RN_T_P5.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_P5.Caption = "0,0%"
    
        'COMERCIAL
        'Total
        .RN_T_P6.Caption = Format(CDbl(.RN_R_P6.Caption) + CDbl(.RN_AR_P6.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_P6.Caption = Format(.RN_T_P6.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_P6.Caption = "0,0%"
        'Comissão
        .RN_T_COMSS.Caption = Format(CDbl(.RN_R_COMSS.Caption) + CDbl(.RN_AR_COMSS.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_COMSS.Caption = Format(.RN_T_COMSS.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_COMSS.Caption = "0,0%"
        'Prêmio
        .RN_T_PREMIO.Caption = Format(CDbl(.RN_R_PREMIO.Caption) + CDbl(.RN_AR_PREMIO.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_PREMIO.Caption = Format(.RN_T_PREMIO.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_PREMIO.Caption = "0,0%"
    
        'ADM CARTEIRA
        .RN_T_P8.Caption = Format(CDbl(.RN_R_P8.Caption) + CDbl(.RN_AR_P8.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_P8.Caption = Format(.RN_T_P8.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_P8.Caption = "0,0%"
        
        'DESPESAS COM CREDITO ASSOCIATIVO
        'Total
        .RN_T_P7.Caption = Format(CDbl(.RN_R_P7.Caption) + CDbl(.RN_AR_P7.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_P7.Caption = Format(.RN_T_P7.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_P7.Caption = "0,0%"
        'Taxa de Medição
        .RN_T_TXMD.Caption = Format(CDbl(.RN_R_TXMD.Caption) + CDbl(.RN_AR_TXMD.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_TXMD.Caption = Format(.RN_T_TXMD.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_TXMD.Caption = "0,0%"
        'Emissão de Contrato
        .RN_T_EMC.Caption = Format(CDbl(.RN_R_EMC.Caption) + CDbl(.RN_AR_EMC.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_EMC.Caption = Format(.RN_T_EMC.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_EMC.Caption = "0,0%"

        'OUTRAS DESPESAS
        .RN_T_OD.Caption = Format(CDbl(.RN_R_OD.Caption) + CDbl(.RN_AR_OD.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_OD.Caption = Format(.RN_T_OD.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_OD.Caption = "0,0%"
        
        'TOTAL
        .RN_T_RL.Caption = Format(CDbl(.RN_R_RL.Caption) + CDbl(.RN_AR_RL.Caption), "#,##0")
        If .RN_T_RECEITA.Caption <> 0 Then .RN_P_RL.Caption = Format(.RN_T_RL.Caption / .RN_T_RECEITA.Caption, "0.0%") Else .RN_P_RL.Caption = "0,0%"
    
        '___________________________________________________________________________________________________
        '||||||||||||||||||||||||||||||||||||| RESULTADOS A VP |||||||||||||||||||||||||||||||||||||||||||||
        '¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
        'WACC
        'Receita
        .RCT_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E556").Value, 0), "#,##0")
        'Impostos
        .IMP_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E557").Value, 0), "#,##0")
        '1. Valor Pago no Terreno
        .PGT_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E558").Value, 0), "#,##0")
        '1. Outras Despesas de Terreno
        .ODT_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E559").Value, 0), "#,##0")
        '2. Marketing
        .MKT_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E560").Value, 0), "#,##0")
        '3. Custo de Obra
        .CSTO_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E561").Value, 0), "#,##0")
        '3.4 Incorporação
        .INC_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E562").Value, 0), "#,##0")
        '6. Comercial
        .COMERCIAL_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E563").Value, 0), "#,##0")
        'Despesas e Custos Total
        .DESCUST_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E564").Value, 0), "#,##0")
        'Exposição Máxima
        .EXP_LABEL.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("D565").Value, 0), "#,##0")
        .ESPS_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E565").Value, 0), "#,##0")
        'Custo Efetivo do Terreno (Obra)
        .CST_EFT_O_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E566").Value, 0), "#,##0")
        'Custo Efetivo do Terreno (Venda)
        .CST_EFT_VND_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E567").Value, 0), "#,##0")
        'VPL
        .VPL_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E568").Value, 0), "#,##0")
        'Margem Bruta
        .MRG_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E569").Value, 0), "0.00%")
        'VPL/Custo Terreno (Obra)
        .VPL_CST_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E570").Value, 0), "0.00%")
        'VPL/Receita
        .VPL_RCT_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E571").Value, 0), "0.00%")
        'TIR (a.a.)
        .TIR_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E572").Value, 0), "0.00%")
        'Valor  m² (médio) Mínimo
        .VLM_MIN_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E573").Value, 0), "#,##0")
        'Valor  m² (médio) Meta - (16,5%)
        .VLM_MET_WACC.Caption = Format(Application.IfError(ThisWorkbook.Sheets("BD_CAD_VND").Range("E574").Value, 0), "#,##0")
    End With
End Sub
Sub CALCULAR_INFO_CAPA()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Application.Calculate
    DoEvents
    
    '___________________________________________________________________________________________________
    '||||||||||||||||||||||||||||||||||||| REALIZADO |||||||||||||||||||||||||||||||||||||||||||||||||||
    '¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
    ºL = Application.IfError(Application.Match(0, ThisWorkbook.Sheets("Fluxo Operacional").Range("B:B"), 0), 0)
    'RECEITA
    'Vendas
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B556").Value = Format(Application.IfError(ThisWorkbook.Sheets("BD_APOIO").Range("B6").Value, 0), "#,##0.00")
    'Receita Financeira
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B557").Value = Format(Application.IfError(ThisWorkbook.Sheets("BD_APOIO").Range("B7").Value, 0), "#,##0.00")
    'Deflação
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B558").Value = Format(Application.IfError(ThisWorkbook.Sheets("BD_APOIO").Range("B2").Value, 0), "#,##0.00")
        
    'IMPOSTOS
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B559").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G23").Value, 0), "#,##0.00")
        
    'TERRENOS
    'Pagamento
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B560").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G25").Value, 0), "#,##0.00")
    'Cepac/Outorga
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B561").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G26").Value, 0), "#,##0.00")
    'Outros
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B562").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G27").Value, 0), "#,##0.00")

    'PROPAGANDA
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B563").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G28").Value, 0), "#,##0.00")
    
    'OBRA
    'Custo raso + taxas
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B564").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G30").Value, 0), "#,##0.00")
    'Outros Custos
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B565").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G31").Value, 0), "#,##0.00")
    
    'INCORPORAÇÃO
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B566").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G32").Value, 0), "#,##0.00")
    
    'RELACIONAMENTO
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B567").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G33").Value, 0), "#,##0.00")
    
    'DTAS
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B568").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G34").Value, 0), "#,##0.00")
    
    'COMERCIAL
    'Comissão + Prêmio
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B569").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G36").Value, 0), "#,##0.00")
    'Outras Despesas
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B570").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G37").Value, 0), "#,##0.00")
    
    'ADM CARTEIRA
    ºC = Application.IfError(Application.Match("TOTAL PEP 8", ThisWorkbook.Sheets("Fluxo Operacional").Range("5:5"), 0), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B571").Value = 0
    If ºC <> 0 Then
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B571").Value = Format(Application.IfError(Application.Sum(ThisWorkbook.Sheets("Fluxo Operacional").Range(Cells(6, ºC).Address & ":" & Cells(ºL, ºC).Address).Value), 0), "#,##0.00")
    End If
        
    'DESPESAS COM CREDITO ASSOCIATIVO
    'Taxa de Medição
    ºC = Application.IfError(Application.Match("TAXA DE MEDIÇÃO", ThisWorkbook.Sheets("Fluxo Operacional").Range("5:5"), 0), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B572").Value = 0
    If ºC <> 0 Then
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B572").Value = Format(Application.IfError(Application.Sum(ThisWorkbook.Sheets("Fluxo Operacional").Range(Cells(6, ºC).Address & ":" & Cells(ºL, ºC).Address).Value), 0), "#,##0.00")
    End If
    'Emissão de Contrato
    ºC = Application.IfError(Application.Match("EMISSÃO DE CONTRATO", ThisWorkbook.Sheets("Fluxo Operacional").Range("5:5"), 0), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B573").Value = 0
    If ºC <> 0 Then
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B573").Value = Format(Application.IfError(Application.Sum(ThisWorkbook.Sheets("Fluxo Operacional").Range(Cells(6, ºC).Address & ":" & Cells(ºL, ºC).Address).Value), 0), "#,##0.00")
    End If
        
    'OUTRAS DESPESAS
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B574").Value = _
    Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G38").Value - ThisWorkbook.Sheets("BD_CAD_VND").Range("B573").Value - ThisWorkbook.Sheets("BD_CAD_VND").Range("B572").Value, 0), "#,##0.00")
        
    'TOTAL
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B575").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("G39").Value, 0), "#,##0.00")

    '___________________________________________________________________________________________________
    '||||||||||||||||||||||||||||||||||||| A REALIZAR |||||||||||||||||||||||||||||||||||||||||||||||||||
    '¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C556:C575").NumberFormat = "@"
    
    'RECEITA
    'Vendas
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C556").Value = Format(Application.IfError(ThisWorkbook.Sheets("BD_APOIO").Range("C6").Value, 0), "#,##0.00")
    'Receita Financeira
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C557").Value = Format(Application.IfError(ThisWorkbook.Sheets("BD_APOIO").Range("C7").Value, 0), "#,##0.00")
    'Deflação
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C558").Value = Format(Application.IfError(ThisWorkbook.Sheets("BD_APOIO").Range("C2").Value, 0), "#,##0.00")   'Vendas
            
    'IMPOSTOS
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C559").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M23").Value, 0), "#,##0.00")
        
    'TERRENOS
    'Pagamento
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C560").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M25").Value, 0), "#,##0.00")
    'Cepac/Outorga
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C561").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M26").Value, 0), "#,##0.00")
    'Outros
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C562").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M27").Value, 0), "#,##0.00")

    'PROPAGANDA
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C563").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M28").Value, 0), "#,##0.00")
    
    'OBRA
    'Custo raso + taxas
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C564").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M30").Value, 0), "#,##0.00")
    'Outros Custos
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C565").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M31").Value, 0), "#,##0.00")
    
    'INCORPORAÇÃO
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C566").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M32").Value, 0), "#,##0.00")
    
    'RELACIONAMENTO
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C567").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M33").Value, 0), "#,##0.00")
    
    'DTAS
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C568").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M34").Value, 0), "#,##0.00")
    
    'COMERCIAL
    'Comissão + Prêmio
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C569").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M36").Value, 0), "#,##0.00")
    'Outras Despesas
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C570").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M37").Value, 0), "#,##0.00")
    
    'ADM CARTEIRA
    ºL = Application.IfError(Application.Match(0, ThisWorkbook.Sheets("Fluxo Operacional").Range("B:B"), 0), 0)
    ºL_2 = ThisWorkbook.Sheets("Fluxo Operacional").UsedRange.Rows.Count
    ºC = Application.IfError(Application.Match("TOTAL PEP 8", ThisWorkbook.Sheets("Fluxo Operacional").Range("5:5"), 0), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C571").Value = 0
    If ºC <> 0 Then
        ThisWorkbook.Sheets("BD_CAD_VND").Range("C571").Value = Format(Application.IfError(Application.Sum(ThisWorkbook.Sheets("Fluxo Operacional").Range(Cells(ºL, ºC).Address & ":" & Cells(ºL_2, ºC).Address).Value), 0) * -1, "#,##0.00")
    End If
        
    'DESPESAS COM CREDITO ASSOCIATIVO
    'Taxa de Medição
    ºC = Application.IfError(Application.Match("TAXA DE MEDIÇÃO", ThisWorkbook.Sheets("Fluxo Operacional").Range("5:5"), 0), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C572").Value = 0
    If ºC <> 0 Then
        ThisWorkbook.Sheets("BD_CAD_VND").Range("C572").Value = Format(Application.IfError(Application.Sum(ThisWorkbook.Sheets("Fluxo Operacional").Range(Cells(ºL, ºC).Address & ":" & Cells(ºL_2, ºC).Address).Value), 0) * -1, "#,##0.00")
    End If
    'Emissão de Contrato
    ºC = Application.IfError(Application.Match("EMISSÃO DE CONTRATO", ThisWorkbook.Sheets("Fluxo Operacional").Range("5:5"), 0), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C573").Value = 0
    If ºC <> 0 Then
        ThisWorkbook.Sheets("BD_CAD_VND").Range("C573").Value = Format(Application.IfError(Application.Sum(ThisWorkbook.Sheets("Fluxo Operacional").Range(Cells(ºL, ºC).Address & ":" & Cells(ºL_2, ºC).Address).Value), 0) * -1, "#,##0.00")
    End If
    
    'OUTRAS DESPESAS
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C574").Value = _
    Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M38").Value, 0) - ThisWorkbook.Sheets("BD_CAD_VND").Range("C572").Value - ThisWorkbook.Sheets("BD_CAD_VND").Range("C573").Value, "#,##0.00")
    
    'TOTAL
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C575").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("M39").Value, 0), "#,##0.00")
    
    '___________________________________________________________________________________________________
    '||||||||||||||||||||||||||||||||||||| RESULTADOS A VP |||||||||||||||||||||||||||||||||||||||||||||
    '¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
    'WACC
    'Receita
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E556").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG21").Value, 0), "#,##0.00")
    'Impostos
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E557").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG22").Value, 0), "#,##0.00")
    '1. Valor Pago no Terreno
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E558").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG23").Value, 0), "#,##0.00")
    '1. Outras Despesas de Terreno
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E559").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG24").Value, 0), "#,##0.00")
    '2. Marketing
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E560").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG25").Value, 0), "#,##0.00")
    '3. Custo de Obra
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E561").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG26").Value, 0), "#,##0.00")
    '3.4 Incorporação
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E562").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG27").Value, 0), "#,##0.00")
    '6. Comercial
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E563").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG28").Value, 0), "#,##0.00")
    'Despesas e Custos Total
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E564").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG29").Value, 0), "#,##0.00")
    'Exposição Máxima
    ThisWorkbook.Sheets("BD_CAD_VND").Range("D565").Value = ThisWorkbook.Sheets("Capa Viabilidade").Range("AA30").Value
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E565").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG30").Value, 0), "#,##0.00")
    'Custo Efetivo do Terreno (Obra)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E566").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG31").Value, 0), "#,##0.00")
    'Custo Efetivo do Terreno (Venda)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E567").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG32").Value, 0), "#,##0.00")
    'VPL
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E568").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG33").Value, 0), "#,##0.00")
    'Margem Bruta
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E569").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG34").Value, 0), "0.00%")
    'VPL/Custo Terreno (Obra)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E570").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG35").Value, 0), "0.00%")
    'VPL/Receita
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E571").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG36").Value, 0), "0.00%")
    'TIR (a.a.)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E572").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG37").Value, 0), "0.00%")
    'Valor  m² (médio) Mínimo
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E573").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG38").Value, 0), "#,##0.00")
    'Valor  m² (médio) Meta - (16,5%)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E574").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AG39").Value, 0), "#,##0.00")
    '___________________________________________________________________________________________________
    '||||||||||||||||||||||||||||||||||||| INFO TERRENO |||||||||||||||||||||||||||||||||||||||||||||
    '¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E575").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("AB15").Value, 0), "#,##0.00")
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E576").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("F17").Value, 0), "#,##0.00")
    ThisWorkbook.Sheets("BD_CAD_VND").Range("E577").Value = Format(Application.IfError(ThisWorkbook.Sheets("Capa Viabilidade").Range("B17").Value, 0), "#,##0.00")

End Sub

Sub Checar_Desembolso_Verbas()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºTexto_Alerta = "Foram identificados os seguintes erros no estudo:"
    ºLinPerfis = ThisWorkbook.Sheets("BD_CAD_VND").Cells(208, 3).End(xlUp).Row
    For ºPERF = 159 To ºLinPerfis
        If ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºPERF).Value Then
            Exit For
        End If
    Next
   'PRÊMIO
    ºPREMIO = TaxaPremio(ºPERF)
   'MARKETING
    ºMARKETING = TaxaMarketing(ºPERF)
   'PDV
    ºPDV = TaxaPDV(ºPERF)
   'E-BUSINESS
    ºEBusiness = TaxaEbusiness(ºPERF)
    
    For ºL = 2 To ThisWorkbook.Sheets("Lançamentos").Cells(Rows.Count, 2).End(xlUp).Row
        If ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 2).Value = "MARKETING %" Then
            ºAlocado_Marketing = ºAlocado_Marketing + ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 9).Value
        End If
        If ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 2).Value = "E-BUSINESS" Then
            ºAlocado_EBusiness = ºAlocado_EBusiness + ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 9).Value
        End If
        If ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 2).Value = "PDV" Then
            ºAlocado_PDV = ºAlocado_PDV + ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 9).Value
        End If
        If ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 2).Value = "PRÊMIO" Then
            ºAlocado_Prêmio = ºAlocado_Prêmio + ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 9).Value
        End If
    Next
    
    'PRÊMIO
    If ºPREMIO <> 0 And Round(ºAlocado_Prêmio, 0) < 100 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "A Curva de Prêmio esta INFERIOR a 100%!"
    If ºPREMIO <> 0 And Round(ºAlocado_Prêmio, 0) > 100 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "A Curva de Prêmio esta SUPERIOR a 100%!"
    If ºPREMIO = 0 And Round(ºAlocado_Prêmio, 0) <> 0 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "O perçentual de Prêmio não foi informado!"
    
    'MARKETING
    If ºMARKETING <> 0 And Round(ºAlocado_Marketing, 0) < 100 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "A Curva de Marketing esta INFERIOR a 100%!"
    If ºMARKETING <> 0 And Round(ºAlocado_Marketing, 0) > 100 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "A Curva de Marketing esta SUPERIOR a 100%!"
    If ºMARKETING = 0 And Round(ºAlocado_Marketing, 0) <> 0 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "O perçentual de Marketing não foi informado!"
    
    'PDV
    If ºPDV <> 0 And Round(ºAlocado_PDV, 0) < 100 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "A Curva de PDV esta INFERIOR a 100%!"
    If ºPDV <> 0 And Round(ºAlocado_PDV, 0) > 100 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "A Curva de PDV esta SUPERIOR a 100%!"
    If ºPDV = 0 And Round(ºAlocado_PDV, 0) <> 0 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "O perçentual de PDV não foi informado!"
    
    'E-BUSINESS
    If ºEBusiness <> 0 And Round(ºAlocado_EBusiness, 0) < 100 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "A Curva de E-Business esta INFERIOR a 100%!"
    If ºEBusiness <> 0 And Round(ºAlocado_EBusiness, 0) > 100 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "A Curva de E-Business esta SUPERIOR a 100%!"
    If ºEBusiness = 0 And Round(ºAlocado_EBusiness, 0) <> 0 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "O perçentual de E-Business não foi informado!"
    
    For ºF = 210 To ThisWorkbook.Sheets("bd_cad_vnd").Cells(259, 2).End(xlUp).Row
        'DTAS
        ºDtas = TaxaDTAS(ºF)
        ºAlocado_Dtas = 0
        For ºL = 2 To ThisWorkbook.Sheets("Lançamentos").Cells(Rows.Count, 2).End(xlUp).Row
            If ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 2).Value = "MANUTENÇÃO DE OBRA (%)" And ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 1).Value = ºF - 209 Then
                ºAlocado_Dtas = ºAlocado_Dtas + ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 9).Value
            End If
        Next
        
        If ºDtas <> 0 And Round(ºAlocado_Dtas, 0) < 100 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "Curva de DTAS da fase de obra " & ºF - 209 & " esta INFERIOR a 100%!"
        If ºDtas <> 0 And Round(ºAlocado_Dtas, 0) > 100 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "Curva de DTAS da fase de obra " & ºF - 209 & " esta SUPERIOR a 100%!"
        If ºDtas = 0 And Round(ºAlocado_Dtas, 0) <> 0 Then ºTexto_Alerta = ºTexto_Alerta & Chr(10) & "O perçentual de DTAS da fase de obra " & ºF - 209 & " não foi informado!"
    Next
    
    
    
    If ºTexto_Alerta <> "Foram identificados os seguintes erros no estudo:" Then
        MsgBox (ºTexto_Alerta)
    End If
End Sub


