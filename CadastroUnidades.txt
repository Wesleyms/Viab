VERSION 5.00
Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} CadastroUnidades 
   Caption         =   "VIABILIDADE CYRELA"
   ClientHeight    =   10335
   ClientLeft      =   2040
   ClientTop       =   375
   ClientWidth     =   17880
   OleObjectBlob   =   "CadastroUnidades.frx":0000
   ShowModal       =   0   'False
   StartUpPosition =   2  'CenterScreen
End
Attribute VB_Name = "CadastroUnidades"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False


'DESENVOLVIDO POR:
'ES© EM 09/2016
'WESLEY.MOURA@HOTMAIL.COM
#If Win64 Or VBA7 Then
Private Declare PtrSafe Function DrawMenuBar Lib "user32" (ByVal hwnd As Long) As Long
Private Declare PtrSafe Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
Private Declare PtrSafe Function GetWindowLong Lib "user32" Alias "GetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long) As Long
Private Declare PtrSafe Function SetWindowLong Lib "user32" Alias "SetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long
Private Declare PtrSafe Function GetSystemMenu Lib "user32" (ByVal hwnd As Long, ByVal bRevert As Long) As Long
Private Declare PtrSafe Function DeleteMenu Lib "user32" (ByVal hMenu As Long, ByVal nPosition As Long, ByVal wFlags As Long) As Long
Private Declare PtrSafe Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long()
Private Declare PtrSafe Function SetWindowPos Lib "user32.dll" (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal X As Long, ByVal Y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As Long

#Else
Private Declare Function DrawMenuBar Lib "user32" (ByVal hwnd As Long) As Long
Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
Private Declare Function GetWindowLong Lib "user32" Alias "GetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long) As Long
Private Declare Function SetWindowLong Lib "user32" Alias "SetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long
Private Declare Function GetSystemMenu Lib "user32" (ByVal hwnd As Long, ByVal bRevert As Long) As Long
Private Declare Function DeleteMenu Lib "user32" (ByVal hMenu As Long, ByVal nPosition As Long, ByVal wFlags As Long) As Long
Private Declare Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long()
Private Declare Function SetWindowPos Lib "user32.dll" (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal X As Long, ByVal Y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As Long

#End If

Private Const GWL_STYLE As Long = (-16)
Private Const WS_SYSMENU As Long = &H80000
Private Const WS_MINIMIZEBOX As Long = &H20000
Private Const SC_CLOSE As Long = &HF060
Private Const WM_SETICON As Long = &H80
Private Const ICON_SMALL As Long = 0&
Private Const ICON_BIG  As Long = 1&
Private Type Position
    Left As Single
    Top As Single
End Type


Private Sub ADD_ROW_CRV_VND_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    TB_Percentual_1.Enabled = True
    TB_DURACAO_1.Enabled = True
    TB_BGN_1.Enabled = True
    BT_Save_Velocidade.Enabled = True
    BT_cancel_Velocidade.Enabled = True
    LIST_Velocidade.Enabled = False
    ADD_ROW_CRV_VND.Enabled = False
    DEL_ROW_CRV_VND.Enabled = False
    LIST_Velocidade.Top = 60
    LIST_Velocidade.Height = 90
End Sub


Private Sub BT_cancel_Velocidade_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    TB_Percentual_1.Enabled = False
    TB_DURACAO_1.Enabled = False
    TB_BGN_1.Enabled = False
    BT_Save_Velocidade.Enabled = False
    BT_cancel_Velocidade.Enabled = False
    ADD_ROW_CRV_VND.Enabled = True
    DEL_ROW_CRV_VND.Enabled = True
    LIST_Velocidade.Enabled = True
    LIST_Velocidade.Height = 120
    LIST_Velocidade.Top = 30
    BT_Save_Velocidade.HelpContextID = 0
End Sub


Private Sub BTN_APPROVE_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If MsgBox("Confirma a aprovação desse estudo?" & Chr(10) & "Após a aprovação o estudo não pode ser modificado e só pode ser deletado por um administrador!!", vbYesNo, "Confirmação") = vbYes Then
        ºSTATUS_STUD ("APROVADO")
        BTN_APPROVE.Caption = "ok"
        Call BTN_SAVE_VERSION_Click
        BTN_APPROVE.Caption = ""
    End If
End Sub

Private Sub BTN_SAVE_AS_NEWVERSION_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    Call Checar_Desembolso_Verbas
    Dim fso As Object, NomePasta
    Set fso = CreateObject("Scripting.FileSystemObject")
    If fso.FolderExists(ºDIRETORIO) Then
        ºSTATUS_STUD ("'")
        ºARQUIVO = ºCODIGO_EMP("") & " " & ºNOME_EMP("") & ".vcwbd"
        Workbooks.Open ºDIRETORIO & "\" & ºPASTA & "\" & ºARQUIVO, , , , "wmscyrela2017!,!,"
        ºPLANILHAS = Workbooks(ºARQUIVO).Sheets.Count
        Workbooks(ºARQUIVO).Sheets("000000").Copy After:=Workbooks(ºARQUIVO).Sheets(ºPLANILHAS)
        Workbooks(ºARQUIVO).Sheets(ºPLANILHAS + 1).Name = Format(CDbl(Workbooks(ºARQUIVO).Sheets(ºPLANILHAS).Name) + 1, "000000")
        ºPLANILHAS = Workbooks(ºARQUIVO).Sheets(ºPLANILHAS + 1).Name
        Workbooks(ºARQUIVO).Sheets("CONTROLE").Range("A" & Workbooks(ºARQUIVO).Sheets.Count + 3).Value = ºPLANILHAS
        Workbooks(ºARQUIVO).Sheets("CONTROLE").Range("B" & Workbooks(ºARQUIVO).Sheets.Count + 3).Value = UCase(Environ("Username"))
        Workbooks(ºARQUIVO).Sheets("CONTROLE").Range("C" & Workbooks(ºARQUIVO).Sheets.Count + 3).NumberFormat = "@"
        Workbooks(ºARQUIVO).Sheets("CONTROLE").Range("C" & Workbooks(ºARQUIVO).Sheets.Count + 3).Value = Format(Now, "HH:MM DD/MM/YY")
        Workbooks(ºARQUIVO).Sheets("CONTROLE").Range("F" & Workbooks(ºARQUIVO).Sheets.Count + 3).NumberFormat = "@"
        Workbooks(ºARQUIVO).Sheets("CONTROLE").Range("F" & Workbooks(ºARQUIVO).Sheets.Count + 3).Value = Format(Now, "HH:MM DD/MM/YY")
        Workbooks(ºARQUIVO).Sheets("CONTROLE").Range("G" & Workbooks(ºARQUIVO).Sheets.Count + 3).Value = UCase(Environ("Username"))
        Workbooks(ºARQUIVO).Close True
        
        ºCOD_VERSÃO (ºPLANILHAS)
        ºNOME_VERSÃO (ºNOME_VERSÃO("") & " Cópia")
        Me.TB_NOME_ESTUDO.Value = ºNOME_VERSÃO("")
        BTN_SAVE_AS_NEWVERSION.Caption = "ok"
        Call BTN_SAVE_VERSION_Click
        Call ATT_INFO_GUI
        BTN_SAVE_AS_NEWVERSION.Caption = ""
    Else
        MsgBox ("Banco de dados inacessível, as informações não foram salvas!!")
    End If
End Sub

Private Sub Cancel_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
        
    List_Tabela.Enabled = True
    
    Add.Caption = ""
    List_Tabela.Top = 264
    List_Tabela.Height = 132
            
    Me.CB_TP_PARCELA.Value = ""
    Me.TB_Quantidade.Value = ""
    Me.TB_Inicio.Value = ""
    Me.TB_Percent_VGV.Value = ""
    Me.CB_Cobrar_Juros.Value = ""
    TB_Inicio_Juros.Value = ""
    Me.CB_FX_INICIO.Value = ""
    Me.CB_FX_FIM.Value = ""
    Me.TB_Ultimo.Value = ""

            
    CadastroUnidades.ADD_ROW_TBL_VND.Enabled = True
    CadastroUnidades.EDIT_ROW_TBL_VND.Enabled = True
    CadastroUnidades.COPY_ROW_TBL_VND.Enabled = True
    CadastroUnidades.DEL_ROW_TBL_VND.Enabled = True
End Sub

Private Sub cancel_lcto_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ADD_TI.Caption = ""
    CB_PEP.Value = ""
    CB_FASE_TI.Value = ""
    CB_TIPO_LCTO_TI.Value = ""
    TB_Parcelas_TI.Value = ""
    CB_PERIODICIDADE_TI.Value = ""
    CB_MESES_TI.Value = ""
    CB_EVENTO_TI.Value = ""
    CB_VALOR_TI.Value = ""
    TB_comment.Value = ""
    CB_VALOR_PARCELA_TI.Value = ""
    L_Fator_TI.Caption = "Valor"
    LV_Lançamentos_TI.Height = 396
    LV_Lançamentos_TI.Top = 30
    LV_Curva_LCTO.Top = 30
    LV_Curva_LCTO.Height = 396
    Label647.Visible = False
    INST_CURVA_LCTO.Visible = False
    LV_Curva_LCTO.ListItems.Clear
    LV_Curva_LCTO.BackColor = &H80000004
    LV_Curva_LCTO.LabelEdit = lvwManual
    LV_Lançamentos_TI.Enabled = True

End Sub
Private Sub CB_Curva_Click()
    'SelecionarCurvaObra.Show
End Sub


Private Sub CB_Curva_DropButtonClick()
    SelecionarCurvaObra.Show
End Sub

Private Sub CB_DEFLA_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C490").Value = CB_DEFLA.Value
End Sub

Private Sub CB_EVENTO_TI_DropButtonClick()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If ºLooper = 0 Then
        ºLooper = 1
        If CB_FASE_TI.Value <> "" Then
            VINCULO.OK.Caption = "LCTO"
            Call VINCULO.Abrir
            VINCULO.Show
            SendKeys "~"
        Else
            MsgBox "É necessário informar a fase da obra"
        End If
    Else
        ºLooper = 0
    End If
    CB_EVENTO_TI.DropDown
End Sub

Private Sub CB_Fases_Change()
  Call CarregarTotais
End Sub

Private Sub CB_FATOR_1_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºFTR_1 (CB_FATOR_1.Value)
End Sub
Private Sub CB_FATOR_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºFTR_2 (CB_FATOR_2.Value)
End Sub

Private Sub CB_INDEXADO_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºINDEX (CB_INDEXADO.Value)
End Sub

Private Sub CB_Medias_Change()
  Call CarregarTotais
End Sub

Private Sub CB_PEP_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    CB_TIPO_LCTO_TI.Clear
    For ºL = 581 To 680
        If ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºL).Value = CB_PEP.Value Then
            CB_TIPO_LCTO_TI.AddItem ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value
        End If
    Next
End Sub

Private Sub CB_PERIODICIDADE_TI_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If CB_PERIODICIDADE_TI.Value = "Curva de Obra" Then
        If CB_FASE_TI <> "" Then
            ºCURVA = ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & CB_FASE_TI + 209).Value
            If ºCURVA <> "" Then
                CB_EVENTO_TI.Enabled = False
                CB_MESES_TI.Value = 0
                CB_MESES_TI.Enabled = False
                TB_Parcelas_TI.Value = 1
                TB_Parcelas_TI.Enabled = False
            Else
                MsgBox "A Fase selecionada não possui curva de obra cadastrada!!"
                CB_PERIODICIDADE_TI.Value = ""
            End If
        Else
            MsgBox "Seleciona uma Fase de Obra!!"
            CB_PERIODICIDADE_TI.Value = ""
        End If
    ElseIf CB_PERIODICIDADE_TI.Value <> "" Then
        CB_EVENTO_TI.Enabled = True
        CB_MESES_TI.Enabled = True
        TB_Parcelas_TI.Enabled = True
    End If
End Sub
Private Sub BTN_SAVE_VERSION_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    Call Checar_Desembolso_Verbas
    If ºSTATUS_STUD("") <> "APROVADO" Or BTN_APPROVE.Caption = "ok" Or BTN_SAVE_AS_NEWVERSION.Caption = "ok" Then
        LOADING.Visible = True
        Application.Wait (Now + TimeValue(0.0001))
        DoEvents
        CadastroUnidades.MultiPage1.Value = 0
        Call RefreshListViews
        Application.Wait (Now + TimeValue(0.0001))
        Call AttBDTipologias
        Call DescarregarInfosTerreno
        Call SalvarPerfil
        If Criar_Tabela <> "erro" And CurvaRec <> "erro" Then Call gerar_fluxo
        
        ThisWorkbook.Sheets("Capa Viabilidade").Range("AG36").GoalSeek goal:=0, changingcell:=Sheets("BD_CAD_VND").Range("O1")
        ThisWorkbook.Sheets("Capa Viabilidade").Range("AG38").Value = ThisWorkbook.Sheets("Capa Viabilidade").Range("I7").Value * ThisWorkbook.Sheets("BD_CAD_VND").Range("O1").Value
        ThisWorkbook.Sheets("BD_CAD_VND").Range("O1").Value = 1
        Application.Calculate
        ThisWorkbook.Sheets("Capa Viabilidade").Range("AG36").GoalSeek goal:=0.165, changingcell:=Sheets("BD_CAD_VND").Range("O1")
        ThisWorkbook.Sheets("Capa Viabilidade").Range("AG39").Value = ThisWorkbook.Sheets("Capa Viabilidade").Range("I7").Value * ThisWorkbook.Sheets("BD_CAD_VND").Range("O1").Value
            
        ThisWorkbook.Sheets("BD_CAD_VND").Range("Q1").Value = 1
        ThisWorkbook.Sheets("BD_CAD_VND").Range("O1").Value = 1
        DoEvents
        Calculate
        
        CALCULAR_INFO_CAPA
        Application.Calculate
        Call Carregar_Prmt_Terreno
        LOADING.Visible = False
        Me.Show
        CARREGAR_CAPA
        Call SALVAR
        CarregarBuffer
    Else
        MsgBox ("Esse estudo ja esta aprovado, use o salvar como para criar uma nova versão.")
    End If
End Sub
Private Sub BTN_SIMULATION_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    Call Checar_Desembolso_Verbas
    LOADING.Visible = True
    Application.Wait (Now + TimeValue(0.0001))
    DoEvents
    CadastroUnidades.MultiPage1.Value = 0
    Call RefreshListViews
    Application.Wait (Now + TimeValue(0.0001))
    Call AttBDTipologias
    Call DescarregarInfosTerreno
    Call SalvarPerfil
    If Criar_Tabela <> "erro" And CurvaRec <> "erro" Then Call gerar_fluxo
    
    ThisWorkbook.Sheets("Capa Viabilidade").Range("AG36").GoalSeek goal:=0, changingcell:=Sheets("BD_CAD_VND").Range("O1")
    ThisWorkbook.Sheets("Capa Viabilidade").Range("AG38").Value = ThisWorkbook.Sheets("Capa Viabilidade").Range("I7").Value * ThisWorkbook.Sheets("BD_CAD_VND").Range("O1").Value
    If ThisWorkbook.Sheets("Capa Viabilidade").Range("AG38").Value > 0 Then
        ThisWorkbook.Sheets("Capa Viabilidade").Range("AG36").GoalSeek goal:=0.165, changingcell:=Sheets("BD_CAD_VND").Range("O1")
        ThisWorkbook.Sheets("Capa Viabilidade").Range("AG39").Value = ThisWorkbook.Sheets("Capa Viabilidade").Range("I7").Value * ThisWorkbook.Sheets("BD_CAD_VND").Range("O1").Value
    Else
        ThisWorkbook.Sheets("Capa Viabilidade").Range("AG38").Value = 0
        ThisWorkbook.Sheets("Capa Viabilidade").Range("AG39").Value = 0
    End If
  
    ThisWorkbook.Sheets("BD_CAD_VND").Range("Q1").Value = 1
    ThisWorkbook.Sheets("BD_CAD_VND").Range("O1").Value = 1
    DoEvents
    Calculate
    
    CALCULAR_INFO_CAPA
    Application.Calculate
    Call Carregar_Prmt_Terreno
    LOADING.Visible = False
    Me.Show
    CARREGAR_CAPA
End Sub
Private Sub CommandButton13_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C898").Value = Me.OBSERVAÇÕES.Value
End Sub

Private Sub CB_VALOR_PARCELA_TI_AfterUpdate()
    If Application.IfError(Application.Search("%", L_Fator_TI.Caption), 0) > 0 Then
        Call FormatarNum("CadastroUnidades", "CB_VALOR_PARCELA_TI", 3)
        If CB_VALOR_PARCELA_TI.Value = "" Then CB_VALOR_PARCELA_TI.Value = 0
        If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
            CB_VALOR_TI.Value = Replace(CB_VALOR_PARCELA_TI.Value, "%", "") * TB_Parcelas_TI.Value
            Call FormatarNum("CadastroUnidades", "CB_VALOR_TI", 3)
        End If
    Else
        Call FormatarNumCur("CadastroUnidades", "CB_VALOR_PARCELA_TI", 2)
        If CB_VALOR_PARCELA_TI.Value = "" Then CB_VALOR_PARCELA_TI.Value = 0
        If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
            CB_VALOR_TI.Value = CB_VALOR_PARCELA_TI.Value * TB_Parcelas_TI.Value
            Call FormatarNumCur("CadastroUnidades", "CB_VALOR_TI", 2)
        End If
    End If
End Sub

Private Sub CommandButton14_Click()
'VERIFICAÇÃO DE ERRO
On Error GoTo chamarform
chamarform:
If ErroMsg(Err) Then Exit Sub

For ºI = 1 To 30
    If Me.Controls("CB_Tipologia_" & ºI).Value = False Then
        Controls("CB_Tipologia_" & ºI).Value = True
        Exit For
    End If
Next
End Sub

Private Sub CommandButton15_Click()
'VERIFICAÇÃO DE ERRO
On Error GoTo chamarform
chamarform:
If ErroMsg(Err) Then Exit Sub

ºTop = (Round(Selecionado.Top, 0) / 18) + 1
If ºTop = 30 Then
     Me.Controls("CB_Tipologia_" & ºI).Value = False
Else
    For ºI = ºTop To 29
        If Me.Controls("CB_Tipologia_" & ºI + 1).Value Then
            Controls("LB_Fase_Tipologia_" & ºI).Value = Controls("LB_Fase_Tipologia_" & ºI + 1).Value
            Controls("TB_Descricao_Tipologia_" & ºI).Value = Controls("TB_Descricao_Tipologia_" & ºI + 1).Value
            Controls("TB_Und_Tipologia_" & ºI).Value = Controls("TB_Und_Tipologia_" & ºI + 1).Value
            Controls("TB_Permt_Tipologia_" & ºI).Value = Controls("TB_Permt_Tipologia_" & ºI + 1).Value
            Controls("TB_M²_Tipologia_" & ºI).Value = Controls("TB_M²_Tipologia_" & ºI + 1).Value
            Controls("TB_ValorM²_Tipologia_" & ºI).Value = Controls("TB_ValorM²_Tipologia_" & ºI + 1).Value
            Controls("TB_M²_D_Tipologia_" & ºI).Value = Controls("TB_M²_D_Tipologia_" & ºI + 1).Value
            Controls("TB_Fator_Tipologia_" & ºI).Value = Controls("TB_Fator_Tipologia_" & ºI + 1).Value
            Controls("TB_VGV_Tipologia_" & ºI).Value = Controls("TB_VGV_Tipologia_" & ºI + 1).Value
            Controls("TB_Vagas_Tipologia_" & ºI).Value = Controls("TB_Vagas_Tipologia_" & ºI + 1).Value
        Else
            Me.Controls("CB_Tipologia_" & ºI).Value = False
        End If
    Next
End If
Selecionado.Top = 0
End Sub

Private Sub CommandButton16_Click()
'VERIFICAÇÃO DE ERRO
On Error GoTo chamarform
chamarform:
If ErroMsg(Err) Then Exit Sub

For ºI = 10 To 1 Step -1
    If Me.Controls("CB_Vaga_" & ºI).Value Then
        Controls("CB_Vaga_" & ºI).Value = False
        Exit For
    End If
Next
End Sub

Private Sub CommandButton17_Click()
'VERIFICAÇÃO DE ERRO
On Error GoTo chamarform
chamarform:
If ErroMsg(Err) Then Exit Sub

For ºI = 1 To 10
    If Me.Controls("CB_Vaga_" & ºI).Value = False Then
        Controls("CB_Vaga_" & ºI).Value = True
        Exit For
    End If
Next
End Sub

Private Sub CommandButton23_Click()
    Show SelecionarCurvaObra
End Sub

Private Sub DEL_CURVA_LCTO_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
        
    LV_Curva_LCTO.ListItems.Clear
    DEL_CURVA_LCTO.Enabled = False
    TB_Parcelas_TI.Enabled = True
    TB_Parcelas_TI.Value = ""
    CB_PERIODICIDADE_TI.Enabled = True
End Sub

Private Sub DEL_ROW_CRV_VND_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If Me.LIST_Velocidade.ListItems.Count > 0 Then
        If MsgBox("Confirma remoção do percentual?", vbYesNo) = vbYes Then
            Me.LIST_Velocidade.ListItems.Remove (Me.LIST_Velocidade.SelectedItem.Index)
            ºLVel = Application.Match(CDbl(Me.LIST_Perfil_Venda.SelectedItem.SubItems(2)), ThisWorkbook.Sheets("BD_CAD_VND").Range("B57:B105"), 0) + 56
            ThisWorkbook.Sheets("BD_CAD_VND").Range(ºLVel & ":" & ºLVel).Value = ""
            ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLVel).Value = Me.LIST_Perfil_Venda.SelectedItem.SubItems(2)
            For Each ºLi In Me.LIST_Velocidade.ListItems
                ºC = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, Columns.Count).End(xlToLeft).Column + 1
                 ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, ºC).Value = ºLi 'Replace(ºLi, ",", ".")
                 ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, ºC + 2).Value = ºLi.SubItems(1)
                 ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, ºC + 1).Value = ºLi.SubItems(2)
            Next
            Call ATT_Percentual_vel
        End If
    End If
End Sub

Private Sub DEL_ROW_TBL_VND_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    If Me.List_Tabela.SelectedItem <> "" Then
        If MsgBox("Confirma a Exclusão? ", vbYesNo, "") = vbYes Then
            Parcela = Me.List_Tabela.SelectedItem.Index
            Me.List_Tabela.ListItems.Remove (Me.List_Tabela.SelectedItem.Index)
            Call OrganizarParcelas
            Call Atulizar_Tbl_BD
            Call CheckPercent
        End If
    End If
End Sub
Private Sub ADD_ROW_TBL_VND_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    Add.Caption = "Adicionar"
    List_Tabela.Top = 306
    List_Tabela.Height = 90
    CadastroUnidades.ADD_ROW_TBL_VND.Enabled = False
    CadastroUnidades.EDIT_ROW_TBL_VND.Enabled = False
    CadastroUnidades.COPY_ROW_TBL_VND.Enabled = False
    CadastroUnidades.DEL_ROW_TBL_VND.Enabled = False
End Sub
Private Sub copy_ROW_TBL_VND_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    If Me.List_Tabela.ListItems.Count > 0 And Me.List_Tabela.SelectedItem <> "" Then
        List_Tabela.Enabled = False
        Call LiberarCampos
        List_Tabela.Top = 306
        List_Tabela.Height = 84
        Parcela = Me.List_Tabela.SelectedItem.Index
        
        ºEdição(1) = 1
        ºEdição(2) = Parcela
        
        CB_TP_PARCELA.Value = ""
        '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
        Me.TB_Quantidade.Value = ""
        '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
        Me.TB_Inicio.Value = ""
        '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
        Me.TB_Percent_VGV.Text = ""
        '---------------------------------------------------------  JUROS  -------------------------------------------------------------------------------------------------------------------------------
        Me.CB_Cobrar_Juros.Value = ""
        '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
        TB_Inicio_Juros.Value = ""
        '---------------------------------------------------------  FIXAR INICIO  ----------------------------------------------------------------------------------------------------------------------
        Me.CB_FX_INICIO.Value = ""
        '---------------------------------------------------------  FIXAR FIM  --------------------------------------------------------------------------------------------------------------------------
        Me.CB_FX_FIM.Value = ""
        '---------------------------------------------------------  MES FIM  ------------------------------------------------------------------------------------------------------------------------------
        Me.TB_Ultimo.Value = ""
    
        '---------------------------------------------------------  TIPO  ---------------------------------------------------------------------------------------------------------------------------------
        Set Li = CadastroUnidades.List_Tabela.ListItems(Parcela)
        CB_TP_PARCELA.Value = Li
        '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
        Me.TB_Quantidade.Value = Li.SubItems(1)
        '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
        Me.TB_Inicio.Value = Li.SubItems(2)
        '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
        Me.TB_Percent_VGV.Text = Li.SubItems(3)
        '---------------------------------------------------------  JUROS  -------------------------------------------------------------------------------------------------------------------------------
        Me.CB_Cobrar_Juros.Value = Li.SubItems(4)
        '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
        TB_Inicio_Juros.Value = Li.SubItems(5)
        '---------------------------------------------------------  FIXAR INICIO  ----------------------------------------------------------------------------------------------------------------------
        Me.CB_FX_INICIO.Value = Li.SubItems(6)
        '---------------------------------------------------------  FIXAR FIM  --------------------------------------------------------------------------------------------------------------------------
        Me.CB_FX_FIM.Value = Li.SubItems(7)
        '---------------------------------------------------------  MES FIM  ------------------------------------------------------------------------------------------------------------------------------
        Me.TB_Ultimo.Value = Li.SubItems(8)
        '-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        Add.Caption = "Adicionar"
        CadastroUnidades.ADD_ROW_TBL_VND.Enabled = False
        CadastroUnidades.EDIT_ROW_TBL_VND.Enabled = False
        CadastroUnidades.COPY_ROW_TBL_VND.Enabled = False
        CadastroUnidades.DEL_ROW_TBL_VND.Enabled = False
    End If
End Sub

Private Sub EDIT_ROW_CRV_VND_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    TB_Percentual_1.Enabled = True
    TB_DURACAO_1.Enabled = True
    LIST_Velocidade.Enabled = False
    TB_BGN_1.Enabled = True
    BT_Save_Velocidade.Enabled = True
    BT_cancel_Velocidade.Enabled = True
    ADD_ROW_CRV_VND.Enabled = False
    DEL_ROW_CRV_VND.Enabled = False
    LIST_Velocidade.Top = 60
    LIST_Velocidade.Height = 90
    If Me.LIST_Velocidade.ListItems.Count > 0 Then
        BT_Save_Velocidade.HelpContextID = Application.Match(CDbl(Me.LIST_Perfil_Venda.SelectedItem.SubItems(2)), ThisWorkbook.Sheets("BD_CAD_VND").Range("B57:B105"), 0) + 56
        TB_Percentual_1 = Me.LIST_Velocidade.SelectedItem
        TB_DURACAO_1 = Me.LIST_Velocidade.SelectedItem.SubItems(1)
        TB_BGN_1 = Me.LIST_Velocidade.SelectedItem.SubItems(2)
    End If
End Sub

Private Sub EDIT_ROW_TBL_VND_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Dim Parcela As Integer
    Dim Li As Object
    
    If Me.List_Tabela.ListItems.Count > 0 And Me.List_Tabela.SelectedItem <> "" Then
        List_Tabela.Enabled = False
        Call LiberarCampos
        List_Tabela.Top = 306
        List_Tabela.Height = 84
        Parcela = Me.List_Tabela.SelectedItem.Index
        
        ºEdição(1) = 1
        ºEdição(2) = Parcela
        
        CB_TP_PARCELA.Value = ""
        '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
        Me.TB_Quantidade.Value = ""
        '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
        Me.TB_Inicio.Value = ""
        '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
        Me.TB_Percent_VGV.Text = ""
        '---------------------------------------------------------  JUROS  -------------------------------------------------------------------------------------------------------------------------------
        Me.CB_Cobrar_Juros.Value = ""
        '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
        TB_Inicio_Juros.Value = ""
        '---------------------------------------------------------  FIXAR INICIO  ----------------------------------------------------------------------------------------------------------------------
        Me.CB_FX_INICIO.Value = ""
        '---------------------------------------------------------  FIXAR FIM  --------------------------------------------------------------------------------------------------------------------------
        Me.CB_FX_FIM.Value = ""
        '---------------------------------------------------------  MES FIM  ------------------------------------------------------------------------------------------------------------------------------
        Me.TB_Ultimo.Value = ""
    
        '---------------------------------------------------------  TIPO  ---------------------------------------------------------------------------------------------------------------------------------
        Set Li = CadastroUnidades.List_Tabela.ListItems(Parcela)
        CB_TP_PARCELA.Value = Li
        '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
        Me.TB_Quantidade.Value = Li.SubItems(1)
        '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
        Me.TB_Inicio.Value = Li.SubItems(2)
        '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
        Me.TB_Percent_VGV.Text = Li.SubItems(3)
        '---------------------------------------------------------  JUROS  -------------------------------------------------------------------------------------------------------------------------------
        Me.CB_Cobrar_Juros.Value = Li.SubItems(4)
        '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
        TB_Inicio_Juros.Value = Li.SubItems(5)
        '---------------------------------------------------------  FIXAR INICIO  ----------------------------------------------------------------------------------------------------------------------
        Me.CB_FX_INICIO.Value = Li.SubItems(6)
        '---------------------------------------------------------  FIXAR FIM  --------------------------------------------------------------------------------------------------------------------------
        Me.CB_FX_FIM.Value = Li.SubItems(7)
        '---------------------------------------------------------  MES FIM  ------------------------------------------------------------------------------------------------------------------------------
        Me.TB_Ultimo.Value = Li.SubItems(8)
        '-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        
        Add.Caption = "Editar"
        CadastroUnidades.ADD_ROW_TBL_VND.Enabled = False
        CadastroUnidades.EDIT_ROW_TBL_VND.Enabled = False
        CadastroUnidades.COPY_ROW_TBL_VND.Enabled = False
        CadastroUnidades.DEL_ROW_TBL_VND.Enabled = False
    End If
End Sub
Private Sub Custo_Obra_Pvt_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    Application.EnableEvents = False
    If Custo_Obra_Pvt.Value = "Custo do m² Pvt. C/ Taxas" Then
        Label246.Caption = "Custo do m² Pvt. S/ Taxas"
        If TB_CUSTO_TOTAL2.Value <> "" Then
            TB_CUSTO_P_TAXAS.Value = CDbl(TB_CUSTO_TOTAL2.Value) / CDbl(TB_Area_Total_PVT)
            Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_P_TAXAS", 2)
            TB_Custo_Metro.Value = CDbl(TB_TT_S_TX.Value) / CDbl(TB_Area_Total_PVT)
            Call FormatarNumCur("CadastroUnidades", "TB_Custo_Metro", 2)
        End If
    Else
        Label246.Caption = "Custo do m² Pvt. C/ Taxas"
        If TB_CUSTO_TOTAL2.Value <> "" Then
            TB_CUSTO_P_TAXAS.Value = CDbl(TB_TT_S_TX.Value) / CDbl(TB_Area_Total_PVT)
            Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_P_TAXAS", 2)
            TB_Custo_Metro.Value = CDbl(TB_CUSTO_TOTAL2.Value) / CDbl(TB_Area_Total_PVT)
            Call FormatarNumCur("CadastroUnidades", "TB_Custo_Metro", 2)
        End If
    End If
    Application.EnableEvents = True
End Sub

Private Sub editar_lcto_Click()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
   
    If LV_Lançamentos_TI.ListItems.Count > 0 Then
        If LV_Lançamentos_TI.SelectedItem <> "" Then
            LV_Lançamentos_TI.Enabled = False
            Dim ºLi As Object
            Dim LÇTO As Double
            Dim ºPEP As String
            LÇTO = LV_Lançamentos_TI.SelectedItem.Index
            Set ºLi = LV_Lançamentos_TI.ListItems(LÇTO)
            CB_FASE_TI.Value = ºLi
            
            'PEP RELACIONADO
            CadastroUnidades.CB_PEP.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "PEP RELACIONADO") - 1)
            'TIPO DE LANÇAMENTO
            CB_TIPO_LCTO_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "TIPO DE LANÇAMENTO") - 1)
            'PARCELAS
            TB_Parcelas_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "PARCELAS") - 1)
            'PERIODICIDADE
            CB_PERIODICIDADE_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "PERIODICIDADE") - 1)
            'MES DE INICIO
            CB_MESES_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "MES DE INICIO") - 1)
            'EVENTO VINCULADO
            CB_EVENTO_TI.Clear
            If ºLi.SubItems(8) <> "" Then
                CB_EVENTO_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "EVENTO VINCULADO") - 1)
                CB_EVENTO_TI.AddItem ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "EVENTO VINCULADO") - 1)
                CB_MESES_TI.Enabled = False
            Else
                CB_EVENTO_TI.Value = ""
            End If
            'VALOR DO LANÇAMENTO
            CB_VALOR_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR DO LANÇAMENTO") - 1)
            If Application.IfError(Application.Search("%", L_Fator_TI.Caption), 0) > 0 Then
                If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
                    CB_VALOR_PARCELA_TI.Value = Replace(CB_VALOR_TI.Value, "%", "") / TB_Parcelas_TI.Value
                    Call FormatarNum("CadastroUnidades", "CB_VALOR_PARCELA_TI", 3)
                End If
            Else
                If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
                    CB_VALOR_PARCELA_TI.Value = CB_VALOR_TI.Value / TB_Parcelas_TI.Value
                    Call FormatarNumCur("CadastroUnidades", "CB_VALOR_PARCELA_TI", 2)
                End If
            End If
            'DESCRIÇÃO
            TB_comment.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "DESCRIÇÃO") - 1)
            'OBSERVAÇÃO
            Obs_lcto.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "OBSERVAÇÕES") - 1)
            
            LV_Curva_LCTO.ColumnHeaders.Clear
            LV_Curva_LCTO.ListItems.Clear
            LV_Curva_LCTO.BackColor = &H80000005
            LV_Curva_LCTO.LabelEdit = lvwAutomatic
            Call Carregar_Curva_Lcto(LÇTO)
            LV_Lançamentos_TI.ListItems(LÇTO).Selected = True
            ADD_TI.Caption = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "COD") - 1)
            LV_Lançamentos_TI.Height = 390
            LV_Lançamentos_TI.Top = 108
            LV_Curva_LCTO.Top = 108
            LV_Curva_LCTO.Height = 360
            Label647.Visible = True
            INST_CURVA_LCTO.Visible = True
        End If
    End If
End Sub

Private Sub copiar_lcto_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If LV_Lançamentos_TI.ListItems.Count > 0 Then
    If LV_Lançamentos_TI.SelectedItem <> "" Then
        LV_Lançamentos_TI.Enabled = False
        Dim ºLi As Object
        Dim LÇTO As Double
        Dim ºPEP As String
        LÇTO = LV_Lançamentos_TI.SelectedItem.Index
        Set ºLi = LV_Lançamentos_TI.ListItems(LÇTO)
        CB_FASE_TI.Value = ºLi
        
        'PEP RELACIONADO
        CadastroUnidades.CB_PEP.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "PEP RELACIONADO") - 1)
        'TIPO DE LANÇAMENTO
        CB_TIPO_LCTO_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "TIPO DE LANÇAMENTO") - 1)
        'PARCELAS
        TB_Parcelas_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "PARCELAS") - 1)
        'PERIODICIDADE
        CB_PERIODICIDADE_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "PERIODICIDADE") - 1)
        'MES DE INICIO
        CB_MESES_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "MES DE INICIO") - 1)
        'EVENTO VINCULADO
        CB_EVENTO_TI.Clear
        If ºLi.SubItems(8) <> "" Then
            CB_EVENTO_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "EVENTO VINCULADO") - 1)
            CB_EVENTO_TI.AddItem ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "EVENTO VINCULADO") - 1)
            CB_MESES_TI.Enabled = False
        Else
            CB_EVENTO_TI.Value = ""
        End If
        'VALOR DO LANÇAMENTO
        CB_VALOR_TI.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "VALOR DO LANÇAMENTO") - 1)
        If Application.IfError(Application.Search("%", L_Fator_TI.Caption), 0) > 0 Then
            If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
                CB_VALOR_PARCELA_TI.Value = Replace(CB_VALOR_TI.Value, "%", "") / TB_Parcelas_TI.Value
                Call FormatarNum("CadastroUnidades", "CB_VALOR_PARCELA_TI", 3)
            End If
        Else
            If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
                CB_VALOR_PARCELA_TI.Value = CB_VALOR_TI.Value / TB_Parcelas_TI.Value
                Call FormatarNumCur("CadastroUnidades", "CB_VALOR_PARCELA_TI", 2)
            End If
        End If
        'DESCRIÇÃO
        TB_comment.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "DESCRIÇÃO") - 1)
        'OBSERVAÇÃO
        Obs_lcto.Value = ºLi.SubItems(LOC_COLUNA("CadastroUnidades", "LV_Lançamentos_TI", "OBSERVAÇÕES") - 1)
        
        LV_Curva_LCTO.ColumnHeaders.Clear
        LV_Curva_LCTO.ListItems.Clear
        LV_Curva_LCTO.BackColor = &H80000005
        LV_Curva_LCTO.LabelEdit = lvwAutomatic
        Call Carregar_Curva_Lcto(LÇTO)
        LV_Lançamentos_TI.ListItems(LÇTO).Selected = True
        ADD_TI.Caption = "Adicionar"
        LV_Lançamentos_TI.Height = 390
        LV_Lançamentos_TI.Top = 108
        LV_Curva_LCTO.Top = 108
        LV_Curva_LCTO.Height = 360
        Label647.Visible = True
        INST_CURVA_LCTO.Visible = True
    End If
    End If

End Sub

Private Sub expt_estudo_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call Exportar
End Sub

Private Sub Gerar_Relatórios_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ' Delete any existing popup menu.
    Call DeletePopUpMenu

    ' Create the popup menu.
    Call Custom_PopUpMenu_1

    ' Display the popup menu.
    On Error Resume Next
    Application.CommandBars(Mname).ShowPopup
    On Error GoTo 0

End Sub
Private Sub List_Tabela_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As stdole.OLE_XPOS_PIXELS, ByVal Y As stdole.OLE_YPOS_PIXELS)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If Button = 2 And List_Tabela.ListItems.Count > 0 Then
        List_Tabela.Enabled = False
        Dim CH As ColumnHeader
        Dim prevch As ColumnHeader
        Set prevch = List_Tabela.ColumnHeaders(1)
        For Each CH In List_Tabela.ColumnHeaders
            If (CH.Left < (X * List_Tabela.Width / 770)) Then
                Set prevch = CH
            Else
                Exit For
            End If
        Next
        LIST_Velocidade.SortKey = 2
        LIST_Velocidade.SortOrder = lvwAscending
        If prevch.Index = 3 Then
            If LIST_Velocidade.ListItems.Count > 0 Then ºIni = LIST_Velocidade.ListItems(1).SubItems(1) Else ºIni = 0
            If List_Tabela.ListItems(List_Tabela.SelectedItem.Index).SubItems(6) = "Sim" Then
                For ºFASE = 210 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(259, 2).End(xlUp).Row
                    ºmeses = DIF_DT_LCTO(List_Tabela.ListItems(List_Tabela.SelectedItem.Index).SubItems(prevch.Index - 1), ºFASE - 209)
                    ºTexto = ºTexto & "Fase " & ºFASE - 209 & " | " & ºmeses & "  -  " & Format(Application.EDate(DateValue(ºDATA_BASE("")), ºmeses + 1), "mm/yyyy") & Chr(10)
                Next
            Else
                For ºFASE = 210 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(259, 2).End(xlUp).Row
                    ºmeses = CDbl(ºIni) + DIF_DT_LCTO(List_Tabela.ListItems(List_Tabela.SelectedItem.Index).SubItems(prevch.Index - 1), ºFASE - 209)
                    ºTexto = ºTexto & "Fase " & ºFASE - 209 & " | " & ºmeses & "  -  " & Format(Application.EDate(DateValue(ºDATA_BASE("")), ºmeses + 1), "mm/yyyy") & Chr(10)
                Next
            End If
            MsgBox ºTexto, , "Mês do Fluxo"
        ElseIf prevch.Index = 6 Or prevch.Index = 9 Then
            If ThisWorkbook.Sheets("BD_CAD_VND").Cells(259, 2).End(xlUp).Row > 209 Then
                For ºFASE = 210 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(259, 2).End(xlUp).Row
                    ºmeses = DIF_DT_LCTO(List_Tabela.ListItems(List_Tabela.SelectedItem.Index).SubItems(prevch.Index - 1), ºFASE - 209)
                    ºTexto = ºTexto & "Fase " & ºFASE - 209 & " | " & ºmeses & "  -  " & Format(Application.EDate(DateValue(ºDATA_BASE("")), ºmeses + 1), "mm/yyyy") & Chr(10)
                Next
                MsgBox ºTexto, , "Mês do Fluxo"
            Else
                ºmeses = 0
                ºTexto = Format(Application.EDate(DateValue(ºDATA_BASE("")), ºmeses + 1), "mm/yyyy")
                MsgBox ºmeses & "  -  " & ºTexto, , "Mês do Fluxo"
            End If
        End If
    End If
End Sub

Private Sub List_Tipologias_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If CadastroUnidades.LIST_Perfil_Venda.ListItems.Count > 0 Then
        ºperfil = Me.LIST_Perfil_Venda.SelectedItem
        ºiTENS = Me.List_Tipologias.ListCount - 1
        For ºI = 0 To ºiTENS
            ºItem = Me.List_Tipologias.List(ºI)
            If CDbl(ºItem) < 35 Then
                If ThisWorkbook.Sheets("BD_CAD_VND").Range("N" & ºItem).Value = "" Or ThisWorkbook.Sheets("BD_CAD_VND").Range("N" & ºItem).Value = CDbl(ºperfil) Then
                    If Me.List_Tipologias.Selected(ºI) Then ThisWorkbook.Sheets("BD_CAD_VND").Range("N" & ºItem).Value = CDbl(ºperfil) Else ThisWorkbook.Sheets("BD_CAD_VND").Range("N" & ºItem).Value = ""
                ElseIf Me.List_Tipologias.Selected(ºI) Then
                    If MsgBox("ESTA TIPOLOGIA ESTA VINCULADA A OUTRO PERFIL, DESEJA PROSSEGUIR?", vbYesNo) = vbYes Then
                        ThisWorkbook.Sheets("BD_CAD_VND").Range("N" & ºItem).Value = CDbl(ºperfil)
                    Else
                         Me.List_Tipologias.Selected(ºI) = False
                    End If
                End If
            Else
                If ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºItem).Value = "" Or ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºItem).Value = CDbl(ºperfil) Then
                    If Me.List_Tipologias.Selected(ºI) Then ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºItem).Value = CDbl(ºperfil) Else ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºItem).Value = ""
                ElseIf Me.List_Tipologias.Selected(ºI) Then
                    If MsgBox("ESTA TIPOLOGIA ESTA VINCULADA A OUTRO PERFIL, DESEJA PROSSEGUIR?", vbYesNo) = vbYes Then
                        ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºItem).Value = CDbl(ºperfil)
                    Else
                         Me.List_Tipologias.Selected(ºI) = False
                    End If
                End If
            End If
        Next
    End If
End Sub
Private Sub LV_Curva_LCTO_AfterLabelEdit(Cancel As Integer, newString As String)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    If newString = "" Then newString = 0
    newString = TesteValor(newString)
    If Len(Replace(newString, "%", "")) > Len(newString) Then
        newString = Format(CDbl(Replace(newString, "%", "")) / 100, "0.00000%")
        LV_Curva_LCTO.ListItems.Item(LV_Curva_LCTO.SelectedItem.Index) = newString
    Else
        newString = Format(CDbl(newString) / 100, "0.00000%")
        LV_Curva_LCTO.ListItems.Item(LV_Curva_LCTO.SelectedItem.Index) = newString
    End If
End Sub


Private Sub LV_Lançamentos_TI_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If Me.ADD_TI.Caption = "" Then
        Call Carregar_Curva_Lcto(LV_Lançamentos_TI.SelectedItem.Index)
    End If
End Sub

Private Sub LV_Lançamentos_TI_DblClick()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call editar_lcto_Click
End Sub

Private Sub MP_TBL_VND_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If LIST_Perfil_Venda.ListItems.Count > 0 Then
        If Me.MP_TBL_VND.Value = 0 Then
            Me.tb_ini_pos.Visible = False
            Me.Label680.Visible = False
            ºCod = LIST_Perfil_Venda.SelectedItem
            ºL = Application.IfError(Application.Match(CDbl(ºCod), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
            CB_Select_Tbl.Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & ºL + 900).Value
        Else
            Me.tb_ini_pos.Visible = True
            Me.Label680.Visible = True
            ºCod = LIST_Perfil_Venda.SelectedItem
            ºL = Application.IfError(Application.Match(CDbl(ºCod), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
            CB_Select_Tbl.Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("E" & ºL + 900).Value
        End If
    End If
End Sub

Private Sub Mudar_Curva_Obra_Click()
    SelecionarCurvaObra.Show
End Sub



Private Sub ºCB_permuta_fin_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If ºCB_permuta_fin = "% de Permuta Fin. / VGV" Then
        Label310.Caption = "% de Permuta Fin"
        Label617.Caption = "Permuta Financeira"
    Else
        Label310.Caption = "% Fundo Permuta/Parceria"
        Label617.Caption = "Fundo Permuta/Parceria"
    End If
End Sub

Private Sub PEP_FILTRO_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Me.LV_Lançamentos_TI.ListItems.Clear
    Me.LV_Lançamentos_TI.ColumnHeaders.Clear
    Carregar_LV_TI
End Sub

Private Sub prf_associativo_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If ºSenha = "" Then
        If LIST_Perfil_Venda.ListItems.Count > 0 Then
            ºCod = LIST_Perfil_Venda.SelectedItem
            ºL = Application.IfError(Application.Match(CDbl(ºCod), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Range("G" & ºL + 900).Value = prf_associativo.Value
            Call Carregar_PRF_VND(CInt(ºL))
        Else
            Call Carregar_PRF_VND(0)
        End If
    End If
End Sub


Private Sub remover_lcto_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If LV_Lançamentos_TI.SelectedItem <> "" Then
        If MsgBox("Confirma a Exclusão? ", vbYesNo, "") = vbYes Then
            ºLançamento = LV_Lançamentos_TI.SelectedItem.Index
            ThisWorkbook.Sheets("Lançamentos").Rows(LV_Lançamentos_TI.SelectedItem.SubItems(12)).ClearContents
            LV_Lançamentos_TI.ListItems.Remove (LV_Lançamentos_TI.SelectedItem.Index)
            Me.LV_Lançamentos_TI.ListItems.Clear
            Me.LV_Lançamentos_TI.ColumnHeaders.Clear
            Call Carregar_LV_TI
        End If
    End If
End Sub

Private Sub adicionar_lcto_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Dim ºL As Double
    LV_Lançamentos_TI.Enabled = False
    CB_FASE_TI.Enabled = True
    CB_FASE_TI.Value = ""
    CB_TIPO_LCTO_TI.Enabled = True
    CB_TIPO_LCTO_TI.Value = ""
    TB_Parcelas_TI.Enabled = True
    TB_Parcelas_TI.Value = ""
    CB_PERIODICIDADE_TI.Enabled = True
    CB_PERIODICIDADE_TI.Value = ""
    CB_EVENTO_TI.Enabled = True
    CB_EVENTO_TI.Value = ""
    CB_MESES_TI.Enabled = True
    CB_MESES_TI.Value = ""
    CB_VALOR_TI.Enabled = True
    CB_VALOR_TI.Value = ""
    TB_comment.Enabled = True
    TB_comment.Value = ""
    CB_EVENTO_TI.Enabled = True
    CB_EVENTO_TI.Value = ""
    INST_CURVA_LCTO.Enabled = True
    ADD_TI.Enabled = True
    LV_Curva_LCTO.ColumnHeaders.Clear
    LV_Curva_LCTO.ListItems.Clear
    LV_Curva_LCTO.BackColor = &H80000005
    LV_Curva_LCTO.LabelEdit = lvwAutomatic
    ADD_TI.Caption = "Adicionar"
    LV_Lançamentos_TI.Height = 390
    LV_Lançamentos_TI.Top = 108
    LV_Curva_LCTO.Top = 108
    LV_Curva_LCTO.Height = 360
    
    Label647.Visible = True
    INST_CURVA_LCTO.Visible = True
End Sub

Private Sub BTN_UNDO_click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    Dim D_SHT, F_SHT As Worksheet
    Dim ºL, ºC, ºLinhas, ºLinhasCriadas, ºLTBL, ºLTBL_2 As Double
    Set D_SHT = ThisWorkbook.Sheets("BD_CAD_VND")
    Set F_SHT = ThisWorkbook.Sheets("BUFFER")
            
    '----------------------------------------------------------------------------------------
    '                                   Nome
    '----------------------------------------------------------------------------------------
         
    ºNOME_VERSÃO (F_SHT.Range("B1").Value)
    ºDATA_BASE (F_SHT.Range("C1").Value)
    ºDATA_FASE_1 (F_SHT.Range("E1").Value)
           
    '----------------------------------------------------------------------------------------
    '                                   Tipologias
    '----------------------------------------------------------------------------------------
    D_SHT.Range("A3:N33").Value = F_SHT.Range("A3:N33").Value
            
    '----------------------------------------------------------------------------------------
    '                                   Vagas Extras
    '----------------------------------------------------------------------------------------
    D_SHT.Range("A35:H55").Value = F_SHT.Range("A35:H55").Value
        
    '----------------------------------------------------------------------------------------
    '                                   Curvas de Vendas
    '----------------------------------------------------------------------------------------
    D_SHT.Range("A57:N106").Value = F_SHT.Range("A57:N106").Value
            
    '----------------------------------------------------------------------------------------
    '                                   Tabela de Vendas
    '----------------------------------------------------------------------------------------
    D_SHT.Range("A108:NA157").Value = F_SHT.Range("A108:NA157").Value
            
    '----------------------------------------------------------------------------------------
    '                                   Perfil de Taxas
    '----------------------------------------------------------------------------------------
    D_SHT.Range("A159:T208").NumberFormat = "@"
    D_SHT.Range("A159:T208").Value = F_SHT.Range("A159:T208").Value
            
    '----------------------------------------------------------------------------------------
    '                                   Custo de Obra
    '----------------------------------------------------------------------------------------
    D_SHT.Range("A210:N259").Value = F_SHT.Range("A210:N259").Value
    D_SHT.Range("S210:S259").Value = F_SHT.Range("S210:S259").Value
    For ºL = 210 To F_SHT.Cells(259, 2).End(xlUp).Row
        ' Valor Marjorado
        ºC = Application.Match("Valor Marjorado", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).FormulaR1C1 = "=(((RC[-1]+RC[4])*R1C17)/(SUMPRODUCT(RC[-7]:RC[-5]*1)+1))-RC[4]"
        ' Valor taxa gererncial
        ºC = Application.Match("Valor taxa gererncial", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = "=RC[-1]*RC[-8]"
        ' Valor taxa gererncial
        ºC = Application.Match("Valor taxa efetiva", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = "=RC[-2]*RC[-8]"
        ' Valor Dtas
        ºC = Application.Match("Valor Dtas", ThisWorkbook.Sheets("BD_CAD_VND").Rows(209), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = "=RC[-3]*RC[-8]"
    Next

    '----------------------------------------------------------------------------------------
    '                                   Curva de Obra
    '----------------------------------------------------------------------------------------
    D_SHT.Range("B260:" & Cells(461, F_SHT.Cells(260, Columns.Count).End(xlToLeft).Column + 1).Address).Value = F_SHT.Range("B260:" & Cells(461, F_SHT.Cells(260, Columns.Count).End(xlToLeft).Column + 1).Address).Value
            
    '----------------------------------------------------------------------------------------
    '                                   Terreno
    '----------------------------------------------------------------------------------------
    D_SHT.Range("C462:C479").Value = F_SHT.Range("C462:C479").Value
            
    '----------------------------------------------------------------------------------------
    '                                   Associativo
    '----------------------------------------------------------------------------------------
    D_SHT.Range("B480:C496").Value = F_SHT.Range("B480:C496").Value
            
    '----------------------------------------------------------------------------------------
    '                                   Metragens
    '----------------------------------------------------------------------------------------
    D_SHT.Range("A498:E521").Value = F_SHT.Range("A498:E521").Value
            
    '----------------------------------------------------------------------------------------
    '                                   Tipos de Lançamento
    '----------------------------------------------------------------------------------------
    D_SHT.Range("B581:D880").Value = F_SHT.Range("B581:D880").Value
            
    '----------------------------------------------------------------------------------------
    '                                   Participação Permuta
    '----------------------------------------------------------------------------------------
    D_SHT.Range("C881:C899").Value = F_SHT.Range("C881:C899").Value
    
    '----------------------------------------------------------------------------------------
    '                                   Perfil de Venda
    '----------------------------------------------------------------------------------------
    D_SHT.Range("A901:I950").Value = F_SHT.Range("A901:I950").Value
            
    '----------------------------------------------------------------------------------------
    '                                   Lançamentos
    '----------------------------------------------------------------------------------------
    Set D_SHT = ThisWorkbook.Sheets("Lançamentos")
    D_SHT.Calculate
    ºLinhas = F_SHT.Range("A952:DH" & F_SHT.UsedRange.Rows.Count).Rows.Count
    D_SHT.Range("A2:DH" & ºLinhas).Value = F_SHT.Range("A952:DH" & F_SHT.UsedRange.Rows.Count).Value
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & 498).Value = ""
    
    If Criar_Tabela <> "erro" And CurvaRec <> "erro" Then Call gerar_fluxo
    
    Liberar_Deletar = False
    ºLinhasCriadas = 0
    'Call CarregarVelocidades
    Call LOAD_PEP
    Call CarregarBuffer
        
    LIST_Perfil_Venda_B.ListItems.Clear
    LV_Show_TBL_VND.ListItems.Clear
    LV_Show_Curvas_Velocidade.ListItems.Clear
    LIST_Perfil_Venda.ListItems.Clear
    List_Tabela.ListItems.Clear
    LIST_Velocidade.ListItems.Clear
    LV_FasesObra.ListItems.Clear
    LV_CurvasObra.ListItems.Clear
    LV_Lançamentos_TI.ListItems.Clear
    
    LIST_Perfil_Venda_B.ColumnHeaders.Clear
    LV_Show_TBL_VND.ColumnHeaders.Clear
    LV_Show_Curvas_Velocidade.ColumnHeaders.Clear
    LIST_Perfil_Venda.ColumnHeaders.Clear
    List_Tabela.ColumnHeaders.Clear
    LIST_Velocidade.ColumnHeaders.Clear
    LV_FasesObra.ColumnHeaders.Clear
    LV_CurvasObra.ColumnHeaders.Clear
    LV_Lançamentos_TI.ColumnHeaders.Clear
    
    With CadastroUnidades.List_Tabela
        With .ColumnHeaders
            'adiciona colunas
            .Add , , "Tipo", 55
            .Add , , "Quantidade", 65, lvwColumnCenter
            .Add , , "Inicio", 55, lvwColumnCenter
            .Add , , "% do VGV", 55, lvwColumnCenter
            .Add , , "Cobrar Juros?", 65, lvwColumnCenter
            .Add , , "Inicio Juros", 60, lvwColumnCenter
            .Add , , "Fixar Início", 60, lvwColumnCenter
            .Add , , "Fixar Final", 60, lvwColumnCenter
            .Add , , "Mês de Encerramento", 100, lvwColumnCenter
        End With
        .View = lvwReport
        .FullRowSelect = True
    End With
    
    CadastroUnidades.CB_Select_Tbl.Clear
    ºLTBL = ThisWorkbook.Sheets("BD_CAD_VND").Cells(157, 2).End(xlUp).Row
    For ºLTBL_2 = 108 To ºLTBL
        CadastroUnidades.CB_Select_Tbl.AddItem ºLTBL_2 - 107 & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLTBL_2, 2).Value
    Next
    Call CarregarInfosTerreno
    Call CarregarLB_Fase_Tipologia
    Call AttTipologias
    Call CarregarTotais
    Call ATT_P_cap
    Call CarregarPerfil
    Call CarregarFases
    LV_CurvasObra.ColumnHeaders.Clear
    LV_CurvasObra.ListItems.Clear
    Call CarregarCurvasOB
    Call TotalizarCusto
    Call CarregarInfosTerreno
    Call Carregar_CB_PERIODICIDADE
    Call Carregar_LV_TI
    Call Carregar_CB_FASES
    Call Carregar_PRF_VND(0)
    Call Carregar_Prmt_Terreno
    
    CadastroUnidades.Associativo.Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("B480").Value
    Call CLIQUE_ASS
    If Replace(CadastroUnidades.TB_TX_Permut_Fin, "%", "") > 0 And CadastroUnidades.TB_TX_Permut_Fin <> "" Then
        CadastroUnidades.CalcPermutaFis.Enabled = False
    Else
        CadastroUnidades.CalcPermutaFis.Enabled = True
    End If

    If Replace(CadastroUnidades.TB_Percent_Permuta.Value, "%", "") > 0 And CadastroUnidades.TB_Percent_Permuta <> "" Then
        CadastroUnidades.CalcPermutaFin.Enabled = False
    Else
        CadastroUnidades.CalcPermutaFin.Enabled = True
    End If
    Call CALCULAR_INFO_CAPA
    Call CARREGAR_CAPA
    
    CadastroUnidades.MultiPage1.Value = 0
    Call RefreshListViews
     
    Application.DisplayAlerts = True
End Sub
Private Sub DT_Base_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If Application.IfError(Application.EDate(DT_Base, 0), 0) <> 0 Then
        DT_Base = Format(DT_Base, "mm/yyyy")
        ATT_DATAS.Show
        ºDATA_BASE (DT_Base)
        Call A_CadastroUnidades
        Call BTN_SIMULATION_Click
    Else
        DT_Base.Value = ºDATA_BASE("")
    End If
End Sub
Private Sub DT_Fase_1_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If Application.IfError(Application.EDate(DT_Fase_1, 0), 0) <> 0 Then
        DT_Fase_1 = Format(DT_Fase_1, "mm/yyyy")
        ºDATA_FASE_1 (DT_Fase_1)
    Else
        DT_Fase_1.Value = ºDATA_FASE_1("")
    End If
End Sub


Private Sub LV_Curva_LCTO_KeyPress(KeyAscii As Integer)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If LV_Curva_LCTO.LabelEdit = lvwAutomatic Then
        If KeyAscii = 22 And Me.ADD_TI.Caption <> "" Then
            On Error Resume Next
            Dim DT As New MSForms.DataObject
            Dim ºV As Boolean
            ºV = False
            DT.GetFromClipboard
            a = DT.GetText
            ºU_Linha_O = Len(a) - Len(Replace(a, Chr(10), vbNullString))
            For ºL = 1 To ºU_Linha_O
                B = Application.Search(Chr(10), a)
                C = Left(a, B - 1)
                a = Right(a, Len(a) - B)
                ºTotal = ºTotal + CDbl(Replace(C, "%", ""))
            Next
            a = DT.GetText
            If ºU_Linha_O > 1 Then
                If CadastroUnidades.CB_MESES_TI.Value <> "" Then ºINICIO = CadastroUnidades.CB_MESES_TI.Value Else ºINICIO = 0
                CadastroUnidades.TB_Parcelas_TI = ºU_Linha_O
                CadastroUnidades.TB_Parcelas_TI.Enabled = False
                CadastroUnidades.CB_PERIODICIDADE_TI.Value = "Mensal"
                CadastroUnidades.CB_PERIODICIDADE_TI.Enabled = False
                LV_Curva_LCTO.ListItems.Clear
                For ºL = 1 To ºU_Linha_O
                    B = Application.Search(Chr(10), a)
                    C = Left(a, B - 1)
                    a = Right(a, Len(a) - B)
                    If Application.IfError(Application.Search("%", C), 0) <> 0 Then
                        Set ºLi = CadastroUnidades.LV_Curva_LCTO.ListItems.Add(, , Format(C, "0.00000%"))
                    Else
                        Set ºLi = CadastroUnidades.LV_Curva_LCTO.ListItems.Add(, , Format(C / ºTotal, "0.00000%"))
                        ºV = True
                    End If
                    ºLi.SubItems(1) = ºINICIO + ºL - 1
                Next
                If ºV Then CB_VALOR_TI.Value = Format(ºTotal, "#,##0.00")
            End If
            On Error GoTo 0
            Me.DEL_CURVA_LCTO.Enabled = True
        End If
    End If
End Sub


Private Sub M2_Medio_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Dim ºI As Integer
    Eventos = False
    Call FormatarNumCur("CadastroUnidades", "M2_Medio", 2)
    If M2_Medio.Value <> "" Then
        For ºI = 1 To 30
            If Me.Controls("TB_ValorM²_Tipologia_" & ºI).Visible Then
                Me.Controls("TB_ValorM²_Tipologia_" & ºI).Value = M2_Medio.Value
                If Me.Controls("TB_M²_Tipologia_" & ºI).Value <> "" Then _
                Me.Controls("TB_VGV_Tipologia_" & ºI).Value = Format(Round(Me.Controls("TB_ValorM²_Tipologia_" & ºI).Value * Me.Controls("TB_M²_Tipologia_" & ºI).Value, 2), "#,##0.00")
                
                If Me.Controls("TB_M²_Tipologia_" & ºI).Value <> "" And Me.Controls("TB_Fator_Tipologia_" & ºI).Value <> "" And Me.Controls("TB_M²_D_Tipologia_" & ºI).Value <> "" Then _
                 Me.Controls("TB_VGV_Tipologia_" & ºI).Value = Format(Round(Me.Controls("TB_ValorM²_Tipologia_" & ºI).Value * Me.Controls("TB_M²_Tipologia_" & ºI).Value, 2) + Round(Me.Controls("TB_ValorM²_Tipologia_" & ºI).Value _
                 * Me.Controls("TB_M²_D_Tipologia_" & ºI).Value * CDbl((Replace(Me.Controls("TB_Fator_Tipologia_" & ºI).Value, "%", "")) / 100), 2), "#,##0.00")
                
                Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_" & ºI, 2)
            End If
        Next
    End If
    Eventos = True
    Call ATT_P_cap
    Call CarregarTotais
End Sub

Private Sub TB_BGN_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If TB_BGN_1 = "" Then
        TB_BGN_1.Value = TB_BGN_2.Value
        TB_BGN_2.Value = ""
    End If
End Sub

Private Sub TB_BGN_4_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If TB_BGN_3.Value = "" Then
        TB_BGN_3.Value = TB_BGN_4.Value
        TB_BGN_4.Value = ""
    End If
End Sub

Private Sub TB_DURACAO_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If TB_DURACAO_1.Value = "" Then
        TB_DURACAO_1.Value = TB_DURACAO_2.Value
        TB_DURACAO_2.Value = ""
    End If
End Sub

Private Sub TB_DURACAO_4_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If TB_DURACAO_3.Value = "" Then
        TB_DURACAO_3.Value = TB_DURACAO_4.Value
        TB_DURACAO_4.Value = ""
    End If
End Sub

Private Sub SELECT_ALL_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºiTENS = Me.List_Tipologias.ListCount - 1
    For ºI = 0 To ºiTENS
        Me.List_Tipologias.Selected(ºI) = SELECT_ALL.Value
    Next
End Sub

Private Sub tb_ini_pos_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "tb_ini_pos", 0)
    If LIST_Perfil_Venda.ListItems.Count > 0 Then
        ºCod = LIST_Perfil_Venda.SelectedItem
        ºL = Application.IfError(Application.Match(CDbl(ºCod), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºL + 900).Value = tb_ini_pos.Value
        Call Carregar_PRF_VND(CInt(ºL))
    Else
        Call Carregar_PRF_VND(0)
    End If
End Sub

Private Sub TB_NAME_PERF_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If LIST_Perfil_Venda.ListItems.Count > 0 Then
        ºCod = LIST_Perfil_Venda.SelectedItem
        ºL = Application.IfError(Application.Match(CDbl(ºCod), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL + 900).Value = TB_NAME_PERF.Value
        Call Carregar_PRF_VND(CInt(ºL))
    Else
        Call Carregar_PRF_VND(0)
    End If
End Sub

Private Sub TB_NOME_ESTUDO_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºNOME_VERSÃO (TB_NOME_ESTUDO.Value)
End Sub

Private Sub TB_PARTICIPAÇÃO_FISICA_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_PARTICIPAÇÃO_FISICA", 2)
    ºR = Application.Match("ºP_FISICA", ThisWorkbook.Sheets("BD_CAD_VND").Range("b:b"), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºR).Value = TB_PARTICIPAÇÃO_FISICA.Value
End Sub


Private Sub TB_Percent_Permuta_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
    If MsgBox("Tem certeza que deseja redistribuir a permuta física?", vbYesNo, "") <> vbYes Then
        Application.EnableEvents = False
        Call ATT_P_cap
        ºSenha = TB_Percent_Permuta.Value
        Cancel = False
        Application.EnableEvents = True
    Else
        ºSenha = ""
        Cancel = False
    End If
End Sub

Private Sub TB_PARTICIPAÇÃO_FINANC_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_PARTICIPAÇÃO_FINANC", 2)
    ºR = Application.Match("ºP_FINANC", ThisWorkbook.Sheets("BD_CAD_VND").Range("b:b"), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºR).Value = TB_PARTICIPAÇÃO_FINANC.Value
End Sub


Private Sub TB_TX_IRCSLL_P_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_TX_IRCSLL_P", 2)
    ºR = Application.Match("ºP_IRCSLL", ThisWorkbook.Sheets("BD_CAD_VND").Range("b:b"), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºR).Value = TB_TX_IRCSLL_P.Value
End Sub
Private Sub TB_TX_PISCOFINS_P_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_TX_PISCOFINS_P", 2)
    ºR = Application.Match("ºP_PISCOFINS", ThisWorkbook.Sheets("BD_CAD_VND").Range("b:b"), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºR).Value = TB_TX_PISCOFINS_P.Value
End Sub
Private Sub TB_TX_RET_P_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_TX_RET_P", 2)
    ºR = Application.Match("ºP_RET", ThisWorkbook.Sheets("BD_CAD_VND").Range("b:b"), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºR).Value = TB_TX_RET_P.Value
End Sub
Private Sub TB_DURACAO_1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºABA = 2
    vinculo_lçto.Show
End Sub
Private Sub TB_DURACAO_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If Button = 2 Then a = MsgBox("clique duas vezes para habilitar o vinculo de datas", vbInformation, "")
End Sub
Private Sub TB_INCORRIDO_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_INCORRIDO", 2)
    Call SalvarFase
End Sub
Private Sub TB_INI_OBRA_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºABA = 1
    vinculo_lçto.Show
End Sub

Private Sub TB_Valor_Liquido_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_Valor_Liquido", 2)
    If FormatDouble(TB_VGV_Terreno_Fiscal.Value) <> 0 Then
        TB_PRTC_PRMT.Value = FormatDouble(TB_Valor_Liquido.Value) / FormatDouble(TB_VGV_Terreno_Fiscal)
        Call FormatarNum("CadastroUnidades", "TB_PRTC_PRMT", 4)
    End If
End Sub

Private Sub TB_VAR_1_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If TB_VAR_1.Value <> "" Then
        ºVAR_1 (TB_VAR_1.Value)
    Else
        TB_VAR_1.Value = 0
        ºVAR_1 (0)
    End If
End Sub
Private Sub TB_VAR_2_afterupdate()
    If TB_VAR_2.Value <> "" Then
        ºVAR_2 (TB_VAR_2.Value)
    Else
        TB_VAR_2.Value = 0
        ºVAR_2 (0)
    End If
End Sub

Private Sub UserForm_Initialize()
    'Dim hwnd As Long 'handle to get the window
    'hwnd = FindWindow(vbNullString, Me.Caption)
    Custo_Obra_Pvt.AddItem "Custo do m² Pvt. C/ Taxas"
    Custo_Obra_Pvt.AddItem "Custo do m² Pvt. S/ Taxas"
    
    'SetWindowLong hwnd, -16, &H20000 Or &H84C80080
End Sub
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    Dim ºOK, ºCheck As Boolean
    ºOK = True
    ºCheck = True
    Call DescarregarFases
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(1, 1).Value = False
    If CloseMode = 0 Then
        Application.DisplayAlerts = False
        For Each ºWB In Application.Workbooks
            Application.DisplayAlerts = False
            If ºWB.Name <> ThisWorkbook.Name Then ºWB.Close False
        Next
        RestoreExcelIcon
        Application.WindowState = xlNormal
        Application.Height = 600
        Application.Width = 600

        ThisWorkbook.Parent.Quit
        ThisWorkbook.Close False
    Else
        Me.Show
        Cancel = 1
    End If
End Sub
Private Sub AS_ADM_P_UNID_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "AS_ADM_P_UNID", 2)
    If AS_UNID_TOTAL.Caption <> "" And AS_UNID_TOTAL.Caption > 0 And AS_ADM_P_UNID <> "" Then
        AS_ADM_TOTAL.Value = AS_UNID_TOTAL.Caption * AS_ADM_P_UNID.Value
        Call FormatarNumCur("CadastroUnidades", "AS_ADM_TOTAL", 2)
    End If
    ºR = Application.Match("ºAS_ADM_P_UNID", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_ADM_P_UNID.Value
End Sub
Private Sub AS_ADM_TOTAL_afterupdate()
    Call FormatarNumCur("CadastroUnidades", "AS_ADM_TOTAL", 2)
End Sub
Private Sub AS_LIBERACAO_afterupdate()
    Call FormatarNum("CadastroUnidades", "AS_LIBERACAO", 2)
    ºR = Application.Match("ºAS_LIBERACAO", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_LIBERACAO.Value
End Sub
Private Sub AS_PRCT_DEFLA_afterupdate()
    Call FormatarNum("CadastroUnidades", "AS_PRCT_DEFLA", 2)
    ºR = Application.Match("ºAS_PRCT_DEFLA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_PRCT_DEFLA.Value
End Sub
Private Sub AS_PRCT_SEG_OBRA_afterupdate()
    Call FormatarNum("CadastroUnidades", "AS_PRCT_SEG_OBRA", 5)
    ºR = Application.Match("ºAS_PRCT_SEG_OBRA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_PRCT_SEG_OBRA.Value
End Sub
Private Sub AS_PRCT_VGV_FIN_afterupdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "AS_PRCT_VGV_FIN", 4)
    If AS_VGV_TOTAL.Caption <> "" And AS_VGV_TOTAL.Caption > 0 And AS_PRCT_VGV_FIN <> "" Then
        AS_VGV_FIN.Value = AS_VGV_TOTAL.Caption * (Replace(AS_PRCT_VGV_FIN.Value, "%", "") / 100)
        Call FormatarNumCur("CadastroUnidades", "AS_VGV_FIN", 2)
    End If
    ºR = Application.Match("ºAS_VGV_FIN", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_VGV_FIN.Value
End Sub
Private Sub AS_PZ_DOC_Change()
    Dim ºR As Integer
    Call FormatarNumCur("CadastroUnidades", "AS_PZ_DOC", 0)
    ºR = Application.Match("ºAS_PZ_DOC", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_PZ_DOC.Value
End Sub

Private Sub AS_PZ_LIBERACAO_afterupdate()
    Call FormatarNumCur("CadastroUnidades", "AS_PZ_LIBERACAO", 0)
    ºR = Application.Match("ºAS_PZ_LIBERACAO", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_PZ_LIBERACAO.Value
End Sub
Private Sub AS_PZ_ULTIMA_afterupdate()
    Call FormatarNumCur("CadastroUnidades", "AS_PZ_ULTIMA", 0)
    ºR = Application.Match("ºAS_PZ_ULTIMA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_PZ_ULTIMA.Value
End Sub
Private Sub AS_TX_CONTRATO_afterupdate()
    Call FormatarNumCur("CadastroUnidades", "AS_TX_CONTRATO", 2)
    If AS_UNID_TOTAL.Caption <> "" And AS_UNID_TOTAL.Caption > 0 And AS_TX_CONTRATO <> "" Then
        AS_TOTAL_CONTRATO.Value = AS_UNID_TOTAL.Caption * AS_TX_CONTRATO.Value
        Call FormatarNumCur("CadastroUnidades", "AS_TOTAL_CONTRATO", 2)
    End If
    ºR = Application.Match("ºAS_TX_CONTRATO", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_TX_CONTRATO.Value
End Sub
Private Sub AS_TX_MD_OBRA_afterupdate()
    Call FormatarNumCur("CadastroUnidades", "AS_TX_MD_OBRA", 2)
    ºR = Application.Match("ºAS_TX_MD_OBRA", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_TX_MD_OBRA.Value
End Sub
Private Sub AS_VGV_FIN_afterupdate()
    Call FormatarNumCur("CadastroUnidades", "AS_VGV_FIN", 2)
    If AS_VGV_TOTAL.Caption <> "" And AS_VGV_TOTAL.Caption > 0 And AS_VGV_FIN.Value <> "" Then
        AS_PRCT_VGV_FIN.Value = (AS_VGV_FIN.Value / AS_VGV_TOTAL.Caption) * 100
        Call FormatarNum("CadastroUnidades", "AS_PRCT_VGV_FIN", 4)
    End If
    ºR = Application.Match("ºAS_VGV_FIN", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_VGV_FIN.Value
End Sub
Private Sub AS_VLR_TERRENO_afterupdate()
    Call FormatarNumCur("CadastroUnidades", "AS_VLR_TERRENO", 2)
    ºR = Application.Match("ºAS_VLR_TERRENO", ThisWorkbook.Sheets("BD_CAD_VND").Columns(2), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºR, 3).Value = AS_VLR_TERRENO.Value
End Sub
Private Sub Associativo_change()
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B480").Value = Associativo.Value
    CLIQUE_ASS
End Sub
Private Sub FiltrarLançamentos_change()
    LV_Lançamentos_TI.ColumnHeaders.Clear
    LV_Lançamentos_TI.ListItems.Clear
    LV_Curva_LCTO.ColumnHeaders.Clear
    LV_Curva_LCTO.ListItems.Clear
    Carregar_LV_TI
    PEP_FILTRO.Visible = FiltrarLançamentos.Value
End Sub
Private Sub CommandButton10_Click()
    SelecionarCurvaObra.Show
End Sub
Private Sub ERASE_PERF_VEND_Click()
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
   
   If MsgBox("Confirma a Exclusão? ", vbYesNo, "") = vbYes Then
        If LIST_Perfil_Venda.ListItems.Count > 0 Then
            ºperfil = Me.LIST_Perfil_Venda.SelectedItem
            ºiTENS = Me.List_Tipologias.ListCount - 1
            For ºI = 0 To ºiTENS
                ºItem = Me.List_Tipologias.List(ºI)
                If CDbl(ºItem) < 35 Then
                    If ThisWorkbook.Sheets("BD_CAD_VND").Range("N" & ºItem).Value = CDbl(ºperfil) Then
                        ThisWorkbook.Sheets("BD_CAD_VND").Range("N" & ºItem).Value = ""
                    End If
                Else
                    If ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºItem).Value = CDbl(ºperfil) Then
                        ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºItem).Value = ""
                    End If
                End If
            Next
            ºLTBL = ThisWorkbook.Sheets("BD_CAD_VND").Cells(157, 2).End(xlUp).Row
            ºCod = Application.Match(CDbl(LIST_Perfil_Venda.SelectedItem), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0)
            ºCod = 900 + ºCod
            ºLVel = ThisWorkbook.Sheets("BD_CAD_VND").Range("c" & ºCod).Value
            ºLVel = 56 + Application.Match(ºLVel, ThisWorkbook.Sheets("BD_CAD_VND").Range("B57:B106"), 0)
            ThisWorkbook.Sheets("BD_CAD_VND").Range(ºLVel & ":" & ºLVel).ClearContents
            
            ºLVel = ThisWorkbook.Sheets("BD_CAD_VND").Cells(106, 2).End(xlUp).Row
            If ThisWorkbook.Sheets("BD_CAD_VND").AutoFilterMode = True Then ThisWorkbook.Sheets("BD_CAD_VND").AutoFilterMode = False
            ThisWorkbook.Sheets("BD_CAD_VND").Range("56:" & ºLVel).AutoFilter
            ThisWorkbook.Worksheets("BD_CAD_VND").AutoFilter.Sort.SortFields.Add Key:=Range("B56:B" & ºLVel), SortOn:=xlSortOnValues, Order:=xlAscending
            With ThisWorkbook.Worksheets("BD_CAD_VND").AutoFilter.Sort
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
            
            ThisWorkbook.Sheets("BD_CAD_VND").Range("A" & ºCod & ":H" & ºCod).ClearContents
            ºLVel = ThisWorkbook.Sheets("BD_CAD_VND").Cells(951, 2).End(xlUp).Row
            If ThisWorkbook.Sheets("BD_CAD_VND").AutoFilterMode = True Then ThisWorkbook.Sheets("BD_CAD_VND").AutoFilterMode = False
            ThisWorkbook.Sheets("BD_CAD_VND").Range("A900:I" & ºLVel).AutoFilter
            ThisWorkbook.Worksheets("BD_CAD_VND").AutoFilter.Sort.SortFields.Add Key:=Range("A900:A" & ºLVel), SortOn:=xlSortOnValues, Order:=xlAscending
            With ThisWorkbook.Worksheets("BD_CAD_VND").AutoFilter.Sort
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
            CadastroUnidades.List_Tabela.ListItems.Clear
            BT_ERASE_TBL.Enabled = False
            BT_COPY_TBL.Enabled = False
            BT_EDIT_TBL.Enabled = False
            Call TravarCampos
            CarregarVelocidades (0)
            Call Carregar_Perf_Vnd
        'If LIST_Perfil_Venda.ListItems.Count > 0 Then
        End If
    End If
End Sub
Private Sub INST_CURVA_LCTO_Click()
    If CB_FASE_TI.Value <> "" And CB_TIPO_LCTO_TI.Value <> "" And TB_Parcelas_TI.Value <> "" And CB_PERIODICIDADE_TI.Value <> "" _
    And CB_MESES_TI.Value <> "" And CB_VALOR_TI.Value <> "" Then
        Call Inserir_Curva_Lançamento
    Else
        If CB_FASE_TI.Value = "" Then ºCAMPOS = "Fase "
        If CB_TIPO_LCTO_TI.Value = "" Then ºCAMPOS = ºCAMPOS & "Tipo "
        If TB_Parcelas_TI.Value = "" Then ºCAMPOS = ºCAMPOS & "Parcelas "
        If CB_PERIODICIDADE_TI.Value = "" Then ºCAMPOS = ºCAMPOS & "Periodicidade "
        If CB_MESES_TI.Value = "" Then ºCAMPOS = ºCAMPOS & "Mes "
        If CB_VALOR_TI.Value = "" Then ºCAMPOS = ºCAMPOS & "Valor do lançamento "
        MsgBox "Os campos " & ºCAMPOS & " devem ser preenchidos!!!"
    End If
End Sub
Private Sub LIST_Perfil_Venda_B_ItemClick(ByVal Item As MSComctlLib.ListItem)
    Call Load_LV_Show_Curvas_Velocidade
    Call Load_show_tbl
End Sub
Private Sub LIST_Perfil_Venda_B_DblClick()
    If LIST_Perfil_Venda_B.ListItems.Count > 0 Then
        'VERIFICAÇÃO DE ERRO
        On Error GoTo chamarform
chamarform:
        If ErroMsg(Err) Then Exit Sub
        
        LIST_Perfil_Venda.ListItems(LIST_Perfil_Venda_B.SelectedItem.Index).Selected = True
        Call Carregar_Perf_Vnd
        Call ATT_Percentual_vel
        Me.MultiPage1.Value = 2
        LIST_Perfil_Venda.SetFocus
    End If
End Sub
Private Sub LIST_Perfil_Venda_ItemClick(ByVal Item As MSComctlLib.ListItem)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call Carregar_Perf_Vnd
    Call ATT_Percentual_vel
    LIST_Perfil_Venda.SetFocus
End Sub
Private Sub NEW_PERF_VEND_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºLPerf = ThisWorkbook.Sheets("BD_CAD_VND").Cells(951, 2).End(xlUp).Row
    ºLVel = ThisWorkbook.Sheets("BD_CAD_VND").Cells(105, 2).End(xlUp).Row
    If ºLVel < 57 Then
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B57").Value = 1
        ºLVel = 56
    Else
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLVel + 1).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLVel).Value + 1
    End If
    
    If ºLPerf < 901 Then
        ThisWorkbook.Sheets("BD_CAD_VND").Range("A901").Value = 1
        ThisWorkbook.Sheets("BD_CAD_VND").Range("G901").Value = False
        ThisWorkbook.Sheets("BD_CAD_VND").Range("F901").Value = "12,00%"
        ºLPerf = 900
    Else
        ThisWorkbook.Sheets("BD_CAD_VND").Range("A" & ºLPerf + 1).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("A" & ºLPerf).Value + 1
        ThisWorkbook.Sheets("BD_CAD_VND").Range("G" & ºLPerf + 1).Value = False
        ThisWorkbook.Sheets("BD_CAD_VND").Range("F" & ºLPerf + 1).Value = "12,00%"
    End If
    ThisWorkbook.Sheets("BD_CAD_VND").Range("c" & ºLPerf + 1).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLVel + 1).Value
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLPerf + 1).Value = "Novo Perfil"
    ThisWorkbook.Sheets("BD_CAD_VND").Range("G" & ºLPerf + 1).Value = True
    Carregar_PRF_VND (0)
    CadastroUnidades.LIST_Perfil_Venda.ListItems(CadastroUnidades.LIST_Perfil_Venda.ListItems.Count).Selected = True
    Call Carregar_Perf_Vnd
End Sub
Private Sub NOME_Curva_AfterUpdate()
    If NOME_Curva <> "" Then
        Inserir_Curva.Enabled = True
    End If
End Sub
Private Sub TB_ADM_CARTEIRA_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_ADM_CARTEIRA", 4)
End Sub
Private Sub TB_Juros_TP_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_Juros_TP", 2)
    If LIST_Perfil_Venda.ListItems.Count > 0 Then
        ºCod = LIST_Perfil_Venda.SelectedItem
        ºL = Application.IfError(Application.Match(CDbl(ºCod), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
        ThisWorkbook.Sheets("BD_CAD_VND").Range("F" & ºL + 900).Value = TB_Juros_TP.Value
        Call Carregar_PRF_VND(CInt(ºL))
    Else
        Call Carregar_PRF_VND(0)
    End If
End Sub
Private Sub TB_MES_PGTO_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_MES_PGTO", 0)
End Sub
Private Sub TB_Prct_Area_PVT_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_Prct_Area_PVT", 3)
    TB_Area_Total_PVT.Value = (Replace(TB_Prct_Area_PVT.Value, "%", "") / 100) * Application.Sum(ThisWorkbook.Sheets("BD_CAD_VND").Range("C498:D517"))
    Call FormatarNumCur("CadastroUnidades", "TB_Area_Total_PVT", 3)
End Sub
Private Sub TB_PREMIO_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_PREMIO", 2)
End Sub
Private Sub TB_PRTC_PRMT_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_PRTC_PRMT", 4)
    If FormatDouble(TB_VGV_Terreno_Fiscal.Value) <> 0 Then
        'TB_Valor_Liquido.Value = TB_VGV_Terreno_Fiscal - TB_VGV_Permuta_Fiscal - (LB_TT_V_1 * FormatDouble(Replace(TB_TX_Permut_Fin.Value, "%", "")))
        TB_Valor_Liquido.Value = TB_VGV_Terreno_Fiscal - (TB_VGV_Terreno_Fiscal * (FormatDouble(Replace(TB_PRTC_PRMT.Value, "%", "")) / 100))
        Call FormatarNumCur("CadastroUnidades", "TB_Valor_Liquido", 2)
    Else
        TB_Valor_Liquido.Value = 0
    End If
End Sub
Private Sub TB_TX_Permuta_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_TX_Permuta", 4)
End Sub
Private Sub TB_VGV_Terreno_Fiscal_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Terreno_Fiscal", 4)
    If TB_VGV_Terreno_Fiscal = "" Then TB_VGV_Terreno_Fiscal.Value = 0
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Terreno_Fiscal", 4)
    If TB_PRTC_PRMT.Value <> "" Then
        TB_VGV_Permuta_Fiscal.Value = TB_VGV_Terreno_Fiscal * (Replace(TB_PRTC_PRMT, "%", "") / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_VGV_Permuta_Fiscal", 4)
    ElseIf TB_VGV_Permuta_Fiscal.Value <> "" Then
        TB_PRTC_PRMT.Value = (TB_VGV_Permuta_Fiscal / TB_VGV_Terreno_Fiscal) * 100
        Call FormatarNum("CadastroUnidades", "TB_PRTC_PRMT", 4)
    End If
End Sub
'##################################### CADASTRO DE TIPOLOGIAS #################################################
'---------------------------------------------------------------------------------------------------------------
'Barra de Rolagem Frame Tipologias
Private Sub FlatScrollBar1_Change()
    Frame6.ScrollLeft = FlatScrollBar1.Value
    Frame4.ScrollLeft = FlatScrollBar1.Value
End Sub
'Fixar permuta
Private Sub CB_FX_PERMUT_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Dim ºPERCENTUAL As Double
    Dim ºI As Integer
    ºPERCENTUAL = CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
    For ºI = 1 To 30
        If CB_FX_PERMUT.Value = True Then
            If Me.Controls("TB_Und_Tipologia_" & ºI).Value <> "" Then
                Me.Controls("TB_Permt_Tipologia_" & ºI).Value = Me.Controls("TB_Und_Tipologia_" & ºI).Value * ºPERCENTUAL
            End If
            Me.Controls("TB_Permt_Tipologia_" & ºI).Enabled = False
        Else
            Me.Controls("TB_Permt_Tipologia_" & ºI).Enabled = True
        End If
    Next
End Sub
'Redimensionar Form
Private Sub MultiPage1_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call RefreshListViews
    If (Me.MultiPage1.Value = 1 Or Me.MultiPage1.Value = 2 Or Me.MultiPage1.Value = 6) Then
        Me.Width = 903.75
        Me.MultiPage1.Width = 903.75
        If Me.LIST_Perfil_Venda.ListItems.Count > 0 And Me.MultiPage1.Value = 2 Then
            If Not ERASE_PERF_VEND.Enabled Then Call Carregar_Perf_Vnd Else Call Feed_List_Tipologias
        ElseIf Me.MultiPage1.Value = 1 Then
          CommandButton14.SetFocus
        End If
    ElseIf Me.Width <> 693.75 Then
        Me.Width = 693.75
        Me.MultiPage1.Width = 693.75
    End If
End Sub
'Permuta/ VGV
Private Sub OptionButton1_Click()
    Call ATT_P_cap
End Sub
'Permuta/ m²
Private Sub OptionButton2_Click()
    Call ATT_P_cap
End Sub
'Alterar percentual geral de permuta
Private Sub TB_Percent_Permuta_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Dim ºI As Integer
    Eventos = False
    If ºSenha <> "" Then
        TB_Percent_Permuta.Value = ºSenha
        ºSenha = ""
        Exit Sub
    End If
    Call FormatarNum("CadastroUnidades", "TB_Percent_Permuta", 4)
    If Replace(TB_Percent_Permuta.Value, "%", "") > 0 And TB_Percent_Permuta <> "" Then
        CalcPermutaFin.Enabled = False
    Else
        CalcPermutaFin.Enabled = True
    End If
    For ºI = 1 To 13
        If Me.Controls("TB_Percent_Permuta").Value <> "" And Me.Controls("TB_Und_Tipologia_" & ºI).Value <> "" Then
            Me.Controls("TB_Permt_Tipologia_" & ºI).Value = CDbl(Me.Controls("TB_Und_Tipologia_" & ºI).Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        End If
    Next
    Eventos = True
    Call ATT_P_cap
    Call CarregarTotais
End Sub
'Calcular Permuta Financeira
Private Sub CalcPermutaFin_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Dim ºPRMT, ºVgv As Double
    TB_VGV_Permuta_Fiscal.Value = 0
    If TB_VGV_Terreno_Fiscal.Value <> "" And TB_VGV_Terreno_Fiscal.Value > 0 And _
        TB_PRTC_PRMT.Value <> "" And TB_PRTC_PRMT.Value > 0 And _
        LB_TT_V_3.Caption <> "" And LB_TT_V_3.Caption > 0 Then
        ºPRMT = (Replace(TB_PRTC_PRMT.Value, "%", "") / 100) - ((Replace(TB_PRTC_PRMT.Value, "%", "") / 100) * (Replace(TB_Percent_Permuta.Value, "%", "") / 100))
        ºVgv = TB_VGV_Terreno_Fiscal.Value * ºPRMT
        TB_TX_Permut_Fin.Value = Round(ºVgv / LB_TT_V_3.Caption, 3) * 100
        Call FormatarNum("CadastroUnidades", "TB_TX_Permut_Fin", 3)
    End If
    If Application.IfError(Replace(TB_TX_Permut_Fin.Value, "%", ""), 0) > 0 Then
        CalcPermutaFis.Enabled = False
    Else
        CalcPermutaFis.Enabled = True
    End If
End Sub
'Calcular Permuta Fisica

Private Sub CalcPermutaFis_Click()
Dim ºPRMT As Double
Dim ºI As Integer
'VERIFICAÇÃO DE ERRO
On Error GoTo chamarform
chamarform:
If ErroMsg(Err) Then Exit Sub
    If MsgBox("confirma a redistribuição da permuta física?", vbYesNo) = vbYes Then
        If TB_VGV_Terreno_Fiscal.Value <> "" And TB_VGV_Terreno_Fiscal.Value > 0 And _
            TB_PRTC_PRMT.Value <> "" And TB_PRTC_PRMT.Value > 0 And _
            LB_TT_V_1.Caption <> "" And LB_TT_V_1.Caption > 0 Then
            ºPRMT = ((Replace(TB_PRTC_PRMT.Value, "%", "") / 100) * TB_VGV_Terreno_Fiscal.Value) / LB_TT_V_1.Caption
            TB_Percent_Permuta.Value = Round(ºPRMT * 100, 4)
            
            Call FormatarNum("CadastroUnidades", "TB_Percent_Permuta", 4)
            For ºI = 1 To 30
                If Me.Controls("TB_Percent_Permuta").Value <> "" And Me.Controls("TB_Und_Tipologia_" & ºI).Value <> "" Then
                    Me.Controls("TB_Permt_Tipologia_" & ºI).Value = CDbl(Me.Controls("TB_Und_Tipologia_" & ºI).Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
                End If
            Next
            Eventos = True
            Call ATT_P_cap
            Call CarregarTotais
            If TB_TX_Permut_Fis <> "" And TB_TX_Permut_Fis > 0 Then
                TB_VGV_Permuta_Fiscal = CDbl(TB_VGV_Terreno_Fiscal) * (CDbl(Replace(TB_TX_Permut_Fis, "%", "")) / 100) * (CDbl(Replace(PRTC_PRMT.Value, "%", "")) / 100)
                Call FormatarNumCur("CadastroUnidades", "TB_VGV_Permuta_Fiscal", 2)
            End If
            If TB_VGV_Terreno_Fiscal <> "" Then
                TB_VGV_Permuta_Fiscal.Value = TB_VGV_Terreno_Fiscal * (Replace(TB_PRTC_PRMT, "%", "") / 100)
                Call FormatarNumCur("CadastroUnidades", "TB_VGV_Permuta_Fiscal", 4)
            End If
        End If
        If TB_VGV_Permuta_Fiscal.Value > 0 Then
            CalcPermutaFin.Enabled = False
        Else
            CalcPermutaFin.Enabled = True
        End If
    End If
End Sub
'Ativar Linha quadro Tipologia
Private Sub CB_Tipologia_1_Change()
    Call Mostrar(1)
End Sub
Private Sub CB_Tipologia_2_Change()
    Call Mostrar(2)
End Sub
Private Sub CB_Tipologia_3_Change()
    Call Mostrar(3)
End Sub
Private Sub CB_Tipologia_4_Change()
    Call Mostrar(4)
End Sub
Private Sub CB_Tipologia_5_Change()
    Call Mostrar(5)
End Sub
Private Sub CB_Tipologia_6_Change()
    Call Mostrar(6)
End Sub
Private Sub CB_Tipologia_7_Change()
    Call Mostrar(7)
End Sub
Private Sub CB_Tipologia_8_Change()
    Call Mostrar(8)
End Sub
Private Sub CB_Tipologia_9_Change()
    Call Mostrar(9)
End Sub
Private Sub CB_Tipologia_10_Change()
    Call Mostrar(10)
End Sub
Private Sub CB_Tipologia_11_Change()
    Call Mostrar(11)
End Sub
Private Sub CB_Tipologia_12_Change()
    Call Mostrar(12)
End Sub
Private Sub CB_Tipologia_13_Change()
    Call Mostrar(13)
End Sub
Private Sub CB_Tipologia_14_Change()
    Call Mostrar(14)
End Sub
Private Sub CB_Tipologia_15_Change()
    Call Mostrar(15)
End Sub
Private Sub CB_Tipologia_16_Change()
    Call Mostrar(16)
End Sub
Private Sub CB_Tipologia_17_Change()
    Call Mostrar(17)
End Sub
Private Sub CB_Tipologia_18_Change()
    Call Mostrar(18)
End Sub
Private Sub CB_Tipologia_19_Change()
    Call Mostrar(19)
End Sub
Private Sub CB_Tipologia_20_Change()
    Call Mostrar(20)
End Sub
Private Sub CB_Tipologia_21_Change()
    Call Mostrar(21)
End Sub
Private Sub CB_Tipologia_22_Change()
    Call Mostrar(22)
End Sub
Private Sub CB_Tipologia_23_Change()
    Call Mostrar(23)
End Sub
Private Sub CB_Tipologia_24_Change()
    Call Mostrar(24)
End Sub
Private Sub CB_Tipologia_25_Change()
    Call Mostrar(25)
End Sub
Private Sub CB_Tipologia_26_Change()
    Call Mostrar(26)
End Sub
Private Sub CB_Tipologia_27_Change()
    Call Mostrar(27)
End Sub
Private Sub CB_Tipologia_28_Change()
    Call Mostrar(28)
End Sub
Private Sub CB_Tipologia_29_Change()
    Call Mostrar(29)
End Sub
Private Sub CB_Tipologia_30_Change()
    Call Mostrar(30)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_1_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_1", 0)
    If TB_Und_Tipologia_1.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_1.Value = CDbl(TB_Und_Tipologia_1.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub

'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_1_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_1_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_1", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_1_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_1", 2)
    If TB_ValorM²_Tipologia_1.Value = "" Then TB_ValorM²_Tipologia_1.Value = 0
    If TB_M²_Tipologia_1.Value <> "" Then TB_VGV_Tipologia_1.Value = Format(Round(TB_ValorM²_Tipologia_1 * TB_M²_Tipologia_1.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_1.Value <> "" And TB_Fator_Tipologia_1.Value <> "" And TB_M²_D_Tipologia_1.Value <> "" Then TB_VGV_Tipologia_1.Value = Format(Round(TB_ValorM²_Tipologia_1 * TB_M²_Tipologia_1.Value, 2) + Round(TB_ValorM²_Tipologia_1 * TB_M²_D_Tipologia_1.Value * CDbl((Replace(TB_Fator_Tipologia_1.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_1", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_1_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_1", 5)
    If TB_M²_Tipologia_1.Value <> "" And TB_Fator_Tipologia_1.Value <> "" And TB_M²_D_Tipologia_1.Value <> "" Then TB_VGV_Tipologia_1.Value = Format(Round(TB_ValorM²_Tipologia_1 * TB_M²_Tipologia_1.Value, 2) + Round(TB_ValorM²_Tipologia_1 * TB_M²_D_Tipologia_1.Value * CDbl((Replace(TB_Fator_Tipologia_1.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_1_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_1", 2)
    If TB_M²_Tipologia_1.Value <> "" And TB_Fator_Tipologia_1.Value <> "" And TB_M²_D_Tipologia_1.Value <> "" Then TB_VGV_Tipologia_1.Value = Format(Round(TB_ValorM²_Tipologia_1 * TB_M²_Tipologia_1.Value, 2) + Round(TB_ValorM²_Tipologia_1 * TB_M²_D_Tipologia_1.Value * CDbl((Replace(TB_Fator_Tipologia_1.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_1_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºCntr = 1
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_" & ºCntr, 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_" & ºCntr, 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_1_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_1", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_2", 2)
    If TB_Und_Tipologia_2.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_2.Value = CDbl(TB_Und_Tipologia_2.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_2", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_2", 5)
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_2", 2)
    If TB_ValorM²_Tipologia_2.Value = "" Then TB_ValorM²_Tipologia_2.Value = 0
    If TB_M²_Tipologia_2.Value <> "" Then TB_VGV_Tipologia_2.Value = Format(Round(TB_ValorM²_Tipologia_2 * TB_M²_Tipologia_2.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_2.Value <> "" And TB_Fator_Tipologia_2.Value <> "" And TB_M²_D_Tipologia_2.Value <> "" Then TB_VGV_Tipologia_2.Value = Format(Round(TB_ValorM²_Tipologia_2 * TB_M²_Tipologia_2.Value, 2) + Round(TB_ValorM²_Tipologia_2 * TB_M²_D_Tipologia_2.Value * CDbl((Replace(TB_Fator_Tipologia_2.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_2", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_2", 5)
    If TB_M²_Tipologia_2.Value <> "" And TB_Fator_Tipologia_2.Value <> "" And TB_M²_D_Tipologia_2.Value <> "" Then TB_VGV_Tipologia_2.Value = Format(Round(TB_ValorM²_Tipologia_2 * TB_M²_Tipologia_2.Value, 2) + Round(TB_ValorM²_Tipologia_2 * TB_M²_D_Tipologia_2.Value * CDbl((Replace(TB_Fator_Tipologia_2.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_2", 2)
    If TB_M²_Tipologia_2.Value <> "" And TB_Fator_Tipologia_2.Value <> "" And TB_M²_D_Tipologia_2.Value <> "" Then TB_VGV_Tipologia_2.Value = Format(Round(TB_ValorM²_Tipologia_2 * TB_M²_Tipologia_2.Value, 2) + Round(TB_ValorM²_Tipologia_2 * TB_M²_D_Tipologia_2.Value * CDbl((Replace(TB_Fator_Tipologia_2.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºCntr = 2
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_2", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_2", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_2_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_2", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_3_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_3", 2)
    If TB_Und_Tipologia_3.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_3.Value = CDbl(TB_Und_Tipologia_3.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_3_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_3", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_3_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_3", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_3_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_3", 2)
    If TB_M²_Tipologia_3.Value <> "" Then TB_VGV_Tipologia_3.Value = Format(Round(TB_ValorM²_Tipologia_3 * TB_M²_Tipologia_3.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_3.Value <> "" And TB_Fator_Tipologia_3.Value <> "" And TB_M²_D_Tipologia_3.Value <> "" Then TB_VGV_Tipologia_3.Value = Format(Round(TB_ValorM²_Tipologia_3 * TB_M²_Tipologia_3.Value, 2) + Round(TB_ValorM²_Tipologia_3 * TB_M²_D_Tipologia_3.Value * CDbl((Replace(TB_Fator_Tipologia_3.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_3", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_3_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_3", 5)
    If TB_M²_Tipologia_3.Value <> "" And TB_Fator_Tipologia_3.Value <> "" And TB_M²_D_Tipologia_3.Value <> "" Then TB_VGV_Tipologia_3.Value = Format(Round(TB_ValorM²_Tipologia_3 * TB_M²_Tipologia_3.Value, 2) + Round(TB_ValorM²_Tipologia_3 * TB_M²_D_Tipologia_3.Value * CDbl((Replace(TB_Fator_Tipologia_3.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_3_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_3", 2)
    If TB_M²_Tipologia_3.Value <> "" And TB_Fator_Tipologia_3.Value <> "" And TB_M²_D_Tipologia_3.Value <> "" Then TB_VGV_Tipologia_3.Value = Format(Round(TB_ValorM²_Tipologia_3 * TB_M²_Tipologia_3.Value, 2) + Round(TB_ValorM²_Tipologia_3 * TB_M²_D_Tipologia_3.Value * CDbl((Replace(TB_Fator_Tipologia_3.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_3_AfterUpdate()
    ºCntr = 3
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_3", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_3", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_3_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_3", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_4_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_4", 2)
    If TB_Und_Tipologia_4.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_4.Value = CDbl(TB_Und_Tipologia_4.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_4_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_4", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_4_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_4", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_4_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_4", 2)
    If TB_M²_Tipologia_4.Value <> "" Then TB_VGV_Tipologia_4.Value = Format(Round(TB_ValorM²_Tipologia_4 * TB_M²_Tipologia_4.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_4.Value <> "" And TB_Fator_Tipologia_4.Value <> "" And TB_M²_D_Tipologia_4.Value <> "" Then TB_VGV_Tipologia_4.Value = Format(Round(TB_ValorM²_Tipologia_4 * TB_M²_Tipologia_4.Value, 2) + Round(TB_ValorM²_Tipologia_4 * TB_M²_D_Tipologia_4.Value * CDbl((Replace(TB_Fator_Tipologia_4.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_4", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_4_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_4", 5)
    If TB_M²_Tipologia_4.Value <> "" And TB_Fator_Tipologia_4.Value <> "" And TB_M²_D_Tipologia_4.Value <> "" Then TB_VGV_Tipologia_4.Value = Format(Round(TB_ValorM²_Tipologia_4 * TB_M²_Tipologia_4.Value, 2) + Round(TB_ValorM²_Tipologia_4 * TB_M²_D_Tipologia_4.Value * CDbl((Replace(TB_Fator_Tipologia_4.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_4_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_4", 2)
    If TB_M²_Tipologia_4.Value <> "" And TB_Fator_Tipologia_4.Value <> "" And TB_M²_D_Tipologia_4.Value <> "" Then TB_VGV_Tipologia_4.Value = Format(Round(TB_ValorM²_Tipologia_4 * TB_M²_Tipologia_4.Value, 2) + Round(TB_ValorM²_Tipologia_4 * TB_M²_D_Tipologia_4.Value * CDbl((Replace(TB_Fator_Tipologia_4.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_4_AfterUpdate()
    ºCntr = 4
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_4", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_4", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_4_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_4", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_5_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_5", 2)
    If TB_Und_Tipologia_5.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_5.Value = CDbl(TB_Und_Tipologia_5.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_5_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_5", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_5_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_5", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_5_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_5", 2)
    If TB_M²_Tipologia_5.Value <> "" Then TB_VGV_Tipologia_5.Value = Format(Round(TB_ValorM²_Tipologia_5 * TB_M²_Tipologia_5.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_5.Value <> "" And TB_Fator_Tipologia_5.Value <> "" And TB_M²_D_Tipologia_5.Value <> "" Then TB_VGV_Tipologia_5.Value = Format(Round(TB_ValorM²_Tipologia_5 * TB_M²_Tipologia_5.Value, 2) + Round(TB_ValorM²_Tipologia_5 * TB_M²_D_Tipologia_5.Value * CDbl((Replace(TB_Fator_Tipologia_5.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_5", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_5_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_5", 5)
    If TB_M²_Tipologia_5.Value <> "" And TB_Fator_Tipologia_5.Value <> "" And TB_M²_D_Tipologia_5.Value <> "" Then TB_VGV_Tipologia_5.Value = Format(Round(TB_ValorM²_Tipologia_5 * TB_M²_Tipologia_5.Value, 2) + Round(TB_ValorM²_Tipologia_5 * TB_M²_D_Tipologia_5.Value * CDbl((Replace(TB_Fator_Tipologia_5.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_5_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_5", 2)
    If TB_M²_Tipologia_5.Value <> "" And TB_Fator_Tipologia_5.Value <> "" And TB_M²_D_Tipologia_5.Value <> "" Then TB_VGV_Tipologia_5.Value = Format(Round(TB_ValorM²_Tipologia_5 * TB_M²_Tipologia_5.Value, 2) + Round(TB_ValorM²_Tipologia_5 * TB_M²_D_Tipologia_5.Value * CDbl((Replace(TB_Fator_Tipologia_5.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_5_AfterUpdate()
    ºCntr = 5
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_5", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_5", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_5_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_5", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_6_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_6", 2)
    If TB_Und_Tipologia_6.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_6.Value = CDbl(TB_Und_Tipologia_6.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_6_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_6", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_6_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_6", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_6_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_6", 2)
    If TB_M²_Tipologia_6.Value <> "" Then TB_VGV_Tipologia_6.Value = Format(Round(TB_ValorM²_Tipologia_6 * TB_M²_Tipologia_6.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_6.Value <> "" And TB_Fator_Tipologia_6.Value <> "" And TB_M²_D_Tipologia_6.Value <> "" Then TB_VGV_Tipologia_6.Value = Format(Round(TB_ValorM²_Tipologia_6 * TB_M²_Tipologia_6.Value, 2) + Round(TB_ValorM²_Tipologia_6 * TB_M²_D_Tipologia_6.Value * CDbl((Replace(TB_Fator_Tipologia_6.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_6", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_6_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_6", 5)
    If TB_M²_Tipologia_6.Value <> "" And TB_Fator_Tipologia_6.Value <> "" And TB_M²_D_Tipologia_6.Value <> "" Then TB_VGV_Tipologia_6.Value = Format(Round(TB_ValorM²_Tipologia_6 * TB_M²_Tipologia_6.Value, 2) + Round(TB_ValorM²_Tipologia_6 * TB_M²_D_Tipologia_6.Value * CDbl((Replace(TB_Fator_Tipologia_6.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_6_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_6", 2)
    If TB_M²_Tipologia_6.Value <> "" And TB_Fator_Tipologia_6.Value <> "" And TB_M²_D_Tipologia_6.Value <> "" Then TB_VGV_Tipologia_6.Value = Format(Round(TB_ValorM²_Tipologia_6 * TB_M²_Tipologia_6.Value, 2) + Round(TB_ValorM²_Tipologia_6 * TB_M²_D_Tipologia_6.Value * CDbl((Replace(TB_Fator_Tipologia_6.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_6_AfterUpdate()
    ºCntr = 6
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_6", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_6", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_6_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_6", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_7_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_7", 2)
    If TB_Und_Tipologia_7.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_7.Value = CDbl(TB_Und_Tipologia_7.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_7_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_7", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_7_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_7", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_7_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_7", 2)
    If TB_M²_Tipologia_7.Value <> "" Then TB_VGV_Tipologia_7.Value = Format(Round(TB_ValorM²_Tipologia_7 * TB_M²_Tipologia_7.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_7.Value <> "" And TB_Fator_Tipologia_7.Value <> "" And TB_M²_D_Tipologia_7.Value <> "" Then TB_VGV_Tipologia_7.Value = Format(Round(TB_ValorM²_Tipologia_7 * TB_M²_Tipologia_7.Value, 2) + Round(TB_ValorM²_Tipologia_7 * TB_M²_D_Tipologia_7.Value * CDbl((Replace(TB_Fator_Tipologia_7.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_7", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_7_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_7", 5)
    If TB_M²_Tipologia_7.Value <> "" And TB_Fator_Tipologia_7.Value <> "" And TB_M²_D_Tipologia_7.Value <> "" Then TB_VGV_Tipologia_7.Value = Format(Round(TB_ValorM²_Tipologia_7 * TB_M²_Tipologia_7.Value, 2) + Round(TB_ValorM²_Tipologia_7 * TB_M²_D_Tipologia_7.Value * CDbl((Replace(TB_Fator_Tipologia_7.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_7_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_7", 2)
    If TB_M²_Tipologia_7.Value <> "" And TB_Fator_Tipologia_7.Value <> "" And TB_M²_D_Tipologia_7.Value <> "" Then TB_VGV_Tipologia_7.Value = Format(Round(TB_ValorM²_Tipologia_7 * TB_M²_Tipologia_7.Value, 2) + Round(TB_ValorM²_Tipologia_7 * TB_M²_D_Tipologia_7.Value * CDbl((Replace(TB_Fator_Tipologia_7.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_7_AfterUpdate()
    ºCntr = 7
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_7", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_7", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_7_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_7", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_8_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_8", 2)
    If TB_Und_Tipologia_8.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_8.Value = CDbl(TB_Und_Tipologia_8.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_8_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_8", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_8_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_8", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_8_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_8", 2)
    If TB_M²_Tipologia_8.Value <> "" Then TB_VGV_Tipologia_8.Value = Format(Round(TB_ValorM²_Tipologia_8 * TB_M²_Tipologia_8.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_8.Value <> "" And TB_Fator_Tipologia_8.Value <> "" And TB_M²_D_Tipologia_8.Value <> "" Then TB_VGV_Tipologia_8.Value = Format(Round(TB_ValorM²_Tipologia_8 * TB_M²_Tipologia_8.Value, 2) + Round(TB_ValorM²_Tipologia_8 * TB_M²_D_Tipologia_8.Value * CDbl((Replace(TB_Fator_Tipologia_8.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_8", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_8_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_8", 5)
    If TB_M²_Tipologia_8.Value <> "" And TB_Fator_Tipologia_8.Value <> "" And TB_M²_D_Tipologia_8.Value <> "" Then TB_VGV_Tipologia_8.Value = Format(Round(TB_ValorM²_Tipologia_8 * TB_M²_Tipologia_8.Value, 2) + Round(TB_ValorM²_Tipologia_8 * TB_M²_D_Tipologia_8.Value * CDbl((Replace(TB_Fator_Tipologia_8.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_8_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_8", 2)
    If TB_M²_Tipologia_8.Value <> "" And TB_Fator_Tipologia_8.Value <> "" And TB_M²_D_Tipologia_8.Value <> "" Then TB_VGV_Tipologia_8.Value = Format(Round(TB_ValorM²_Tipologia_8 * TB_M²_Tipologia_8.Value, 2) + Round(TB_ValorM²_Tipologia_8 * TB_M²_D_Tipologia_8.Value * CDbl((Replace(TB_Fator_Tipologia_8.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_8_AfterUpdate()
    ºCntr = 8
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_8", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_8", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_8_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_8", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_9_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_9", 2)
    If TB_Und_Tipologia_9.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_9.Value = CDbl(TB_Und_Tipologia_9.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_9_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_9", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_9_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_9", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_9_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_9", 2)
    If TB_M²_Tipologia_9.Value <> "" Then TB_VGV_Tipologia_9.Value = Format(Round(TB_ValorM²_Tipologia_9 * TB_M²_Tipologia_9.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_9.Value <> "" And TB_Fator_Tipologia_9.Value <> "" And TB_M²_D_Tipologia_9.Value <> "" Then TB_VGV_Tipologia_9.Value = Format(Round(TB_ValorM²_Tipologia_9 * TB_M²_Tipologia_9.Value, 2) + Round(TB_ValorM²_Tipologia_9 * TB_M²_D_Tipologia_9.Value * CDbl((Replace(TB_Fator_Tipologia_9.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_9", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_9_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_9", 5)
    If TB_M²_Tipologia_9.Value <> "" And TB_Fator_Tipologia_9.Value <> "" And TB_M²_D_Tipologia_9.Value <> "" Then TB_VGV_Tipologia_9.Value = Format(Round(TB_ValorM²_Tipologia_9 * TB_M²_Tipologia_9.Value, 2) + Round(TB_ValorM²_Tipologia_9 * TB_M²_D_Tipologia_9.Value * CDbl((Replace(TB_Fator_Tipologia_9.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_9_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_9", 2)
    If TB_M²_Tipologia_9.Value <> "" And TB_Fator_Tipologia_9.Value <> "" And TB_M²_D_Tipologia_9.Value <> "" Then TB_VGV_Tipologia_9.Value = Format(Round(TB_ValorM²_Tipologia_9 * TB_M²_Tipologia_9.Value, 2) + Round(TB_ValorM²_Tipologia_9 * TB_M²_D_Tipologia_9.Value * CDbl((Replace(TB_Fator_Tipologia_9.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_9_AfterUpdate()
    ºCntr = 9
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_9", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_9", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_9_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_9", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_10_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_10", 2)
    If TB_Und_Tipologia_10.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_10.Value = CDbl(TB_Und_Tipologia_10.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_10_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_10", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_10_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_10", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_10_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_10", 2)
    If TB_M²_Tipologia_10.Value <> "" Then TB_VGV_Tipologia_10.Value = Format(Round(TB_ValorM²_Tipologia_10 * TB_M²_Tipologia_10.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_10.Value <> "" And TB_Fator_Tipologia_10.Value <> "" And TB_M²_D_Tipologia_10.Value <> "" Then TB_VGV_Tipologia_10.Value = Format(Round(TB_ValorM²_Tipologia_10 * TB_M²_Tipologia_10.Value, 2) + Round(TB_ValorM²_Tipologia_10 * TB_M²_D_Tipologia_10.Value * CDbl((Replace(TB_Fator_Tipologia_10.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_10", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_10_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_10", 5)
    If TB_M²_Tipologia_10.Value <> "" And TB_Fator_Tipologia_10.Value <> "" And TB_M²_D_Tipologia_10.Value <> "" Then TB_VGV_Tipologia_10.Value = Format(Round(TB_ValorM²_Tipologia_10 * TB_M²_Tipologia_10.Value, 2) + Round(TB_ValorM²_Tipologia_10 * TB_M²_D_Tipologia_10.Value * CDbl((Replace(TB_Fator_Tipologia_10.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_10_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_10", 2)
    If TB_M²_Tipologia_10.Value <> "" And TB_Fator_Tipologia_10.Value <> "" And TB_M²_D_Tipologia_10.Value <> "" Then TB_VGV_Tipologia_10.Value = Format(Round(TB_ValorM²_Tipologia_10 * TB_M²_Tipologia_10.Value, 2) + Round(TB_ValorM²_Tipologia_10 * TB_M²_D_Tipologia_10.Value * CDbl((Replace(TB_Fator_Tipologia_10.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_10_AfterUpdate()
    ºCntr = 10
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_10", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_10", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_10_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_10", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_11_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_11", 2)
    If TB_Und_Tipologia_11.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_11.Value = CDbl(TB_Und_Tipologia_11.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_11_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_11", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_11_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_11", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_11_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_11", 2)
    If TB_M²_Tipologia_11.Value <> "" Then TB_VGV_Tipologia_11.Value = Format(Round(TB_ValorM²_Tipologia_11 * TB_M²_Tipologia_11.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_11.Value <> "" And TB_Fator_Tipologia_11.Value <> "" And TB_M²_D_Tipologia_11.Value <> "" Then TB_VGV_Tipologia_11.Value = Format(Round(TB_ValorM²_Tipologia_11 * TB_M²_Tipologia_11.Value, 2) + Round(TB_ValorM²_Tipologia_11 * TB_M²_D_Tipologia_11.Value * CDbl((Replace(TB_Fator_Tipologia_11.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_11", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_11_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_11", 5)
    If TB_M²_Tipologia_11.Value <> "" And TB_Fator_Tipologia_11.Value <> "" And TB_M²_D_Tipologia_11.Value <> "" Then TB_VGV_Tipologia_11.Value = Format(Round(TB_ValorM²_Tipologia_11 * TB_M²_Tipologia_11.Value, 2) + Round(TB_ValorM²_Tipologia_11 * TB_M²_D_Tipologia_11.Value * CDbl((Replace(TB_Fator_Tipologia_11.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_11_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_11", 2)
    If TB_M²_Tipologia_11.Value <> "" And TB_Fator_Tipologia_11.Value <> "" And TB_M²_D_Tipologia_11.Value <> "" Then TB_VGV_Tipologia_11.Value = Format(Round(TB_ValorM²_Tipologia_11 * TB_M²_Tipologia_11.Value, 2) + Round(TB_ValorM²_Tipologia_11 * TB_M²_D_Tipologia_11.Value * CDbl((Replace(TB_Fator_Tipologia_11.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_11_AfterUpdate()
    ºCntr = 11
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_11", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_11", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_11_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_11", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_12_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_12", 2)
    If TB_Und_Tipologia_12.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_12.Value = CDbl(TB_Und_Tipologia_12.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_12_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_12", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_12_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_12", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_12_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_12", 2)
    If TB_M²_Tipologia_12.Value <> "" Then TB_VGV_Tipologia_12.Value = Format(Round(TB_ValorM²_Tipologia_12 * TB_M²_Tipologia_12.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_12.Value <> "" And TB_Fator_Tipologia_12.Value <> "" And TB_M²_D_Tipologia_12.Value <> "" Then TB_VGV_Tipologia_12.Value = Format(Round(TB_ValorM²_Tipologia_12 * TB_M²_Tipologia_12.Value, 2) + Round(TB_ValorM²_Tipologia_12 * TB_M²_D_Tipologia_12.Value * CDbl((Replace(TB_Fator_Tipologia_12.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_12", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_12_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_12", 5)
    If TB_M²_Tipologia_12.Value <> "" And TB_Fator_Tipologia_12.Value <> "" And TB_M²_D_Tipologia_12.Value <> "" Then TB_VGV_Tipologia_12.Value = Format(Round(TB_ValorM²_Tipologia_12 * TB_M²_Tipologia_12.Value, 2) + Round(TB_ValorM²_Tipologia_12 * TB_M²_D_Tipologia_12.Value * CDbl((Replace(TB_Fator_Tipologia_12.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_12_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_12", 2)
    If TB_M²_Tipologia_12.Value <> "" And TB_Fator_Tipologia_12.Value <> "" And TB_M²_D_Tipologia_12.Value <> "" Then TB_VGV_Tipologia_12.Value = Format(Round(TB_ValorM²_Tipologia_12 * TB_M²_Tipologia_12.Value, 2) + Round(TB_ValorM²_Tipologia_12 * TB_M²_D_Tipologia_12.Value * CDbl((Replace(TB_Fator_Tipologia_12.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_12_AfterUpdate()
    ºCntr = 12
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_12", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_12", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_12_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_12", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_13_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_13", 2)
    If TB_Und_Tipologia_13.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_13.Value = CDbl(TB_Und_Tipologia_13.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_13_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_13", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_13_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_13", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_13_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_13", 2)
    If TB_M²_Tipologia_13.Value <> "" Then TB_VGV_Tipologia_13.Value = Format(Round(TB_ValorM²_Tipologia_13 * TB_M²_Tipologia_13.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_13.Value <> "" And TB_Fator_Tipologia_13.Value <> "" And TB_M²_D_Tipologia_13.Value <> "" Then TB_VGV_Tipologia_13.Value = Format(Round(TB_ValorM²_Tipologia_13 * TB_M²_Tipologia_13.Value, 2) + Round(TB_ValorM²_Tipologia_13 * TB_M²_D_Tipologia_13.Value * CDbl((Replace(TB_Fator_Tipologia_13.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_13", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_13_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_13", 5)
    If TB_M²_Tipologia_13.Value <> "" And TB_Fator_Tipologia_13.Value <> "" And TB_M²_D_Tipologia_13.Value <> "" Then TB_VGV_Tipologia_13.Value = Format(Round(TB_ValorM²_Tipologia_13 * TB_M²_Tipologia_13.Value, 2) + Round(TB_ValorM²_Tipologia_13 * TB_M²_D_Tipologia_13.Value * CDbl((Replace(TB_Fator_Tipologia_13.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_13_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_13", 2)
    If TB_M²_Tipologia_13.Value <> "" And TB_Fator_Tipologia_13.Value <> "" And TB_M²_D_Tipologia_13.Value <> "" Then TB_VGV_Tipologia_13.Value = Format(Round(TB_ValorM²_Tipologia_13 * TB_M²_Tipologia_13.Value, 2) + Round(TB_ValorM²_Tipologia_13 * TB_M²_D_Tipologia_13.Value * CDbl((Replace(TB_Fator_Tipologia_13.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_13_AfterUpdate()
    ºCntr = 13
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_13", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_13", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_13_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_13", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_14_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_14", 2)
    If TB_Und_Tipologia_14.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_14.Value = CDbl(TB_Und_Tipologia_14.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_14_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_14", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_14_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_14", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_14_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_14", 2)
    If TB_M²_Tipologia_14.Value <> "" Then TB_VGV_Tipologia_14.Value = Format(Round(TB_ValorM²_Tipologia_14 * TB_M²_Tipologia_14.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_14.Value <> "" And TB_Fator_Tipologia_14.Value <> "" And TB_M²_D_Tipologia_14.Value <> "" Then TB_VGV_Tipologia_14.Value = Format(Round(TB_ValorM²_Tipologia_14 * TB_M²_Tipologia_14.Value, 2) + Round(TB_ValorM²_Tipologia_14 * TB_M²_D_Tipologia_14.Value * CDbl((Replace(TB_Fator_Tipologia_14.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_14", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_14_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_14", 5)
    If TB_M²_Tipologia_14.Value <> "" And TB_Fator_Tipologia_14.Value <> "" And TB_M²_D_Tipologia_14.Value <> "" Then TB_VGV_Tipologia_14.Value = Format(Round(TB_ValorM²_Tipologia_14 * TB_M²_Tipologia_14.Value, 2) + Round(TB_ValorM²_Tipologia_14 * TB_M²_D_Tipologia_14.Value * CDbl((Replace(TB_Fator_Tipologia_14.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_14_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_14", 2)
    If TB_M²_Tipologia_14.Value <> "" And TB_Fator_Tipologia_14.Value <> "" And TB_M²_D_Tipologia_14.Value <> "" Then TB_VGV_Tipologia_14.Value = Format(Round(TB_ValorM²_Tipologia_14 * TB_M²_Tipologia_14.Value, 2) + Round(TB_ValorM²_Tipologia_14 * TB_M²_D_Tipologia_14.Value * CDbl((Replace(TB_Fator_Tipologia_14.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_14_AfterUpdate()
    ºCntr = 14
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_14", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_14", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_14_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_14", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_15_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_15", 2)
    If TB_Und_Tipologia_15.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_15.Value = CDbl(TB_Und_Tipologia_15.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_15_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_15", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_15_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_15", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_15_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_15", 2)
    If TB_M²_Tipologia_15.Value <> "" Then TB_VGV_Tipologia_15.Value = Format(Round(TB_ValorM²_Tipologia_15 * TB_M²_Tipologia_15.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_15.Value <> "" And TB_Fator_Tipologia_15.Value <> "" And TB_M²_D_Tipologia_15.Value <> "" Then TB_VGV_Tipologia_15.Value = Format(Round(TB_ValorM²_Tipologia_15 * TB_M²_Tipologia_15.Value, 2) + Round(TB_ValorM²_Tipologia_15 * TB_M²_D_Tipologia_15.Value * CDbl((Replace(TB_Fator_Tipologia_15.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_15", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_15_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_15", 5)
    If TB_M²_Tipologia_15.Value <> "" And TB_Fator_Tipologia_15.Value <> "" And TB_M²_D_Tipologia_15.Value <> "" Then TB_VGV_Tipologia_15.Value = Format(Round(TB_ValorM²_Tipologia_15 * TB_M²_Tipologia_15.Value, 2) + Round(TB_ValorM²_Tipologia_15 * TB_M²_D_Tipologia_15.Value * CDbl((Replace(TB_Fator_Tipologia_15.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_15_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_15", 2)
    If TB_M²_Tipologia_15.Value <> "" And TB_Fator_Tipologia_15.Value <> "" And TB_M²_D_Tipologia_15.Value <> "" Then TB_VGV_Tipologia_15.Value = Format(Round(TB_ValorM²_Tipologia_15 * TB_M²_Tipologia_15.Value, 2) + Round(TB_ValorM²_Tipologia_15 * TB_M²_D_Tipologia_15.Value * CDbl((Replace(TB_Fator_Tipologia_15.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_15_AfterUpdate()
    ºCntr = 15
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_15", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_15", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_15_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_15", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_16_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_16", 2)
    If TB_Und_Tipologia_16.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_16.Value = CDbl(TB_Und_Tipologia_16.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_16_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_16", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_16_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_16", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_16_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_16", 2)
    If TB_M²_Tipologia_16.Value <> "" Then TB_VGV_Tipologia_16.Value = Format(Round(TB_ValorM²_Tipologia_16 * TB_M²_Tipologia_16.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_16.Value <> "" And TB_Fator_Tipologia_16.Value <> "" And TB_M²_D_Tipologia_16.Value <> "" Then TB_VGV_Tipologia_16.Value = Format(Round(TB_ValorM²_Tipologia_16 * TB_M²_Tipologia_16.Value, 2) + Round(TB_ValorM²_Tipologia_16 * TB_M²_D_Tipologia_16.Value * CDbl((Replace(TB_Fator_Tipologia_16.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_16", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_16_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_16", 5)
    If TB_M²_Tipologia_16.Value <> "" And TB_Fator_Tipologia_16.Value <> "" And TB_M²_D_Tipologia_16.Value <> "" Then TB_VGV_Tipologia_16.Value = Format(Round(TB_ValorM²_Tipologia_16 * TB_M²_Tipologia_16.Value, 2) + Round(TB_ValorM²_Tipologia_16 * TB_M²_D_Tipologia_16.Value * CDbl((Replace(TB_Fator_Tipologia_16.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_16_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_16", 2)
    If TB_M²_Tipologia_16.Value <> "" And TB_Fator_Tipologia_16.Value <> "" And TB_M²_D_Tipologia_16.Value <> "" Then TB_VGV_Tipologia_16.Value = Format(Round(TB_ValorM²_Tipologia_16 * TB_M²_Tipologia_16.Value, 2) + Round(TB_ValorM²_Tipologia_16 * TB_M²_D_Tipologia_16.Value * CDbl((Replace(TB_Fator_Tipologia_16.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_16_AfterUpdate()
    ºCntr = 16
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_16", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_16", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_16_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_16", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_17_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_17", 2)
    If TB_Und_Tipologia_17.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_17.Value = CDbl(TB_Und_Tipologia_17.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_17_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_17", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_17_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_17", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_17_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_17", 2)
    If TB_M²_Tipologia_17.Value <> "" Then TB_VGV_Tipologia_17.Value = Format(Round(TB_ValorM²_Tipologia_17 * TB_M²_Tipologia_17.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_17.Value <> "" And TB_Fator_Tipologia_17.Value <> "" And TB_M²_D_Tipologia_17.Value <> "" Then TB_VGV_Tipologia_17.Value = Format(Round(TB_ValorM²_Tipologia_17 * TB_M²_Tipologia_17.Value, 2) + Round(TB_ValorM²_Tipologia_17 * TB_M²_D_Tipologia_17.Value * CDbl((Replace(TB_Fator_Tipologia_17.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_17", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_17_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_17", 5)
    If TB_M²_Tipologia_17.Value <> "" And TB_Fator_Tipologia_17.Value <> "" And TB_M²_D_Tipologia_17.Value <> "" Then TB_VGV_Tipologia_17.Value = Format(Round(TB_ValorM²_Tipologia_17 * TB_M²_Tipologia_17.Value, 2) + Round(TB_ValorM²_Tipologia_17 * TB_M²_D_Tipologia_17.Value * CDbl((Replace(TB_Fator_Tipologia_17.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_17_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_17", 2)
    If TB_M²_Tipologia_17.Value <> "" And TB_Fator_Tipologia_17.Value <> "" And TB_M²_D_Tipologia_17.Value <> "" Then TB_VGV_Tipologia_17.Value = Format(Round(TB_ValorM²_Tipologia_17 * TB_M²_Tipologia_17.Value, 2) + Round(TB_ValorM²_Tipologia_17 * TB_M²_D_Tipologia_17.Value * CDbl((Replace(TB_Fator_Tipologia_17.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_17_AfterUpdate()
    ºCntr = 17
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_17", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_17", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_17_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_17", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_18_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_18", 2)
    If TB_Und_Tipologia_18.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_18.Value = CDbl(TB_Und_Tipologia_18.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_18_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_18", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_18_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_18", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_18_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_18", 2)
    If TB_M²_Tipologia_18.Value <> "" Then TB_VGV_Tipologia_18.Value = Format(Round(TB_ValorM²_Tipologia_18 * TB_M²_Tipologia_18.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_18.Value <> "" And TB_Fator_Tipologia_18.Value <> "" And TB_M²_D_Tipologia_18.Value <> "" Then TB_VGV_Tipologia_18.Value = Format(Round(TB_ValorM²_Tipologia_18 * TB_M²_Tipologia_18.Value, 2) + Round(TB_ValorM²_Tipologia_18 * TB_M²_D_Tipologia_18.Value * CDbl((Replace(TB_Fator_Tipologia_18.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_18", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_18_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_18", 5)
    If TB_M²_Tipologia_18.Value <> "" And TB_Fator_Tipologia_18.Value <> "" And TB_M²_D_Tipologia_18.Value <> "" Then TB_VGV_Tipologia_18.Value = Format(Round(TB_ValorM²_Tipologia_18 * TB_M²_Tipologia_18.Value, 2) + Round(TB_ValorM²_Tipologia_18 * TB_M²_D_Tipologia_18.Value * CDbl((Replace(TB_Fator_Tipologia_18.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_18_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_18", 2)
    If TB_M²_Tipologia_18.Value <> "" And TB_Fator_Tipologia_18.Value <> "" And TB_M²_D_Tipologia_18.Value <> "" Then TB_VGV_Tipologia_18.Value = Format(Round(TB_ValorM²_Tipologia_18 * TB_M²_Tipologia_18.Value, 2) + Round(TB_ValorM²_Tipologia_18 * TB_M²_D_Tipologia_18.Value * CDbl((Replace(TB_Fator_Tipologia_18.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_18_AfterUpdate()
    ºCntr = 18
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_18", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_18", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_18_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_18", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_19_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_19", 2)
    If TB_Und_Tipologia_19.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_19.Value = CDbl(TB_Und_Tipologia_19.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_19_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_19", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_19_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_19", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_19_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_19", 2)
    If TB_M²_Tipologia_19.Value <> "" Then TB_VGV_Tipologia_19.Value = Format(Round(TB_ValorM²_Tipologia_19 * TB_M²_Tipologia_19.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_19.Value <> "" And TB_Fator_Tipologia_19.Value <> "" And TB_M²_D_Tipologia_19.Value <> "" Then TB_VGV_Tipologia_19.Value = Format(Round(TB_ValorM²_Tipologia_19 * TB_M²_Tipologia_19.Value, 2) + Round(TB_ValorM²_Tipologia_19 * TB_M²_D_Tipologia_19.Value * CDbl((Replace(TB_Fator_Tipologia_19.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_19", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_19_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_19", 5)
    If TB_M²_Tipologia_19.Value <> "" And TB_Fator_Tipologia_19.Value <> "" And TB_M²_D_Tipologia_19.Value <> "" Then TB_VGV_Tipologia_19.Value = Format(Round(TB_ValorM²_Tipologia_19 * TB_M²_Tipologia_19.Value, 2) + Round(TB_ValorM²_Tipologia_19 * TB_M²_D_Tipologia_19.Value * CDbl((Replace(TB_Fator_Tipologia_19.Value, "%", "")) / 100), 2), "#,##0.00")
     If Eventos = True Then
        Call ATT_P_cap
    End If
   Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_19_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_19", 2)
    If TB_M²_Tipologia_19.Value <> "" And TB_Fator_Tipologia_19.Value <> "" And TB_M²_D_Tipologia_19.Value <> "" Then TB_VGV_Tipologia_19.Value = Format(Round(TB_ValorM²_Tipologia_19 * TB_M²_Tipologia_19.Value, 2) + Round(TB_ValorM²_Tipologia_19 * TB_M²_D_Tipologia_19.Value * CDbl((Replace(TB_Fator_Tipologia_19.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_19_AfterUpdate()
    ºCntr = 19
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_19", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_19", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_19_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_19", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_20_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_20", 2)
    If TB_Und_Tipologia_20.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_20.Value = CDbl(TB_Und_Tipologia_20.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_20_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_20", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_20_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_20", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_20_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_20", 2)
    If TB_M²_Tipologia_20.Value <> "" Then TB_VGV_Tipologia_20.Value = Format(Round(TB_ValorM²_Tipologia_20 * TB_M²_Tipologia_20.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_20.Value <> "" And TB_Fator_Tipologia_20.Value <> "" And TB_M²_D_Tipologia_20.Value <> "" Then TB_VGV_Tipologia_20.Value = Format(Round(TB_ValorM²_Tipologia_20 * TB_M²_Tipologia_20.Value, 2) + Round(TB_ValorM²_Tipologia_20 * TB_M²_D_Tipologia_20.Value * CDbl((Replace(TB_Fator_Tipologia_20.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_20", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_20_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_20", 5)
    If TB_M²_Tipologia_20.Value <> "" And TB_Fator_Tipologia_20.Value <> "" And TB_M²_D_Tipologia_20.Value <> "" Then TB_VGV_Tipologia_20.Value = Format(Round(TB_ValorM²_Tipologia_20 * TB_M²_Tipologia_20.Value, 2) + Round(TB_ValorM²_Tipologia_20 * TB_M²_D_Tipologia_20.Value * CDbl((Replace(TB_Fator_Tipologia_20.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_20_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_20", 2)
    If TB_M²_Tipologia_20.Value <> "" And TB_Fator_Tipologia_20.Value <> "" And TB_M²_D_Tipologia_20.Value <> "" Then TB_VGV_Tipologia_20.Value = Format(Round(TB_ValorM²_Tipologia_20 * TB_M²_Tipologia_20.Value, 2) + Round(TB_ValorM²_Tipologia_20 * TB_M²_D_Tipologia_20.Value * CDbl((Replace(TB_Fator_Tipologia_20.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_20_AfterUpdate()
    ºCntr = 20
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_20", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_20", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_20_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_20", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_21_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_21", 2)
    If TB_Und_Tipologia_21.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_21.Value = CDbl(TB_Und_Tipologia_21.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_21_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_21", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_21_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_21", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_21_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_21", 2)
    If TB_M²_Tipologia_21.Value <> "" Then TB_VGV_Tipologia_21.Value = Format(Round(TB_ValorM²_Tipologia_21 * TB_M²_Tipologia_21.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_21.Value <> "" And TB_Fator_Tipologia_21.Value <> "" And TB_M²_D_Tipologia_21.Value <> "" Then TB_VGV_Tipologia_21.Value = Format(Round(TB_ValorM²_Tipologia_21 * TB_M²_Tipologia_21.Value, 2) + Round(TB_ValorM²_Tipologia_21 * TB_M²_D_Tipologia_21.Value * CDbl((Replace(TB_Fator_Tipologia_21.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_21", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_21_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_21", 5)
    If TB_M²_Tipologia_21.Value <> "" And TB_Fator_Tipologia_21.Value <> "" And TB_M²_D_Tipologia_21.Value <> "" Then TB_VGV_Tipologia_21.Value = Format(Round(TB_ValorM²_Tipologia_21 * TB_M²_Tipologia_21.Value, 2) + Round(TB_ValorM²_Tipologia_21 * TB_M²_D_Tipologia_21.Value * CDbl((Replace(TB_Fator_Tipologia_21.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_21_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_21", 2)
    If TB_M²_Tipologia_21.Value <> "" And TB_Fator_Tipologia_21.Value <> "" And TB_M²_D_Tipologia_21.Value <> "" Then TB_VGV_Tipologia_21.Value = Format(Round(TB_ValorM²_Tipologia_21 * TB_M²_Tipologia_21.Value, 2) + Round(TB_ValorM²_Tipologia_21 * TB_M²_D_Tipologia_21.Value * CDbl((Replace(TB_Fator_Tipologia_21.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_21_AfterUpdate()
    ºCntr = 21
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_21", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_21", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_21_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_21", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_22_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_22", 2)
    If TB_Und_Tipologia_22.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_22.Value = CDbl(TB_Und_Tipologia_22.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_22_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_22", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_22_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_22", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_22_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_22", 2)
    If TB_M²_Tipologia_22.Value <> "" Then TB_VGV_Tipologia_22.Value = Format(Round(TB_ValorM²_Tipologia_22 * TB_M²_Tipologia_22.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_22.Value <> "" And TB_Fator_Tipologia_22.Value <> "" And TB_M²_D_Tipologia_22.Value <> "" Then TB_VGV_Tipologia_22.Value = Format(Round(TB_ValorM²_Tipologia_22 * TB_M²_Tipologia_22.Value, 2) + Round(TB_ValorM²_Tipologia_22 * TB_M²_D_Tipologia_22.Value * CDbl((Replace(TB_Fator_Tipologia_22.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_22", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_22_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_22", 5)
    If TB_M²_Tipologia_22.Value <> "" And TB_Fator_Tipologia_22.Value <> "" And TB_M²_D_Tipologia_22.Value <> "" Then TB_VGV_Tipologia_22.Value = Format(Round(TB_ValorM²_Tipologia_22 * TB_M²_Tipologia_22.Value, 2) + Round(TB_ValorM²_Tipologia_22 * TB_M²_D_Tipologia_22.Value * CDbl((Replace(TB_Fator_Tipologia_22.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_22_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_22", 2)
    If TB_M²_Tipologia_22.Value <> "" And TB_Fator_Tipologia_22.Value <> "" And TB_M²_D_Tipologia_22.Value <> "" Then TB_VGV_Tipologia_22.Value = Format(Round(TB_ValorM²_Tipologia_22 * TB_M²_Tipologia_22.Value, 2) + Round(TB_ValorM²_Tipologia_22 * TB_M²_D_Tipologia_22.Value * CDbl((Replace(TB_Fator_Tipologia_22.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_22_AfterUpdate()
    ºCntr = 22
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_22", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_22", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_22_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_22", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_23_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_23", 2)
    If TB_Und_Tipologia_23.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_23.Value = CDbl(TB_Und_Tipologia_23.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_23_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_23", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_23_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_23", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_23_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_23", 2)
    If TB_M²_Tipologia_23.Value <> "" Then TB_VGV_Tipologia_23.Value = Format(Round(TB_ValorM²_Tipologia_23 * TB_M²_Tipologia_23.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_23.Value <> "" And TB_Fator_Tipologia_23.Value <> "" And TB_M²_D_Tipologia_23.Value <> "" Then TB_VGV_Tipologia_23.Value = Format(Round(TB_ValorM²_Tipologia_23 * TB_M²_Tipologia_23.Value, 2) + Round(TB_ValorM²_Tipologia_23 * TB_M²_D_Tipologia_23.Value * CDbl((Replace(TB_Fator_Tipologia_23.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_23", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_23_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_23", 5)
    If TB_M²_Tipologia_23.Value <> "" And TB_Fator_Tipologia_23.Value <> "" And TB_M²_D_Tipologia_23.Value <> "" Then TB_VGV_Tipologia_23.Value = Format(Round(TB_ValorM²_Tipologia_23 * TB_M²_Tipologia_23.Value, 2) + Round(TB_ValorM²_Tipologia_23 * TB_M²_D_Tipologia_23.Value * CDbl((Replace(TB_Fator_Tipologia_23.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_23_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_23", 2)
    If TB_M²_Tipologia_23.Value <> "" And TB_Fator_Tipologia_23.Value <> "" And TB_M²_D_Tipologia_23.Value <> "" Then TB_VGV_Tipologia_23.Value = Format(Round(TB_ValorM²_Tipologia_23 * TB_M²_Tipologia_23.Value, 2) + Round(TB_ValorM²_Tipologia_23 * TB_M²_D_Tipologia_23.Value * CDbl((Replace(TB_Fator_Tipologia_23.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_23_AfterUpdate()
    ºCntr = 23
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_23", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_23", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_23_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_23", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_24_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_24", 2)
    If TB_Und_Tipologia_24.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_24.Value = CDbl(TB_Und_Tipologia_24.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_24_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_24", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_24_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_24", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_24_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_24", 2)
    If TB_M²_Tipologia_24.Value <> "" Then TB_VGV_Tipologia_24.Value = Format(Round(TB_ValorM²_Tipologia_24 * TB_M²_Tipologia_24.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_24.Value <> "" And TB_Fator_Tipologia_24.Value <> "" And TB_M²_D_Tipologia_24.Value <> "" Then TB_VGV_Tipologia_24.Value = Format(Round(TB_ValorM²_Tipologia_24 * TB_M²_Tipologia_24.Value, 2) + Round(TB_ValorM²_Tipologia_24 * TB_M²_D_Tipologia_24.Value * CDbl((Replace(TB_Fator_Tipologia_24.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_24", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_24_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_24", 5)
    If TB_M²_Tipologia_24.Value <> "" And TB_Fator_Tipologia_24.Value <> "" And TB_M²_D_Tipologia_24.Value <> "" Then TB_VGV_Tipologia_24.Value = Format(Round(TB_ValorM²_Tipologia_24 * TB_M²_Tipologia_24.Value, 2) + Round(TB_ValorM²_Tipologia_24 * TB_M²_D_Tipologia_24.Value * CDbl((Replace(TB_Fator_Tipologia_24.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_24_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_24", 2)
    If TB_M²_Tipologia_24.Value <> "" And TB_Fator_Tipologia_24.Value <> "" And TB_M²_D_Tipologia_24.Value <> "" Then TB_VGV_Tipologia_24.Value = Format(Round(TB_ValorM²_Tipologia_24 * TB_M²_Tipologia_24.Value, 2) + Round(TB_ValorM²_Tipologia_24 * TB_M²_D_Tipologia_24.Value * CDbl((Replace(TB_Fator_Tipologia_24.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_24_AfterUpdate()
    ºCntr = 24
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_24", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_24", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_24_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_24", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_25_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_25", 2)
    If TB_Und_Tipologia_25.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_25.Value = CDbl(TB_Und_Tipologia_25.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_25_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_25", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_25_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_25", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_25_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_25", 2)
    If TB_M²_Tipologia_25.Value <> "" Then TB_VGV_Tipologia_25.Value = Format(Round(TB_ValorM²_Tipologia_25 * TB_M²_Tipologia_25.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_25.Value <> "" And TB_Fator_Tipologia_25.Value <> "" And TB_M²_D_Tipologia_25.Value <> "" Then TB_VGV_Tipologia_25.Value = Format(Round(TB_ValorM²_Tipologia_25 * TB_M²_Tipologia_25.Value, 2) + Round(TB_ValorM²_Tipologia_25 * TB_M²_D_Tipologia_25.Value * CDbl((Replace(TB_Fator_Tipologia_25.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_25", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_25_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_25", 5)
    If TB_M²_Tipologia_25.Value <> "" And TB_Fator_Tipologia_25.Value <> "" And TB_M²_D_Tipologia_25.Value <> "" Then TB_VGV_Tipologia_25.Value = Format(Round(TB_ValorM²_Tipologia_25 * TB_M²_Tipologia_25.Value, 2) + Round(TB_ValorM²_Tipologia_25 * TB_M²_D_Tipologia_25.Value * CDbl((Replace(TB_Fator_Tipologia_25.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_25_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_25", 2)
    If TB_M²_Tipologia_25.Value <> "" And TB_Fator_Tipologia_25.Value <> "" And TB_M²_D_Tipologia_25.Value <> "" Then TB_VGV_Tipologia_25.Value = Format(Round(TB_ValorM²_Tipologia_25 * TB_M²_Tipologia_25.Value, 2) + Round(TB_ValorM²_Tipologia_25 * TB_M²_D_Tipologia_25.Value * CDbl((Replace(TB_Fator_Tipologia_25.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_25_AfterUpdate()
    ºCntr = 25
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_25", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_25", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_25_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_25", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_26_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_26", 2)
    If TB_Und_Tipologia_26.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_26.Value = CDbl(TB_Und_Tipologia_26.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_26_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_26", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_26_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_26", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_26_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_26", 2)
    If TB_M²_Tipologia_26.Value <> "" Then TB_VGV_Tipologia_26.Value = Format(Round(TB_ValorM²_Tipologia_26 * TB_M²_Tipologia_26.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_26.Value <> "" And TB_Fator_Tipologia_26.Value <> "" And TB_M²_D_Tipologia_26.Value <> "" Then TB_VGV_Tipologia_26.Value = Format(Round(TB_ValorM²_Tipologia_26 * TB_M²_Tipologia_26.Value, 2) + Round(TB_ValorM²_Tipologia_26 * TB_M²_D_Tipologia_26.Value * CDbl((Replace(TB_Fator_Tipologia_26.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_26", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_26_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_26", 5)
    If TB_M²_Tipologia_26.Value <> "" And TB_Fator_Tipologia_26.Value <> "" And TB_M²_D_Tipologia_26.Value <> "" Then TB_VGV_Tipologia_26.Value = Format(Round(TB_ValorM²_Tipologia_26 * TB_M²_Tipologia_26.Value, 2) + Round(TB_ValorM²_Tipologia_26 * TB_M²_D_Tipologia_26.Value * CDbl((Replace(TB_Fator_Tipologia_26.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_26_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_26", 2)
    If TB_M²_Tipologia_26.Value <> "" And TB_Fator_Tipologia_26.Value <> "" And TB_M²_D_Tipologia_26.Value <> "" Then TB_VGV_Tipologia_26.Value = Format(Round(TB_ValorM²_Tipologia_26 * TB_M²_Tipologia_26.Value, 2) + Round(TB_ValorM²_Tipologia_26 * TB_M²_D_Tipologia_26.Value * CDbl((Replace(TB_Fator_Tipologia_26.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_26_AfterUpdate()
    ºCntr = 26
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_26", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_26", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_26_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_26", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_27_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_27", 2)
    If TB_Und_Tipologia_27.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_27.Value = CDbl(TB_Und_Tipologia_27.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_27_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_27", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_27_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_27", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_27_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_27", 2)
    If TB_M²_Tipologia_27.Value <> "" Then TB_VGV_Tipologia_27.Value = Format(Round(TB_ValorM²_Tipologia_27 * TB_M²_Tipologia_27.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_27.Value <> "" And TB_Fator_Tipologia_27.Value <> "" And TB_M²_D_Tipologia_27.Value <> "" Then TB_VGV_Tipologia_27.Value = Format(Round(TB_ValorM²_Tipologia_27 * TB_M²_Tipologia_27.Value, 2) + Round(TB_ValorM²_Tipologia_27 * TB_M²_D_Tipologia_27.Value * CDbl((Replace(TB_Fator_Tipologia_27.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_27", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_27_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_27", 5)
    If TB_M²_Tipologia_27.Value <> "" And TB_Fator_Tipologia_27.Value <> "" And TB_M²_D_Tipologia_27.Value <> "" Then TB_VGV_Tipologia_27.Value = Format(Round(TB_ValorM²_Tipologia_27 * TB_M²_Tipologia_27.Value, 2) + Round(TB_ValorM²_Tipologia_27 * TB_M²_D_Tipologia_27.Value * CDbl((Replace(TB_Fator_Tipologia_27.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_27_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_27", 2)
    If TB_M²_Tipologia_27.Value <> "" And TB_Fator_Tipologia_27.Value <> "" And TB_M²_D_Tipologia_27.Value <> "" Then TB_VGV_Tipologia_27.Value = Format(Round(TB_ValorM²_Tipologia_27 * TB_M²_Tipologia_27.Value, 2) + Round(TB_ValorM²_Tipologia_27 * TB_M²_D_Tipologia_27.Value * CDbl((Replace(TB_Fator_Tipologia_27.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_27_AfterUpdate()
    ºCntr = 27
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_27", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_27", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_27_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_27", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_28_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_28", 2)
    If TB_Und_Tipologia_28.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_28.Value = CDbl(TB_Und_Tipologia_28.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_28_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_28", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_28_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_28", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_28_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_28", 2)
    If TB_M²_Tipologia_28.Value <> "" Then TB_VGV_Tipologia_28.Value = Format(Round(TB_ValorM²_Tipologia_28 * TB_M²_Tipologia_28.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_28.Value <> "" And TB_Fator_Tipologia_28.Value <> "" And TB_M²_D_Tipologia_28.Value <> "" Then TB_VGV_Tipologia_28.Value = Format(Round(TB_ValorM²_Tipologia_28 * TB_M²_Tipologia_28.Value, 2) + Round(TB_ValorM²_Tipologia_28 * TB_M²_D_Tipologia_28.Value * CDbl((Replace(TB_Fator_Tipologia_28.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_28", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_28_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_28", 5)
    If TB_M²_Tipologia_28.Value <> "" And TB_Fator_Tipologia_28.Value <> "" And TB_M²_D_Tipologia_28.Value <> "" Then TB_VGV_Tipologia_28.Value = Format(Round(TB_ValorM²_Tipologia_28 * TB_M²_Tipologia_28.Value, 2) + Round(TB_ValorM²_Tipologia_28 * TB_M²_D_Tipologia_28.Value * CDbl((Replace(TB_Fator_Tipologia_28.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_28_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_28", 2)
    If TB_M²_Tipologia_28.Value <> "" And TB_Fator_Tipologia_28.Value <> "" And TB_M²_D_Tipologia_28.Value <> "" Then TB_VGV_Tipologia_28.Value = Format(Round(TB_ValorM²_Tipologia_28 * TB_M²_Tipologia_28.Value, 2) + Round(TB_ValorM²_Tipologia_28 * TB_M²_D_Tipologia_28.Value * CDbl((Replace(TB_Fator_Tipologia_28.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_28_AfterUpdate()
    ºCntr = 28
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_28", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_28", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_28_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_28", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_29_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_29", 2)
    If TB_Und_Tipologia_29.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_29.Value = CDbl(TB_Und_Tipologia_29.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_29_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_29", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_29_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_29", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_29_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_29", 2)
    If TB_M²_Tipologia_29.Value <> "" Then TB_VGV_Tipologia_29.Value = Format(Round(TB_ValorM²_Tipologia_29 * TB_M²_Tipologia_29.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_29.Value <> "" And TB_Fator_Tipologia_29.Value <> "" And TB_M²_D_Tipologia_29.Value <> "" Then TB_VGV_Tipologia_29.Value = Format(Round(TB_ValorM²_Tipologia_29 * TB_M²_Tipologia_29.Value, 2) + Round(TB_ValorM²_Tipologia_29 * TB_M²_D_Tipologia_29.Value * CDbl((Replace(TB_Fator_Tipologia_29.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_29", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_29_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_29", 5)
    If TB_M²_Tipologia_29.Value <> "" And TB_Fator_Tipologia_29.Value <> "" And TB_M²_D_Tipologia_29.Value <> "" Then TB_VGV_Tipologia_29.Value = Format(Round(TB_ValorM²_Tipologia_29 * TB_M²_Tipologia_29.Value, 2) + Round(TB_ValorM²_Tipologia_29 * TB_M²_D_Tipologia_29.Value * CDbl((Replace(TB_Fator_Tipologia_29.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_29_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_29", 2)
    If TB_M²_Tipologia_29.Value <> "" And TB_Fator_Tipologia_29.Value <> "" And TB_M²_D_Tipologia_29.Value <> "" Then TB_VGV_Tipologia_29.Value = Format(Round(TB_ValorM²_Tipologia_29 * TB_M²_Tipologia_29.Value, 2) + Round(TB_ValorM²_Tipologia_29 * TB_M²_D_Tipologia_29.Value * CDbl((Replace(TB_Fator_Tipologia_29.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_29_AfterUpdate()
    ºCntr = 29
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_29", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_29", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_29_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_29", 0)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Tipologia_30_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Tipologia_30", 2)
    If TB_Und_Tipologia_30.Value <> "" Then
        If Me.CB_FX_PERMUT = True Then TB_Permt_Tipologia_30.Value = CDbl(TB_Und_Tipologia_30.Value) * CDbl((Replace(TB_Percent_Permuta.Value, "%", "")) / 100)
        Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_1", 2)
    End If
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Tipologia_30_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Tipologia_30", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'METRAGEM
Private Sub TB_M²_Tipologia_30_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_Tipologia_30", 5)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR M²
Private Sub TB_ValorM²_Tipologia_30_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_30", 2)
    If TB_M²_Tipologia_30.Value <> "" Then TB_VGV_Tipologia_30.Value = Format(Round(TB_ValorM²_Tipologia_30 * TB_M²_Tipologia_30.Value, 2), "#,##0.00")
    If TB_M²_Tipologia_30.Value <> "" And TB_Fator_Tipologia_30.Value <> "" And TB_M²_D_Tipologia_30.Value <> "" Then TB_VGV_Tipologia_30.Value = Format(Round(TB_ValorM²_Tipologia_30 * TB_M²_Tipologia_30.Value, 2) + Round(TB_ValorM²_Tipologia_30 * TB_M²_D_Tipologia_30.Value * CDbl((Replace(TB_Fator_Tipologia_30.Value, "%", "")) / 100), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_30", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'AREA DESCOBERTA
Private Sub TB_M²_D_Tipologia_30_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_M²_D_Tipologia_30", 5)
    If TB_M²_Tipologia_30.Value <> "" And TB_Fator_Tipologia_30.Value <> "" And TB_M²_D_Tipologia_30.Value <> "" Then TB_VGV_Tipologia_30.Value = Format(Round(TB_ValorM²_Tipologia_30 * TB_M²_Tipologia_30.Value, 2) + Round(TB_ValorM²_Tipologia_30 * TB_M²_D_Tipologia_30.Value * CDbl((Replace(TB_Fator_Tipologia_30.Value, "%", "")) / 100), 2), "#,##0.00")
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'FATOR AREA DESCOBERTA
Private Sub TB_Fator_Tipologia_30_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Fator_Tipologia_30", 2)
    If TB_M²_Tipologia_30.Value <> "" And TB_Fator_Tipologia_30.Value <> "" And TB_M²_D_Tipologia_30.Value <> "" Then TB_VGV_Tipologia_30.Value = Format(Round(TB_ValorM²_Tipologia_30 * TB_M²_Tipologia_30.Value, 2) + Round(TB_ValorM²_Tipologia_30 * TB_M²_D_Tipologia_30.Value * CDbl((Replace(TB_Fator_Tipologia_30.Value, "%", "")) / 100), 2), "#,##0.00")
    Call CarregarTotais
End Sub
'VGV TOTAL TIPOLOGIA
Private Sub TB_VGV_Tipologia_30_AfterUpdate()
    ºCntr = 30
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Tipologia_30", 2)
    If Controls("TB_M²_Tipologia_" & ºCntr).Value > 0 Then Controls("TB_ValorM²_Tipologia_" & ºCntr).Value = Controls("TB_VGV_Tipologia_" & ºCntr).Value / (Controls("TB_M²_Tipologia_" & ºCntr).Value + (Controls("TB_M²_D_Tipologia_" & ºCntr).Value * ((1 + Replace(Controls("TB_Fator_Tipologia_" & ºCntr).Value, "%", "") - 1) / 100)))
    Call FormatarNumCur("CadastroUnidades", "TB_ValorM²_Tipologia_30", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VAGAS VINCULADAS
Private Sub TB_Vagas_Tipologia_30_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Vagas_Tipologia_30", 0)
End Sub
'----------------------------------------------------------------------------------------------------------------------------------------------------
'\\//\\//\\//\\//\\//\\//\\//\\//\\ VAGAS EXTRAS //\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\//\\/
'----------------------------------------------------------------------------------------------------------------------------------------------------

'ATIVO
Private Sub CB_Vaga_1_Click()
    Call Mostrar_Vaga(1)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Vaga_1_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Vaga_1", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Vaga_1_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Vaga_1", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR VAGA
Private Sub TB_VGV_Vaga_1_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_1", 2)
    If TB_VGV_Vaga_1.Value <> "" And TB_Und_Vaga_1.Value <> "" Then TB_TT_VGV_Vaga_1.Value = Format(Round(TB_VGV_Vaga_1.Value * (TB_Und_Vaga_1.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_1", 2)
    Call CarregarTotais
End Sub
'VALOR TOTAL VAGAS FASE
Private Sub TB_TT_VGV_Vaga_1_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_TT_VGV_Vaga_1", 2)
    If TB_Und_Vaga_1.Value <> "" And TB_TT_VGV_Vaga_1 <> "" Then TB_VGV_Vaga_1.Value = Format(Round(TB_TT_VGV_Vaga_1 / (TB_Und_Vaga_1.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_1", 2)
    Call CarregarTotais
End Sub

'_________________________________________________________________________________________________________________________________

'ATIVO
Private Sub CB_Vaga_2_Click()
    Call Mostrar_Vaga(2)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Vaga_2_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Vaga_2", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Vaga_2_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Vaga_2", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR VAGA
Private Sub TB_VGV_Vaga_2_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_2", 2)
    If TB_VGV_Vaga_2.Value <> "" And TB_Und_Vaga_2.Value <> "" Then TB_TT_VGV_Vaga_2.Value = Format(Round(TB_VGV_Vaga_2.Value * (TB_Und_Vaga_2.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_2", 2)
    Call CarregarTotais
End Sub
'VALOR TOTAL VAGAS FASE
Private Sub TB_TT_VGV_Vaga_2_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_TT_VGV_Vaga_2", 2)
    If TB_Und_Vaga_2.Value <> "" And TB_TT_VGV_Vaga_2 <> "" Then TB_VGV_Vaga_2.Value = Format(Round(TB_TT_VGV_Vaga_2 / (TB_Und_Vaga_2.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_2", 2)
    Call CarregarTotais
End Sub

'_________________________________________________________________________________________________________________________________

'ATIVO
Private Sub CB_Vaga_3_Click()
    Call Mostrar_Vaga(3)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Vaga_3_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Vaga_3", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Vaga_3_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Vaga_3", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR VAGA
Private Sub TB_VGV_Vaga_3_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_3", 2)
    If TB_VGV_Vaga_3.Value <> "" And TB_Und_Vaga_3.Value <> "" Then TB_TT_VGV_Vaga_3.Value = Format(Round(TB_VGV_Vaga_3.Value * (TB_Und_Vaga_3.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_3", 2)
    Call CarregarTotais
End Sub
'VALOR TOTAL VAGAS FASE
Private Sub TB_TT_VGV_Vaga_3_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_TT_VGV_Vaga_3", 2)
    If TB_Und_Vaga_3.Value <> "" And TB_TT_VGV_Vaga_3 <> "" Then TB_VGV_Vaga_3.Value = Format(Round(TB_TT_VGV_Vaga_3 / (TB_Und_Vaga_3.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_3", 2)
    Call CarregarTotais
End Sub

'_________________________________________________________________________________________________________________________________

'ATIVO
Private Sub CB_Vaga_4_Click()
    Call Mostrar_Vaga(4)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Vaga_4_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Vaga_4", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Vaga_4_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Vaga_4", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR VAGA
Private Sub TB_VGV_Vaga_4_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_4", 2)
    If TB_VGV_Vaga_4.Value <> "" And TB_Und_Vaga_4.Value <> "" Then TB_TT_VGV_Vaga_4.Value = Format(Round(TB_VGV_Vaga_4.Value * (TB_Und_Vaga_4.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_4", 2)
    Call CarregarTotais
End Sub
'VALOR TOTAL VAGAS FASE
Private Sub TB_TT_VGV_Vaga_4_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_TT_VGV_Vaga_4", 2)
    If TB_Und_Vaga_4.Value <> "" And TB_TT_VGV_Vaga_4 <> "" Then TB_VGV_Vaga_4.Value = Format(Round(TB_TT_VGV_Vaga_4 / (TB_Und_Vaga_4.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_4", 2)
    Call CarregarTotais
End Sub

'_________________________________________________________________________________________________________________________________

'ATIVO
Private Sub CB_Vaga_5_Click()
    Call Mostrar_Vaga(5)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Vaga_5_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Vaga_5", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Vaga_5_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Vaga_5", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR VAGA
Private Sub TB_VGV_Vaga_5_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_5", 2)
    If TB_VGV_Vaga_5.Value <> "" And TB_Und_Vaga_5.Value <> "" Then TB_TT_VGV_Vaga_5.Value = Format(Round(TB_VGV_Vaga_5.Value * (TB_Und_Vaga_5.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_5", 2)
    Call CarregarTotais
End Sub
'VALOR TOTAL VAGAS FASE
Private Sub TB_TT_VGV_Vaga_5_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_TT_VGV_Vaga_5", 2)
    If TB_Und_Vaga_5.Value <> "" Then TB_VGV_Vaga_5.Value = Format(Round(TB_TT_VGV_Vaga_5 / (TB_Und_Vaga_5.Value - TB_Permt_Vaga_5.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_5", 2)
    Call CarregarTotais
End Sub

'_________________________________________________________________________________________________________________________________

'ATIVO
Private Sub CB_Vaga_6_Click()
    Call Mostrar_Vaga(6)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Vaga_6_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Vaga_6", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Vaga_6_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Vaga_6", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR VAGA
Private Sub TB_VGV_Vaga_6_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_6", 2)
    If TB_VGV_Vaga_6.Value <> "" And TB_Und_Vaga_6.Value <> "" Then TB_TT_VGV_Vaga_6.Value = Format(Round(TB_VGV_Vaga_6.Value * (TB_Und_Vaga_6.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_6", 2)
    Call CarregarTotais
End Sub
'VALOR TOTAL VAGAS FASE
Private Sub TB_TT_VGV_Vaga_6_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_TT_VGV_Vaga_6", 2)
    If TB_Und_Vaga_6.Value <> "" And TB_TT_VGV_Vaga_6 <> "" Then TB_VGV_Vaga_6.Value = Format(Round(TB_TT_VGV_Vaga_6 / (TB_Und_Vaga_6.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_6", 2)
    Call CarregarTotais
End Sub
'ATIVO
Private Sub CB_Vaga_7_Click()
    Call Mostrar_Vaga(7)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Vaga_7_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Vaga_7", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Vaga_7_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Vaga_7", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR VAGA
Private Sub TB_VGV_Vaga_7_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_7", 2)
    If TB_VGV_Vaga_7.Value <> "" And TB_Und_Vaga_7.Value <> "" Then TB_TT_VGV_Vaga_7.Value = Format(Round(TB_VGV_Vaga_7.Value * (TB_Und_Vaga_7.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_7", 2)
    Call CarregarTotais
End Sub
'VALOR TOTAL VAGAS FASE
Private Sub TB_TT_VGV_Vaga_7_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_TT_VGV_Vaga_7", 2)
    If TB_Und_Vaga_7.Value <> "" And TB_TT_VGV_Vaga_7 <> "" Then TB_VGV_Vaga_7.Value = Format(Round(TB_TT_VGV_Vaga_7 / (TB_Und_Vaga_7.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_7", 2)
    Call CarregarTotais
End Sub

'_________________________________________________________________________________________________________________________________

'ATIVO
Private Sub CB_Vaga_8_Click()
    Call Mostrar_Vaga(8)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Vaga_8_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Vaga_8", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Vaga_8_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Vaga_8", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR VAGA
Private Sub TB_VGV_Vaga_8_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_8", 2)
    If TB_VGV_Vaga_8.Value <> "" And TB_Und_Vaga_8.Value <> "" Then TB_TT_VGV_Vaga_8.Value = Format(Round(TB_VGV_Vaga_8.Value * (TB_Und_Vaga_8.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_8", 2)
    Call CarregarTotais
End Sub
'VALOR TOTAL VAGAS FASE
Private Sub TB_TT_VGV_Vaga_8_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_TT_VGV_Vaga_8", 2)
    If TB_Und_Vaga_8.Value <> "" And TB_TT_VGV_Vaga_8 <> "" Then TB_VGV_Vaga_8.Value = Format(Round(TB_TT_VGV_Vaga_8 / (TB_Und_Vaga_8.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_8", 2)
    Call CarregarTotais
End Sub

'_________________________________________________________________________________________________________________________________

'ATIVO
Private Sub CB_Vaga_9_Click()
    Call Mostrar_Vaga(9)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Vaga_9_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Vaga_9", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'NUMERO DE PERMUTAS
Private Sub TB_Permt_Vaga_9_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Permt_Vaga_9", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR VAGA
Private Sub TB_VGV_Vaga_9_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_9", 2)
    If TB_VGV_Vaga_9.Value <> "" And TB_Und_Vaga_9.Value <> "" Then TB_TT_VGV_Vaga_9.Value = Format(Round(TB_VGV_Vaga_9.Value * (TB_Und_Vaga_9.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_9", 2)
    Call CarregarTotais
End Sub
'VALOR TOTAL VAGAS FASE
Private Sub TB_TT_VGV_Vaga_9_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_TT_VGV_Vaga_9", 2)
    If TB_Und_Vaga_9.Value <> "" And TB_TT_VGV_Vaga_9 <> "" Then TB_VGV_Vaga_9.Value = Format(Round(TB_TT_VGV_Vaga_9 / (TB_Und_Vaga_9.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_9", 2)
    Call CarregarTotais
End Sub

'_________________________________________________________________________________________________________________________________

'ATIVO
Private Sub CB_Vaga_10_Click()
    Call Mostrar_Vaga(10)
End Sub
'NUMERO DE UNIDADES
Private Sub TB_Und_Vaga_10_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Und_Vaga_10", 2)
    If Eventos = True Then
        Call ATT_P_cap
    End If
    Call CarregarTotais
End Sub
'VALOR VAGA
Private Sub TB_VGV_Vaga_10_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_10", 2)
    If TB_VGV_Vaga_10.Value <> "" And TB_Und_Vaga_10.Value <> "" Then TB_TT_VGV_Vaga_10.Value = Format(Round(TB_VGV_Vaga_10.Value * (TB_Und_Vaga_10.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_10", 2)
    Call CarregarTotais
End Sub
'VALOR TOTAL VAGAS FASE
Private Sub TB_TT_VGV_Vaga_10_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_TT_VGV_Vaga_10", 2)
    If TB_Und_Vaga_10.Value <> "" And TB_TT_VGV_Vaga_10 <> "" Then TB_VGV_Vaga_10.Value = Format(Round(TB_TT_VGV_Vaga_10 / (TB_Und_Vaga_10.Value - TB_Permt_Vaga_10.Value), 2), "#,##0.00")
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Vaga_10", 2)
    Call CarregarTotais
End Sub

'##################################### CADASTRO PERFIS DE VENDA #################################################
'---------------------------------------------------------------------------------------------------------------
'Carregar tabela Selecionada
Private Sub CB_Select_Tbl_CHANGE()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If LIST_Perfil_Venda.ListItems.Count > 0 Then
        Dim ºTBL, ºCod As Double
        'If Me.CB_Select_Tbl.Value = "" Then Exit Sub
        If Me.CB_Select_Tbl.Value > 0 And Me.CB_Select_Tbl.Value <> "" Then
            ºTBL = CDbl(Replace(Left(Me.CB_Select_Tbl.Value, 3), " |", ""))
            ºCod = ºTBL + 107
            Call Carregar_Tabela_Selecionada(ºCod)
            If MP_TBL_VND.Value = 0 Then
                If LIST_Perfil_Venda.ListItems.Count > 0 Then
                    ºCod = LIST_Perfil_Venda.SelectedItem
                    ºL = Application.IfError(Application.Match(CDbl(ºCod), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
                    ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & ºL + 900).Value = CB_Select_Tbl.Value
                    Call Carregar_PRF_VND(CInt(ºL))
                Else
                    Call Carregar_PRF_VND(0)
                End If
            Else
                If LIST_Perfil_Venda.ListItems.Count > 0 Then
                    ºCod = LIST_Perfil_Venda.SelectedItem
                    ºL = Application.IfError(Application.Match(CDbl(ºCod), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
                    ThisWorkbook.Sheets("BD_CAD_VND").Range("E" & ºL + 900).Value = CB_Select_Tbl.Value
                    Call Carregar_PRF_VND(CInt(ºL))
                Else
                    Call Carregar_PRF_VND(0)
                End If
            End If
            
            BT_ERASE_TBL.Enabled = True
            BT_COPY_TBL.Enabled = True
            BT_EDIT_TBL.Enabled = True
            LiberarCampos
        Else
            CadastroUnidades.List_Tabela.ListItems.Clear
            BT_ERASE_TBL.Enabled = False
            BT_COPY_TBL.Enabled = False
            BT_EDIT_TBL.Enabled = False
            Call TravarCampos
        End If
    Else
        CadastroUnidades.List_Tabela.ListItems.Clear
        BT_ERASE_TBL.Enabled = False
        BT_COPY_TBL.Enabled = False
        BT_EDIT_TBL.Enabled = False
        Call TravarCampos
    End If
End Sub
'Nome Tabela de Venda
Private Sub TB_Tbl_Name_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    If Me.CB_Select_Tbl.Value <> "" Then
    ºTBL = CDbl(Replace(Left(Me.CB_Select_Tbl.Value, 3), " |", ""))
    ºCod = ºTBL + 107
    '---------------------------------------------------------  NOME  ---------------------------------------------------------------------------------------------------------------------------------
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºCod, 2).Value = TB_Tbl_Name.Value
    CB_Select_Tbl.Clear
    ºLTBL = ThisWorkbook.Sheets("BD_CAD_VND").Cells(157, 2).End(xlUp).Row
    For ºLTBL_2 = 108 To ºLTBL
        CB_Select_Tbl.AddItem ºLTBL_2 - 107 & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLTBL_2, 2).Value
    Next
    CB_Select_Tbl.Value = CB_Select_Tbl.List(ºTBL - 1)
    LiberarCampos
    End If
End Sub
'Inicio da Parcela
Private Sub TB_Inicio_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
   
   VINCULO.OK.Caption = "TB_Inicio"
    VINCULO.OptionButton2.Enabled = False
    Call VINCULO.Abrir
    VINCULO.Show
End Sub
Private Sub TB_Inicio_change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Application.EnableEvents = False
    If Application.IfError(Application.Search("OBR", TB_Inicio), 0) = 0 Then
        Call FormatarNumCur("CadastroUnidades", "TB_Inicio", 0)
    End If
    Application.EnableEvents = True
End Sub
'Inicio de Juros
Private Sub TB_Inicio_Juros_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    VINCULO.OK.Caption = "TB_Inicio_Juros"
    VINCULO.OptionButton2.Enabled = False
    Call VINCULO.Abrir
    VINCULO.Show
End Sub
Private Sub TB_Inicio_Juros_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Application.EnableEvents = False
    If Application.IfError(Application.Search("OBR", TB_Inicio_Juros), 0) = 0 Then
        Call FormatarNumCur("CadastroUnidades", "TB_Inicio_Juros", 0)
    End If
    Application.EnableEvents = True
End Sub
'% do VGV da unidade
Private Sub TB_Percent_VGV_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_Percent_VGV", 2)
End Sub
'Quantidade de Parcelas
Private Sub TB_Quantidade_Change()
    Application.EnableEvents = False
    Call FormatarNumCur("CadastroUnidades", "TB_Quantidade", 0)
    Application.EnableEvents = True
End Sub
'Ultima Parcela
Private Sub TB_Ultimo_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    VINCULO.OK.Caption = "TB_Ultimo"
    VINCULO.OptionButton2.Enabled = False
    Call VINCULO.Abrir
    VINCULO.Show
End Sub
Private Sub TB_Ultimo_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Application.EnableEvents = False
    If Application.IfError(Application.Search("OBR", TB_Ultimo), 0) = 0 Then
        Call FormatarNumCur("CadastroUnidades", "TB_Ultimo", 0)
    End If
    Application.EnableEvents = True
End Sub
'Adicionar Parcela Tabela de Venda
Private Sub Add_Click()
    Dim ºErro1, ºErro2 As Boolean
     'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
        
    If Me.CB_TP_PARCELA.Value <> "" And Me.TB_Quantidade.Value <> "" And Me.TB_Inicio.Value <> "" _
        And Me.TB_Percent_VGV.Value <> "" And Me.CB_Cobrar_Juros.Value <> "" And TB_Inicio_Juros.Value <> "" _
        And Me.CB_FX_INICIO.Value <> "" And Me.CB_FX_FIM.Value <> "" And Me.TB_Ultimo.Value <> "" Then
        Dim ºInicio_Repasse As Integer
        ºperfil = LIST_Perfil_Venda.SelectedItem
        ºErro1 = False
        ºErro2 = False
         List_Tabela.Enabled = True
       
        '--------------------------------------------------------------------------------------
        '                                      Tipologias
        '--------------------------------------------------------------------------------------
        For ºL = 3 To 32
            'VERIFICAR JUROS ANTES DO REPASSE
            ºInicio_Repasse = 9999
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("n" & ºL).Value = FormatDouble(ºperfil) Then
                ºFASE = ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºL).Value
                For Each ºLi In Me.List_Tabela.ListItems
                    If Add.Caption = "Editar" Then
                        If ºEdição(2) <> ºLi.Index Then
                            If ºLi = "Repasse" And DIF_DT_LCTO(ºLi.SubItems(2), CInt(ºFASE)) < ºInicio_Repasse Then ºInicio_Repasse = DIF_DT_LCTO(ºLi.SubItems(2), CInt(ºFASE))
                        End If
                    Else
                        If ºLi = "Repasse" And DIF_DT_LCTO(ºLi.SubItems(2), CInt(ºFASE)) < ºInicio_Repasse Then ºInicio_Repasse = DIF_DT_LCTO(ºLi.SubItems(2), CInt(ºFASE))
                    End If
                Next
                If Add.Caption = "Editar" Then
                    If CB_TP_PARCELA.Value = "Repasse" And DIF_DT_LCTO(TB_Inicio.Value, CInt(ºFASE)) < ºInicio_Repasse Then ºInicio_Repasse = DIF_DT_LCTO(TB_Inicio, CInt(ºFASE))
                End If
                If Me.CB_Cobrar_Juros.Value = "Sim" And DIF_DT_LCTO(TB_Inicio_Juros.Value, CInt(ºFASE)) < ºInicio_Repasse And ºInicio_Repasse <> 9999 Then
                    MsgBox "A cobrança de juros esta iniciando antes do repasse!!!!"
                    Exit Sub
                End If
                'VERIFICAR JUROS ANTES DO VENCIMENTO
                If Me.CB_Cobrar_Juros.Value = "Sim" And DIF_DT_LCTO(TB_Inicio_Juros.Value, CInt(ºFASE)) < DIF_DT_LCTO(TB_Inicio.Value, CInt(ºFASE)) Then
                    If Not ºErro2 Then
                        If MsgBox("A cobrança de juros esta iniciando antes do vencimento da parcela!!!!" & Chr(10) & Chr(10) & "Deseja continuar?", vbYesNo) = vbNo Then
                            Exit Sub
                        Else
                            ºErro2 = True
                        End If
                    End If
                End If
            End If
        Next
        
        '--------------------------------------------------------------------------------------
        '                                      Vagas
        '--------------------------------------------------------------------------------------
        For ºL = 35 To 54
            'VERIFICAR JUROS ANTES DO REPASSE
            ºInicio_Repasse = 9999
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("H" & ºL).Value = FormatDouble(ºperfil) Then
                ºFASE = ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºL).Value
                For Each ºLi In Me.List_Tabela.ListItems
                    If Add.Caption = "Editar" Then
                        If ºEdição(2) <> ºLi.Index Then
                            If ºLi = "Repasse" And DIF_DT_LCTO(ºLi.SubItems(2), CInt(ºFASE)) < ºInicio_Repasse Then ºInicio_Repasse = DIF_DT_LCTO(ºLi.SubItems(2), CInt(ºFASE))
                        End If
                    Else
                        If ºLi = "Repasse" And DIF_DT_LCTO(ºLi.SubItems(2), CInt(ºFASE)) < ºInicio_Repasse Then ºInicio_Repasse = DIF_DT_LCTO(ºLi.SubItems(2), CInt(ºFASE))
                    End If
                Next
                If Add.Caption = "Editar" Then
                    If CB_TP_PARCELA.Value = "Repasse" And DIF_DT_LCTO(TB_Inicio.Value, CInt(ºFASE)) < ºInicio_Repasse Then ºInicio_Repasse = DIF_DT_LCTO(TB_Inicio, CInt(ºFASE))
                End If
                If Me.CB_Cobrar_Juros.Value = "Sim" And DIF_DT_LCTO(TB_Inicio_Juros.Value, CInt(ºFASE)) < ºInicio_Repasse Then
                    MsgBox "A cobrança de juros esta iniciando antes do repasse!!!!"
                    Exit Sub
                End If
                'VERIFICAR JUROS ANTES DO VENCIMENTO
                If Me.CB_Cobrar_Juros.Value = "Sim" And DIF_DT_LCTO(TB_Inicio_Juros.Value, CInt(ºFASE)) < DIF_DT_LCTO(TB_Inicio.Value, CInt(ºFASE)) Then
                    If Not ºErro2 Then
                        If MsgBox("A cobrança de juros esta iniciando antes do vencimento da parcela!!!!" & Chr(10) & Chr(10) & "Deseja continuar?", vbYesNo) = vbNo Then
                            Exit Sub
                        Else
                            ºErro2 = True
                        End If
                    End If
                End If
            End If
        Next
        
        
        If Add.Caption = "Editar" Then
            '---------------------------------------------------------  TIPO  ---------------------------------------------------------------------------------------------------------------------------------
            Set Li = CadastroUnidades.List_Tabela.ListItems(ºEdição(2))
            Li.Text = CB_TP_PARCELA.Value
            '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
            Li.SubItems(1) = Me.TB_Quantidade.Value
            '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(2) = Me.TB_Inicio.Value
            '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(3) = Me.TB_Percent_VGV.Text
            '---------------------------------------------------------  JUROS  -------------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(4) = Me.CB_Cobrar_Juros.Value
            '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
            Li.SubItems(5) = TB_Inicio_Juros.Value
            '---------------------------------------------------------  FIXAR INICIO  ----------------------------------------------------------------------------------------------------------------------
            Li.SubItems(6) = Me.CB_FX_INICIO.Value
            '---------------------------------------------------------  FIXAR FIM  --------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(7) = Me.CB_FX_FIM.Value
            '---------------------------------------------------------  MES FIM  ------------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(8) = Me.TB_Ultimo.Value
            '-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
            ºEdição(1) = ""
            ºEdição(2) = ""
            ºEdição(3) = ""
        Else
            '---------------------------------------------------------  TIPO  ---------------------------------------------------------------------------------------------------------------------------------
            Set Li = CadastroUnidades.List_Tabela.ListItems.Add(, , Me.CB_TP_PARCELA.Value)
            '---------------------------------------------------------  QUANTIDADE   -------------------------------------------------------------------------------------------------------------------
            Li.SubItems(1) = Me.TB_Quantidade.Value
            '---------------------------------------------------------  INICIO  -------------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(2) = Me.TB_Inicio.Value
            '---------------------------------------------------------  % DO VGV  --------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(3) = Me.TB_Percent_VGV.Text
            '---------------------------------------------------------  JUROS  -------------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(4) = Me.CB_Cobrar_Juros.Value
            '---------------------------------------------------------  INICIO JUROS  ----------------------------------------------------------------------------------------------------------------------
            Li.SubItems(5) = TB_Inicio_Juros.Value
            '---------------------------------------------------------  FIXAR INICIO  ----------------------------------------------------------------------------------------------------------------------
            Li.SubItems(6) = Me.CB_FX_INICIO.Value
            '---------------------------------------------------------  FIXAR FIM  --------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(7) = Me.CB_FX_FIM.Value
            '---------------------------------------------------------  MES FIM  ------------------------------------------------------------------------------------------------------------------------------
            Li.SubItems(8) = Me.TB_Ultimo.Value
            '-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
            ºEdição(1) = ""
            ºEdição(2) = ""
            ºEdição(3) = ""
        End If
        Call OrganizarParcelas
        Call CheckPercent
        Call Atulizar_Tbl_BD
        
        Add.Caption = ""
        List_Tabela.Top = 264
        List_Tabela.Height = 132
        
        Me.CB_TP_PARCELA.Value = ""
        Me.TB_Quantidade.Value = ""
        Me.TB_Inicio.Value = ""
        Me.TB_Percent_VGV.Value = ""
        Me.CB_Cobrar_Juros.Value = ""
        TB_Inicio_Juros.Value = ""
        Me.CB_FX_INICIO.Value = ""
        Me.CB_FX_FIM.Value = ""
        Me.TB_Ultimo.Value = ""
        CadastroUnidades.ADD_ROW_TBL_VND.Enabled = True
        CadastroUnidades.EDIT_ROW_TBL_VND.Enabled = True
        CadastroUnidades.COPY_ROW_TBL_VND.Enabled = True
        CadastroUnidades.DEL_ROW_TBL_VND.Enabled = True
    Else
        MsgBox ("todos campos devem ser preenchidos!!!")
    End If
End Sub


'Copiar Tabela
Private Sub BT_COPY_TBL_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Dim ºTBL, ºCod As Double
    If Me.CB_Select_Tbl.Value = "" Then Exit Sub
    If Me.CB_Select_Tbl.Value > 0 Then
        ºTBL = CDbl(Replace(Left(Me.CB_Select_Tbl.Value, 3), " |", ""))
        ºCod = ºTBL + 107
        If ºCod = 0 Then Exit Sub
        ºLVel = ThisWorkbook.Sheets("BD_CAD_VND").Cells(157, 2).End(xlUp).Row
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLVel + 1 & ":FZ" & ºLVel + 1).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºCod & ":FZ" & ºCod).Value
        ºLTBL = ThisWorkbook.Sheets("BD_CAD_VND").Cells(157, 2).End(xlUp).Row
        Me.CB_Select_Tbl.Clear
        For ºLTBL_2 = 108 To ºLTBL
            CadastroUnidades.CB_Select_Tbl.AddItem ºLTBL_2 - 107 & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLTBL_2, 2).Value
        Next
        Me.CB_Select_Tbl.Value = ºLVel - 106 & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel + 1, 2).Value
        Application.EnableEvents = True
        LiberarCampos
    End If
End Sub
'Nova Tabela
Private Sub BT_NEW_TBL_Click()
    SelecionarTabela.Show False
    'Me.Show
End Sub
'Salvar tabela no banco de dados
Private Sub BT_EDIT_TBL_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If MsgBox("Deseja adicionar a tabela ao Banco de Dados?", vbYesNo) = vbYes Then
        ºTBL = CDbl(Replace(Left(Me.CB_Select_Tbl.Value, 3), " |", ""))
        ºL = ºTBL + 107
        
        If ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, 2).Value <> "" Then
        
            ºVALORES = SelectMatriz("bd_tabelas_de_venda", "id_tabela, descricao", "", "id_tabela DESC", 2)
            
            If ºVALORES(0, 0) <> "VAZIO" Then
                id_tabela = Format(CDbl(ºVALORES(0, 0)) + 1, "00000")
            Else
                id_tabela = Format(CDbl(ºVALORES(0, 0)) + 1, "00000")
            End If
            
            'DESCRIÇÃO
            ºDESCRICAO = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, 2).Value
            For ºC = 3 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, Columns.Count).End(xlToLeft).Column - 8 Step 9
                'TIPO
                ºTipo = Format(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value, "00000")
                'QUANTIDADE
                ºQUANTIDADE = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC + 1).Value
                'INICIO
                ºINICIO = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC + 2).Value
                'PERCENTUAL
                ºPERCENTUAL = Replace(ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC + 3).Value, ",", ".")
                'JUROS
                ºJuros = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC + 4).Value
                'INICIO JUROS
                ºINIJuros = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC + 5).Value
                'FIXAR INICIO
                ºFXini = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC + 6).Value
                'FIXAR ULTIMA
                ºFXFim = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC + 7).Value
                'MES ULTIMA
                ºULTIMA = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC + 8).Value
                
                ºvalor = "'" & id_tabela & "', '" & ºDESCRICAO & "', '" & ºTipo & "', " & ºQUANTIDADE & ", '" & ºINICIO & "', " & ºPERCENTUAL _
                        & ", " & ºJuros & ", '" & ºINIJuros & "', " & ºFXini & ", " & ºFXFim & ", '" & ºULTIMA & "'"
                InsertMatriz "bd_tabelas_de_venda", Replace(CAMPOS_TBL_VENDA, "id_chave_estudo, ", ""), CStr(ºvalor)
            Next
        End If
    End If
End Sub
'Deletar Tabela
Private Sub BT_ERASE_TBL_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If MsgBox("Confirma a Exclusão? ", vbYesNo, "") = vbYes Then
        If Me.CB_Select_Tbl.Value > 0 Then
            ºTBL = CDbl(Replace(Left(Me.CB_Select_Tbl.Value, 3), " |", ""))
            ºCod = ºTBL + 107
            ºLTBL = ThisWorkbook.Sheets("BD_CAD_VND").Cells(157, 2).End(xlUp).Row
            For ºLTBL_2 = 108 To ºLTBL
                ThisWorkbook.Sheets("BD_CAD_VND").Range("A" & ºLTBL_2) = ºLTBL_2 - 107
            Next
            If ºCod = 0 Then Exit Sub
            ThisWorkbook.Sheets("BD_CAD_VND").Range(ºCod & ":" & ºCod).ClearContents
            For ºL = 901 To 950 Step 1
                If Me.CB_Select_Tbl.Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & ºL).Value Then ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & ºL).ClearContents
                If Me.CB_Select_Tbl.Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("E" & ºL).Value Then ThisWorkbook.Sheets("BD_CAD_VND").Range("E" & ºL).ClearContents
            Next
            ºLVel = ThisWorkbook.Sheets("BD_CAD_VND").Cells(157, 2).End(xlUp).Row
            If ThisWorkbook.Sheets("BD_CAD_VND").AutoFilterMode = True Then ThisWorkbook.Sheets("BD_CAD_VND").AutoFilterMode = False
            ThisWorkbook.Sheets("BD_CAD_VND").Range("A107:FZ" & ºLVel).AutoFilter
            ThisWorkbook.Worksheets("BD_CAD_VND").AutoFilter.Sort.SortFields.Add Key:=Range("A107:A" & ºLVel), SortOn:=xlSortOnValues, Order:=xlAscending
            With ThisWorkbook.Worksheets("BD_CAD_VND").AutoFilter.Sort
                .Header = xlYes
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
            For ºTBL = 108 To ThisWorkbook.Sheets("BD_CAD_VND").Cells(157, 2).End(xlUp).Row
                If ThisWorkbook.Worksheets("BD_CAD_VND").Range("A" & ºTBL).Value <> ºTBL - 107 Then
                    For ºL = 901 To 950 Step 1
                        If ThisWorkbook.Worksheets("BD_CAD_VND").Range("A" & ºTBL).Value & " | " & ThisWorkbook.Worksheets("BD_CAD_VND").Range("B" & ºTBL).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & ºL).Value Then
                            ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & ºL).Value = ºTBL - 107 & " | " & ThisWorkbook.Worksheets("BD_CAD_VND").Range("B" & ºTBL).Value
                        End If
                        If ThisWorkbook.Worksheets("BD_CAD_VND").Range("A" & ºTBL).Value & " | " & ThisWorkbook.Worksheets("BD_CAD_VND").Range("B" & ºTBL).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("E" & ºL).Value Then
                            ThisWorkbook.Sheets("BD_CAD_VND").Range("E" & ºL).Value = ºTBL - 107 & " | " & ThisWorkbook.Worksheets("BD_CAD_VND").Range("B" & ºTBL).Value
                        End If
                    Next
                End If
            Next
            Application.EnableEvents = False
            Me.CB_Select_Tbl.Clear
            Me.LB_ParcentualAtingido.Caption = ""
            ºLTBL = ThisWorkbook.Sheets("BD_CAD_VND").Cells(157, 2).End(xlUp).Row
            For ºLTBL_2 = 108 To ºLTBL
                CadastroUnidades.CB_Select_Tbl.AddItem ºLTBL_2 - 107 & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLTBL_2, 2).Value
            Next
            If LIST_Perfil_Venda.ListItems.Count > 0 Then
                ºCod = LIST_Perfil_Venda.SelectedItem
                ºL = Application.IfError(Application.Match(CDbl(ºCod), ThisWorkbook.Sheets("BD_CAD_VND").Range("A901:A950"), 0), 0)
                Call Carregar_PRF_VND(CInt(ºL))
            End If
            Application.EnableEvents = True
            Me.List_Tabela.ListItems.Clear
            Call TravarCampos
        End If
    End If
End Sub

'Nova Curva de Venda
Private Sub BT_New_Velocidade_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºLVel = ThisWorkbook.Sheets("BD_CAD_VND").Cells(106, 2).End(xlUp).Row
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLVel + 1).Value = "Nova Curva"
    Me.LB_codigo.Caption = "Curva " & ºLVel - 55 & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLVel + 1).Value & " Selecionada"
    Call LimparVel
    Me.LIST_Velocidade.ListItems.Clear
    Me.LIST_Velocidade.ColumnHeaders.Clear
    'Call CarregarVelocidades
    Call LiberarCampoV
    Call ATT_Percentual_vel
End Sub
'Salvar Curva de Venda
Private Sub BT_Save_Velocidade_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºlIN = 56 + Me.LIST_Perfil_Venda.SelectedItem.SubItems(2)
    'Call ATTbdVel(ºlIN + 56)
    If TB_Percentual_1 <> "" And TB_DURACAO_1 <> "" And TB_BGN_1 <> "" Then
        LIST_Velocidade.Enabled = True
        If BT_Save_Velocidade.HelpContextID = 0 Then
            ºC = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, Columns.Count).End(xlToLeft).Column + 1
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, ºC).Value = Replace(TB_Percentual_1, "%", "") / 100
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, ºC + 1).Value = TB_BGN_1
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, ºC + 2).Value = CDbl(TB_DURACAO_1)
        Else
            Me.LIST_Velocidade.ListItems.Remove (Me.LIST_Velocidade.SelectedItem.Index)
            ºLVel = BT_Save_Velocidade.HelpContextID
            BT_Save_Velocidade.HelpContextID = 0
            ThisWorkbook.Sheets("BD_CAD_VND").Range(ºLVel & ":" & ºLVel).Value = ""
            ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLVel).Value = Me.LIST_Perfil_Venda.SelectedItem.SubItems(2)
            For Each ºLi In Me.LIST_Velocidade.ListItems
                ºC = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, Columns.Count).End(xlToLeft).Column + 1
                 ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, ºC).Value = ºLi 'Replace(ºLi, ",", ".")
                 ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, ºC + 2).Value = ºLi.SubItems(1)
                 ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, ºC + 1).Value = ºLi.SubItems(2)
            Next
            ºC = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, Columns.Count).End(xlToLeft).Column + 1
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, ºC).Value = Replace(TB_Percentual_1, "%", "") / 100
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, ºC + 1).Value = TB_BGN_1
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºlIN, ºC + 2).Value = TB_DURACAO_1
        End If
        Call CarregarVelocidades(Me.LIST_Perfil_Venda.SelectedItem)
        ºLVel = Application.Match(CDbl(Me.LIST_Perfil_Venda.SelectedItem.SubItems(2)), ThisWorkbook.Sheets("BD_CAD_VND").Range("B57:B105"), 0) + 56
        ThisWorkbook.Sheets("BD_CAD_VND").Range(ºLVel & ":" & ºLVel).Value = ""
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLVel).Value = Me.LIST_Perfil_Venda.SelectedItem.SubItems(2)
        Me.LIST_Velocidade.Sorted = True
        Me.LIST_Velocidade.SortKey = 1
        Me.LIST_Velocidade.SortOrder = lvwAscending
        For Each ºLi In Me.LIST_Velocidade.ListItems
            ºC = ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, Columns.Count).End(xlToLeft).Column + 1
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, ºC).Value = ºLi 'Replace(ºLi, ",", ".")
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, ºC + 2).Value = ºLi.SubItems(1)
            ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºLVel, ºC + 1).Value = ºLi.SubItems(2)
        Next
        TB_Percentual_1.Value = ""
        TB_BGN_1.Value = ""
        TB_DURACAO_1.Value = ""
        Me.LIST_Velocidade.ListItems.Clear
        Me.LIST_Velocidade.ColumnHeaders.Clear
        Call CarregarVelocidades(Me.LIST_Perfil_Venda.SelectedItem)
        TB_Percentual_1.Enabled = False
        TB_DURACAO_1.Enabled = False
        TB_BGN_1.Enabled = False
        BT_Save_Velocidade.Enabled = False
        BT_cancel_Velocidade.Enabled = False
        ADD_ROW_CRV_VND.Enabled = True
        DEL_ROW_CRV_VND.Enabled = True
        
        LIST_Velocidade.Height = 120
        LIST_Velocidade.Top = 30
        Call ATT_Percentual_vel
    End If
End Sub
'Percentual velocidade 1
Private Sub TB_Percentual_1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Application.EnableEvents = False
        If TB_Percentual_1.Value <> "" Then
            If Application.IfError(Application.Search("%", TB_Percentual_1.Value), 0) = 0 Then TB_Percentual_1.Value = TB_Percentual_1.Value & "%"
        End If
    Application.EnableEvents = True
End Sub

'##################################### PERFIL DO PROJETO ######################################################
'---------------------------------------------------------------------------------------------------------------

Private Sub TB_CUSTO_P_TAXAS_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_P_TAXAS", 2)
    Call TotaisObra_2
End Sub

'-----------------------------------------------------------------------------------------------------------------------
'                              TAXAS FINANCEIRAS
'-----------------------------------------------------------------------------------------------------------------------
'Selecionar Perfil
Private Sub CB_Select_Prf_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºLin1 = ThisWorkbook.Sheets("BD_CAD_VND").Cells(208, 3).End(xlUp).Row
    For ºL = 159 To ºLin1
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value = False
    Next
    lIN = CDbl(Left(CB_Select_Prf.Value, Application.Search("|", CB_Select_Prf.Value) - 2))
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & lIN + 158).Value = True
    Call CarregarPerfil
End Sub
'Salvar Alterações Perfil
Private Sub SalvarPerfil()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºCheck = True
    If TB_Descrição_Perfil.Value = "" Then TB_Descrição_Perfil.Value = "Perfil Editado"
    If OB_RET.Value Then
        If TB_TX_RET.Value = "" Then TB_TX_RET.Value = "0,00%"
    Else
        If TB_TX_IRCSLL.Value = "" Then TB_TX_IRCSLL.Value = "0,00%"
        If TB_TX_PISCOFINS.Value = "" Then TB_TX_PISCOFINS.Value = "0,00%"
    End If
    If TB_CMSS_INT.Value = "" Then TB_CMSS_INT.Value = "0,00%"
    If TB_CMSS_DIR.Value = "" Then TB_CMSS_DIR.Value = "0,00%"
    If TB_MKTG.Value = "" Then TB_MKTG.Value = "0,00%"
    If TB_PDV.Value = "" Then TB_PDV.Value = "0,00%"
    'If TB_Condominio.Value = "" Then ºCheck = False
    'If TB_IPTU.Value = "" Then ºCheck = False
    'If CB_FTR_Condominio.Value = "" Then ºCheck = False
    'If CB_FTR_IPTU.Value = "" Then ºCheck = False
    If TB_TX_VP.Value = "" Then TB_TX_VP.Value = "0,00%"
    If TB_ADM_CARTEIRA.Value = "" Then TB_ADM_CARTEIRA.Value = "0,00%"
    Call DescarregarPerfil
    Call CarregarPerfil
End Sub
'Novo Perfil
Private Sub BT_NEW_PRF_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºLin1 = ThisWorkbook.Sheets("BD_CAD_VND").Cells(208, 3).End(xlUp).Row + 1
    For ºL = 159 To ºLin1
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value = False
    Next
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLin1).Value = True
    TB_Descrição_Perfil.Value = "NOVO PERFIL"
    OB_RET.Value = True
    TB_CMSS_INT.Value = "0,00%"
    TB_CMSS_DIR.Value = "0,00%"
    TB_PREMIO.Value = "0,00%"
    TB_MKTG.Value = "0,00%"
    TB_PDV.Value = "0,00%"
    TB_EBUSINESS.Value = "0,00%"
    TB_PARTICIPAÇÃO_FISICA.Value = "0,00%"
    ºC = Application.Match("Regime de Tributação", ThisWorkbook.Sheets("BD_CAD_VND").Rows(158), 0)
    ThisWorkbook.Sheets("BD_CAD_VND").Cells(ºL, ºC).Value = "RET"
    Call SalvarPerfil
    Call CarregarPerfil
End Sub
'Copiar Perfil
Private Sub BT_COPY_PRF_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºLin1 = ThisWorkbook.Sheets("BD_CAD_VND").Cells(208, 2).End(xlUp).Row + 1
    For ºL = 159 To ºLin1
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value = False
    Next
    lIN = CDbl(Left(CB_Select_Prf.Value, Application.Search("|", CB_Select_Prf.Value) - 2))
    ºC = ThisWorkbook.Sheets("BD_CAD_VND").Cells(158, Columns.Count).End(xlToLeft).Column
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLin1 & ":" & Cells(ºLin1, ºC).Address).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & lIN + 158 & ":" & Cells(lIN + 158, ºC).Address).Value
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºLin1).Value = True
    Call CarregarPerfil
End Sub
'Deletar Perfil
Private Sub BT_ERASE_PRF_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    ºLin1 = ThisWorkbook.Sheets("BD_CAD_VND").Cells(208, 2).End(xlUp).Row
    For ºL = 159 To ºLin1
        ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value = False
    Next
    lIN = CDbl(Left(CB_Select_Prf.Value, Application.Search("|", CB_Select_Prf.Value) - 2))
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B159").Value = True
    ºC = ThisWorkbook.Sheets("BD_CAD_VND").Cells(158, Columns.Count).End(xlToLeft).Column
    ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & lIN + 158 & ":" & Cells(lIN + 158, ºC).Address).ClearContents
    For ºL = 159 To ºLin1
        If ThisWorkbook.Sheets("BD_CAD_VND").Range("B" & ºL).Value <> "" Then
             ThisWorkbook.Sheets("BD_CAD_VND").Range("A" & ºL).Value = ºL
        End If
    Next
    If ThisWorkbook.Sheets("BD_CAD_VND").AutoFilterMode Then ThisWorkbook.Sheets("BD_CAD_VND").AutoFilterMode = False
    ThisWorkbook.Sheets("BD_CAD_VND").Sort.SortFields.Clear
    ThisWorkbook.Sheets("BD_CAD_VND").Sort.SortFields.Add Key:=Range("A159:A" & ºLin1), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    ThisWorkbook.Sheets("BD_CAD_VND").Sort.SetRange Range("A159:" & Cells(ºLin1, ºC).Address)
    ThisWorkbook.Sheets("BD_CAD_VND").Sort.Apply
    ThisWorkbook.Sheets("BD_CAD_VND").Range("A159:A" & ºLin1).Value = ""
    Call CarregarPerfil
End Sub
'Regime de Tributação
Private Sub OB_Presumido_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    TB_TX_IRCSLL.Enabled = OB_Presumido.Value
    TB_TX_PISCOFINS.Enabled = OB_Presumido.Value
    
    If OB_Presumido.Value Then
        TB_TX_IRCSLL.Value = "3,08%"
        TB_TX_PISCOFINS.Value = "3,65%"
        TB_TX_IRCSLL_P.Value = "0,00%"
        TB_TX_PISCOFINS_P.Value = "0,00%"
        TB_TX_IRCSLL_P.Visible = True
        TB_TX_PISCOFINS_P.Visible = True
        LBIRCLSS.Visible = True
        LBPISCOFINS.Visible = True
    Else
        TB_TX_PISCOFINS.Value = ""
        TB_TX_IRCSLL.Value = ""
        TB_TX_IRCSLL_P.Value = ""
        TB_TX_PISCOFINS_P.Value = ""
        TB_TX_IRCSLL_P.Visible = False
        TB_TX_PISCOFINS_P.Visible = False
        LBIRCLSS.Visible = False
        LBPISCOFINS.Visible = False
    End If
End Sub
'Aliquota IR/CSLL
Private Sub TB_TX_IRCSLL_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_TX_IRCSLL", 2)
End Sub
'Aliquota PIS/COFINS
Private Sub TB_TX_PISCOFINS_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_TX_PISCOFINS", 2)
End Sub
'Regime de Tributação
Private Sub OB_RET_Change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    TB_TX_RET.Enabled = OB_RET.Value
    If OB_RET.Value Then
        TB_TX_RET.Value = "4,00%"
        TB_TX_RET_P.Value = "0,00%"
        TB_TX_RET_P.Visible = True
        LBRET.Visible = True
    Else
        TB_TX_RET.Value = ""
        TB_TX_RET_P.Value = ""
        TB_TX_RET_P.Visible = False
        LBRET.Visible = False
    End If
End Sub
'Aliquota RET
Private Sub TB_TX_RET_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_TX_RET", 2)
End Sub
'Comissão Direta
Private Sub TB_CMSS_DIR_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_CMSS_DIR", 2)
End Sub
'Comissão indireta
Private Sub TB_CMSS_INT_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_CMSS_INT", 2)
End Sub
'Valor do Condominio
Private Sub TB_Condominio_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Condominio", 2)
End Sub
'Valor do IPTU
Private Sub TB_IPTU_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_IPTU", 2)
End Sub
'% de Marketing sobre VGV
Private Sub TB_MKTG_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_MKTG", 2)
End Sub
'% do PDV sobre VGV
Private Sub TB_PDV_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_PDV", 2)
End Sub
'% do Ebusiness sobre VGV
Private Sub TB_EBUSINESS_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_EBUSINESS", 2)
End Sub
'Taxa a VP
Private Sub TB_TX_VP_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_TX_VP", 4)
End Sub
'-----------------------------------------------------------------------------------------------------------------------
'                              TERRENO / OBRA
'-----------------------------------------------------------------------------------------------------------------------
'Aliquota ITBI
Private Sub TB_TX_ITBI_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_TX_ITBI", 4)
End Sub
'Mes de Pagamento ITBI
Private Sub TB_PG_ITBI_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_PG_ITBI", 0)
End Sub
'Calculo do Valor da Permuta
Sub ValorPermuta()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If TB_VGV_Terreno.Value <> "" Then
        If PRTC_PRMT = "" Then PRTC_PRMT.Value = 0
        TB_VGV_EX_Permuta.Value = TB_VGV_Terreno.Value - (TB_VGV_Terreno.Value * (Replace(PRTC_PRMT, "%", "") / 100))
        Call FormatarNumCur("CadastroUnidades", "TB_VGV_EX_Permuta", 2)
    Else
        TB_VGV_EX_Permuta.Value = 0
    End If
End Sub
'Gatilho do Campo de Metragem do Terreno
Private Sub TB_Metragem_T_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If TB_Metragem_T.Value <> "" And TB_VGV_Terreno.Value <> "" Then
        TB_Valor_metro.Value = TB_VGV_Terreno.Value / TB_Metragem_T.Value
        Call FormatarNumCur("CadastroUnidades", "TB_Metragem_T", 4)
    End If
    Call FormatarNumCur("CadastroUnidades", "TB_Metragem_T", 4)
End Sub
'-----------------------------------------------------------------------------

Private Sub TB_CA_MIN_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_CA_MIN", 0)
End Sub
Private Sub TB_CA_MAX_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_CA_MAX", 0)
    If TB_CA_MAX.Value <> "" And TB_Metragem_T <> "" Then
        TB_Potencial.Value = TB_CA_MAX.Value * TB_Metragem_T
        Call FormatarNumCur("CadastroUnidades", "TB_Potencial", 0)
    End If
End Sub
Private Sub TB_Potencial_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Potencial", 0)
End Sub
Private Sub TB_TX_Permut_Fisica_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_TX_Permut_Fisica", 3)
End Sub
'Gatilho do Campo de % de Permuta Financeira sobre o VGV
Private Sub TB_TX_Permut_Fin_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNum("CadastroUnidades", "TB_TX_Permut_Fin", 4)
    If Replace(TB_TX_Permut_Fin, "%", "") > 0 And TB_TX_Permut_Fin <> "" Then
        CalcPermutaFis.Enabled = False
    Else
        CalcPermutaFis.Enabled = True
    End If
End Sub
Private Sub TB_VGV_Permuta_Fiscal_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_VGV_Permuta_Fiscal", 4)
End Sub
Private Sub TB_Area_Construída_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Area_Construída", 0)
End Sub
Private Sub TB_Custo_Area_C_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Custo_Area_C", 2)
End Sub
Private Sub TB_Custo_C_TX_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Custo_C_TX", 2)
End Sub
Private Sub TB_Custo_S_TX_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Custo_S_TX", 2)
End Sub
Private Sub TB_Custo_Raso_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Custo_Raso", 2)
End Sub
Private Sub TB_TX_Ger_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_TX_Ger")
End Sub
Private Sub TB_Valor_Ger_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Valor_Ger", 2)
End Sub
Private Sub TB_TX_Ext_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_TX_Ext")
End Sub
Private Sub TB_Valor_EXT_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Valor_EXT", 2)
End Sub
Private Sub TB_CUSTO_ABC_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_ABC", 2)
End Sub
Private Sub TB_TX_DTAS_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_TX_DTAS")
End Sub
Private Sub TB_Valor_DTAS_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Valor_DTAS", 2)
End Sub
Private Sub TB_CUSTO_AD_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_AD", 2)
End Sub
Private Sub TB_CUSTO_TOTAL_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_TOTAL", 2)
End Sub
'-----------------------------------------------------------------------------------------------------------------------
'                              CURVAS DE OBRA
'-----------------------------------------------------------------------------------------------------------------------
Private Sub CB_Fase_change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If CB_Fase.Value <> "" Then
        Call Cont_Area_PVT(CB_Fase.Value)
        TB_Area_Total_PVT.Value = Format(Application.Sum(ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & CB_Fase.Value + 497 & ":D" & CB_Fase.Value + 497)), "#,##0.00")
    End If
End Sub
Private Sub LV_FasesObra_KeyDown(KeyCode As Integer, ByVal Shift As Integer)
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If Me.LV_FasesObra.ListItems.Count > 0 Then
        If KeyCode = 46 And Me.LV_FasesObra.SelectedItem.Index > 0 Then
            If MsgBox("Confirma a Exclusão? ", vbYesNo, "") = vbYes Then
                Parcela = Me.LV_FasesObra.SelectedItem.Index
                Me.LV_FasesObra.ListItems.Remove (Me.LV_FasesObra.SelectedItem.Index)
                Call Limpar_PG_Curva
                Call DesabilitarBTCVO
                ThisWorkbook.Sheets("BD_CAD_VND").Rows(209 + Parcela).ClearContents
            End If
        End If
    End If
End Sub
Private Sub LV_FasesObra_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Dim ºSelected As Integer
    Call HabilitarBTCVO
    If LV_FasesObra.ListItems.Count > 0 Then
        ºSelected = LV_FasesObra.SelectedItem.Index
        If LV_FasesObra.SelectedItem.Index <> 0 Then
            CB_Fase.Value = LV_FasesObra.ListItems(ºSelected)
            Call Cont_Area_PVT(CB_Fase.Value)
            If ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & CB_Fase.Value + 497).Text = "" Then Exit Sub
            If LV_FasesObra.ListItems(ºSelected).SubItems(1) <> "" Then
                CB_Curva.Value = LV_FasesObra.ListItems(ºSelected).SubItems(1) & " | " & ThisWorkbook.Sheets("BD_CAD_VND").Cells(260, 1 + LV_FasesObra.ListItems(ºSelected).SubItems(1)).Value
            Else
                CB_Curva.Value = ""
            End If
            Call Cont_Area_PVT(CB_Fase.Value)
            TB_Area_Total_PVT.Value = Format(Application.Sum(ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & CB_Fase.Value + 497 & ":D" & CB_Fase.Value + 497)), "#,##0.00")
            TB_Area_Total_C.Value = LV_FasesObra.ListItems(ºSelected).SubItems(3)
            TB_CUSTO_C.Value = LV_FasesObra.ListItems(ºSelected).SubItems(4)
            
            If Custo_Obra_Pvt.Value = "Custo do m² Pvt. C/ Taxas" Then
                TB_CUSTO_P_TAXAS.Value = LV_FasesObra.ListItems(ºSelected).SubItems(5)
            Else
                TB_Custo_Metro.Value = LV_FasesObra.ListItems(ºSelected).SubItems(5)
            End If
            
            TB_TX_ADM_GER.Value = LV_FasesObra.ListItems(ºSelected).SubItems(6)
            If TB_TX_ADM_GER.Value = "" Then TB_TX_ADM_GER.Value = 0
            Call FormatarNum("CadastroUnidades", "TB_TX_ADM_GER", 2)
            
            TB_TX_ADM_EXT.Value = LV_FasesObra.ListItems(ºSelected).SubItems(7)
            If TB_TX_ADM_EXT.Value = "" Then TB_TX_ADM_EXT.Value = 0
            Call FormatarNum("CadastroUnidades", "TB_TX_ADM_EXT", 2)
            
            TB_TX_DTAS_2.Value = LV_FasesObra.ListItems(ºSelected).SubItems(8)
            If TB_TX_DTAS_2.Value = "" Then TB_TX_DTAS_2.Value = 0
            Call FormatarNum("CadastroUnidades", "TB_TX_DTAS_2", 2)
            
            TB_INI_OBRA.Value = LV_FasesObra.ListItems(ºSelected).SubItems(9)
            TB_DURACAO.Value = ThisWorkbook.Sheets("BD_CAD_VND").Cells(461, LV_FasesObra.ListItems(ºSelected).SubItems(1) + 1).End(xlUp).Row - 261
            TB_Prct_Area_PVT.Value = LV_FasesObra.ListItems(ºSelected).SubItems(11)
            TB_INCORRIDO.Value = LV_FasesObra.ListItems(ºSelected).SubItems(13)
            TB_Prct_Area_PVT.Value = (TB_Area_Total_PVT / Application.Sum(ThisWorkbook.Sheets("BD_CAD_VND").Range("C498:C517"))) * 100
            Call FormatarNum("CadastroUnidades", "TB_Prct_Area_PVT", 2)
            Call C_Totais
        End If
    End If
End Sub

Private Sub CommandButton9_Click()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call AttBDTipologias
    Call Limpar_PG_Curva
    Call HabilitarBTCVO
    CB_Fase.Value = LV_FasesObra.ListItems.Count + 1
    If TB_Area_Total_PVT <> 0 Then
        If TB_Area_Total_PVT = "" Then TB_Area_Total_PVT = 0
        TB_Prct_Area_PVT.Value = (TB_Area_Total_PVT / Application.Sum(ThisWorkbook.Sheets("BD_CAD_VND").Range("C498:C517"))) * 100
        Call FormatarNum("CadastroUnidades", "TB_Prct_Area_PVT", 3)
        On Error Resume Next
        TB_Area_Total_C.Value = 0
        TB_CUSTO_P_TAXAS.Value = 0
        TB_CUSTO_C.Value = 0
        TB_TX_ADM_GER.Value = 0
        TB_VLR_ADM_GER.Value = 0
        TB_TX_ADM_EXT.Value = 0
        TB_VLR_ADM_EXT.Value = 0
        TB_TX_DTAS_2.Value = 0
        TB_VLR_DTAS_2.Value = 0
    Else
        MsgBox "Você deve cadastrar as tipologias antes de carregar as informações de obra!!" & Chr(10) & "Não existe área privativa na fase de obra " & CB_Fase.Value
        If LV_FasesObra.ListItems.Count > 0 Then Call LV_FasesObra_Click
    End If
End Sub

Private Sub TB_Custo_Metro_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Custo_Metro", 2)
    Call C_Totais_2
End Sub
Private Sub TB_Area_Total_C_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_Area_Total_C", 2)
    Call Calcular_Total_m2_Construído
End Sub

Private Sub TB_VLR_ADM_GER_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_VLR_ADM_GER", 0)
    If TB_VLR_ADM_GER.Value <> "" And TB_TT_S_TX.Value > 0 Then
        TB_TX_ADM_GER.Value = Format((CDbl(TB_VLR_ADM_GER.Value) / CDbl(TB_TT_S_TX.Value)) * 100, "#,##0.00") & "%"
        Call FormatarNum("CadastroUnidades", "TB_TX_ADM_GER", 2)
        Call TotaisObra_2
    Else
        TB_TX_ADM_GER.Value = ""
    End If
End Sub
Private Sub TB_VLR_ADM_EXT_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_VLR_ADM_EXT", 0)
    If TB_VLR_ADM_EXT.Value <> "" Then
        TB_TX_ADM_EXT.Value = Format((CDbl(TB_VLR_ADM_EXT.Value) / CDbl(TB_TT_S_TX.Value)) * 100, "#,##0.00") & "%"
        Call FormatarNum("CadastroUnidades", "TB_TX_ADM_EXT", 2)
        Call TotaisObra_2
    Else
        TB_TX_ADM_EXT.Value = ""
    End If
End Sub
Private Sub TB_VLR_DTAS_2_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_VLR_DTAS_2", 0)
    If TB_VLR_DTAS_2.Value <> "" Then
        TB_TX_DTAS_2.Value = Format((CDbl(TB_VLR_DTAS_2.Value) / CDbl(TB_TT_S_TX.Value)) * 100, "#,##0.00") & "%"
        Call FormatarNum("CadastroUnidades", "TB_TX_DTAS_2", 2)
        Call TotaisObra_2
    Else
        TB_TX_DTAS_2.Value = ""
    End If
End Sub
Private Sub TB_TX_ADM_GER_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If TB_TX_ADM_GER.Value = "" Then TB_VLR_ADM_GER.Value = 0
    Call FormatarNum("CadastroUnidades", "TB_TX_ADM_GER", 2)
    Call TotaisObra_2
End Sub
Private Sub TB_TX_ADM_EXT_AfterUpdate()
    If TB_TX_ADM_EXT.Value = "" Then TB_TX_ADM_EXT.Value = 0
    Call FormatarNum("CadastroUnidades", "TB_TX_ADM_EXT", 2)
    Call TotaisObra_2
End Sub
Private Sub TB_TX_DTAS_2_AfterUpdate()
    If TB_TX_DTAS_2.Value = "" Then TB_TX_DTAS_2.Value = 0
    Call FormatarNum("CadastroUnidades", "TB_TX_DTAS_2", 2)
    Call TotaisObra_2
End Sub
Private Sub TB_INI_OBRA_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If Application.IfError(Application.Search("LCTO ", TB_INI_OBRA), 0) = 0 Then
        Call FormatarNumCur("CadastroUnidades", "TB_INI_OBRA", 0)
    End If
    Call SalvarFase
End Sub
Private Sub TB_DURACAO_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_DURACAO", 0)
End Sub
Private Sub TB_CUSTO_C_TAXAS_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_C_TAXAS", 2)
End Sub
Private Sub TB_CUSTO_TOTAL2_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "TB_CUSTO_TOTAL2", 2)
End Sub
Private Sub TB_PRCTL_VGV_AfterUpdate()
    Call FormatarNum("CadastroUnidades", "TB_PRCTL_VGV", 2)
End Sub
Private Sub TB_Parcelas_TI_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Call FormatarNumCur("CadastroUnidades", "TB_Parcelas_TI", 0)
    If CB_VALOR_TI.Value <> "" Then
        If Application.IfError(Application.Search("%", L_Fator_TI.Caption), 0) > 0 Then
            Call FormatarNum("CadastroUnidades", "CB_VALOR_TI", 3)
            If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
                CB_VALOR_PARCELA_TI.Value = Replace(CB_VALOR_TI.Value, "%", "") / TB_Parcelas_TI.Value
                Call FormatarNum("CadastroUnidades", "CB_VALOR_PARCELA_TI", 3)
            End If
        Else
            Call FormatarNumCur("CadastroUnidades", "CB_VALOR_TI", 2)
            If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
                CB_VALOR_PARCELA_TI.Value = CB_VALOR_TI.Value / TB_Parcelas_TI.Value
                Call FormatarNumCur("CadastroUnidades", "CB_VALOR_PARCELA_TI", 2)
            End If
        End If
    ElseIf CB_VALOR_TI <> "" Then
        If Application.IfError(Application.Search("%", L_Fator_TI.Caption), 0) > 0 Then
            Call FormatarNum("CadastroUnidades", "CB_VALOR_PARCELA_TI", 3)
            If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
                CB_VALOR_TI.Value = Replace(CB_VALOR_PARCELA_TI.Value, "%", "") * TB_Parcelas_TI.Value
                Call FormatarNum("CadastroUnidades", "CB_VALOR_TI", 3)
            End If
        Else
            Call FormatarNumCur("CadastroUnidades", "CB_VALOR_PARCELA_TI", 2)
            If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
                CB_VALOR_TI.Value = CB_VALOR_PARCELA_TI.Value * TB_Parcelas_TI.Value
                Call FormatarNumCur("CadastroUnidades", "CB_VALOR_TI", 2)
            End If
        End If
    End If
End Sub
Private Sub CB_MESES_TI_AfterUpdate()
    Call FormatarNumCur("CadastroUnidades", "CB_MESES_TI", 0)
End Sub
Private Sub CB_VALOR_TI_AfterUpdate()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    If Application.IfError(Application.Search("%", L_Fator_TI.Caption), 0) > 0 Then
        Call FormatarNum("CadastroUnidades", "CB_VALOR_TI", 3)
        If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
            CB_VALOR_PARCELA_TI.Value = Replace(CB_VALOR_TI.Value, "%", "") / TB_Parcelas_TI.Value
            Call FormatarNum("CadastroUnidades", "CB_VALOR_PARCELA_TI", 3)
        End If
    Else
        Call FormatarNumCur("CadastroUnidades", "CB_VALOR_TI", 2)
        If TB_Parcelas_TI.Value <> "" And TB_Parcelas_TI.Value > 0 Then
            CB_VALOR_PARCELA_TI.Value = CB_VALOR_TI.Value / TB_Parcelas_TI.Value
            Call FormatarNumCur("CadastroUnidades", "CB_VALOR_PARCELA_TI", 2)
        End If
    End If
End Sub
Private Sub CB_TIPO_LCTO_TI_change()
    'VERIFICAÇÃO DE ERRO
    On Error GoTo chamarform
chamarform:
    If ErroMsg(Err) Then Exit Sub
    
    Dim ºL As Integer
    ºL = Application.IfError(Application.Match(CB_TIPO_LCTO_TI.Value, ThisWorkbook.Sheets("BD_CAD_VND").Range("B581:B680"), 0), 0) + 580
    If ºL > 580 Then
        L_Fator_TI.Caption = ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & ºL).Value
    Else
        L_Fator_TI.Caption = "Valor"
    End If
End Sub
Private Sub ADD_TI_Click()
'VERIFICAÇÃO DE ERRO
On Error GoTo chamarform
chamarform:
If ErroMsg(Err) Then Exit Sub
    
    If Application.IfError(Application.Search("%", L_Fator_TI.Caption), 0) > 0 Then
        Call FormatarNum("CadastroUnidades", "CB_VALOR_TI", 3)
    Else
        Call FormatarNumCur("CadastroUnidades", "CB_VALOR_TI", 2)
    End If
    Application.ScreenUpdating = False
    
    If CB_FASE_TI.Value <> "" And CB_TIPO_LCTO_TI.Value <> "" And TB_Parcelas_TI.Value <> "" And CB_PERIODICIDADE_TI.Value <> "" _
        And CB_MESES_TI.Value <> "" And CB_VALOR_TI.Value <> "" Then
        If ADD_TI.Caption <> "" And ADD_TI.Caption <> "Adicionar" Then
            ºL = ADD_TI.Caption
        Else
            ºL = ThisWorkbook.Sheets("Lançamentos").Cells(300, 2).End(xlUp).Row + 1
        End If
        If Not Check_Curva_Lcto(CDbl(ºL)) Then
            ºResposta = MsgBox("A Soma do totais da curva não totalizam 100% deseja manter assim?", vbYesNo)
        End If
        If ºResposta = vbYes Or Check_Curva_Lcto(CDbl(ºL)) Then
            ADD_TI.Caption = ""
            If CadastroUnidades.DEL_CURVA_LCTO.Enabled Then
                Call Descarregar_Curva_Lcto(CDbl(ºL))
            Else
                ThisWorkbook.Sheets("LANÇAMENTOS").Range("J" & CDbl(ºL)).Value = False
                ThisWorkbook.Sheets("LANÇAMENTOS").Range("K" & CDbl(ºL) & ":DG" & CDbl(ºL)).Value = ""
            End If
            ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 1).Value = CB_FASE_TI.Value
            ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 2).Value = CB_TIPO_LCTO_TI.Value
            ºL_2 = Application.IfError(Application.Match(CB_TIPO_LCTO_TI.Value, ThisWorkbook.Sheets("BD_CAD_VND").Range("B581:B680"), 0), 0) + 580
            ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 3).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("C" & ºL_2).Value
            ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 4).Value = ThisWorkbook.Sheets("BD_CAD_VND").Range("D" & ºL_2).Value
            ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 5).Value = TB_Parcelas_TI.Value
            ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 6).Value = CB_PERIODICIDADE_TI.Value
            ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 7).Value = CB_MESES_TI.Value
            ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 8).Value = CB_EVENTO_TI.Value
            If Application.IfError(Application.Search("%", CB_VALOR_TI.Value), 0) <> 0 Then
                ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 9).Value = Replace(CB_VALOR_TI.Value, ",", ".")
                ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 9).Value = ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 9).Value * 100
            Else
                ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 9).Value = Replace(CDbl(CB_VALOR_TI.Value), ",", ".")
            End If
            ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 112).Value = TB_comment.Value
            ThisWorkbook.Sheets("Lançamentos").Cells(ºL, 113).Value = Obs_lcto.Value
            CB_PEP.Value = ""
            CB_FASE_TI.Value = ""
            CB_TIPO_LCTO_TI.Value = ""
            TB_Parcelas_TI.Value = ""
            CB_PERIODICIDADE_TI.Value = ""
            CB_MESES_TI.Value = ""
            CB_EVENTO_TI.Value = ""
            CB_VALOR_TI.Value = ""
            CB_VALOR_PARCELA_TI.Value = ""
            TB_comment.Value = ""
            Me.LV_Lançamentos_TI.ListItems.Clear
            Me.LV_Lançamentos_TI.ColumnHeaders.Clear
            Call Carregar_LV_TI
            L_Fator_TI.Caption = "Valor"
            LV_Lançamentos_TI.Height = 396
            LV_Lançamentos_TI.Top = 30
            LV_Curva_LCTO.Top = 30
            LV_Curva_LCTO.Height = 396
            Label647.Visible = False
            INST_CURVA_LCTO.Visible = False
            LV_Curva_LCTO.BackColor = &H80000004
            LV_Curva_LCTO.LabelEdit = lvwManual
            DEL_CURVA_LCTO.Enabled = False
            LV_Lançamentos_TI.Enabled = True
        End If
   Else
        If CB_FASE_TI.Value = "" Then ºCAMPOS = "Fase "
        If CB_TIPO_LCTO_TI.Value = "" Then ºCAMPOS = ºCAMPOS & "Tipo "
        If TB_Parcelas_TI.Value = "" Then ºCAMPOS = ºCAMPOS & "Parcelas "
        If CB_PERIODICIDADE_TI.Value = "" Then ºCAMPOS = ºCAMPOS & "Periodicidade "
        If CB_MESES_TI.Value = "" Then ºCAMPOS = ºCAMPOS & "Mes "
        If CB_VALOR_TI.Value = "" Then ºCAMPOS = ºCAMPOS & "Valor do lançamento "
        MsgBox "Os campos " & ºCAMPOS & " devem ser preenchidos!!!"
    End If
     
End Sub

Private Sub Vincular_VGV_Terreno_Click()
        If Vincular_VGV_Terreno.Value Then
            TB_VGV_Terreno_Fiscal.BackColor = &H80000014
            TB_VGV_Terreno_Fiscal.Locked = True
            TB_VGV_Terreno_Fiscal.Value = TB_VGV_Terreno
        Else
            TB_VGV_Terreno_Fiscal.BackColor = &H80000005
            TB_VGV_Terreno_Fiscal.Locked = False
        End If
End Sub
Private Sub LB_Fase_Tipologia_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_1.Top
End Sub
Private Sub LB_Fase_Tipologia_2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_2.Top
End Sub
Private Sub LB_Fase_Tipologia_3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_3.Top
End Sub
Private Sub LB_Fase_Tipologia_4_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_4.Top
End Sub
Private Sub LB_Fase_Tipologia_5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_5.Top
End Sub
Private Sub LB_Fase_Tipologia_6_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_6.Top
End Sub
Private Sub LB_Fase_Tipologia_7_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_7.Top
End Sub
Private Sub LB_Fase_Tipologia_8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_8.Top
End Sub
Private Sub LB_Fase_Tipologia_9_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_9.Top
End Sub
Private Sub LB_Fase_Tipologia_10_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_10.Top
End Sub
Private Sub LB_Fase_Tipologia_11_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_11.Top
End Sub
Private Sub LB_Fase_Tipologia_12_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_12.Top
End Sub
Private Sub LB_Fase_Tipologia_13_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_13.Top
End Sub
Private Sub LB_Fase_Tipologia_14_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_14.Top
End Sub
Private Sub LB_Fase_Tipologia_15_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_15.Top
End Sub
Private Sub LB_Fase_Tipologia_16_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_16.Top
End Sub
Private Sub LB_Fase_Tipologia_17_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_17.Top
End Sub
Private Sub LB_Fase_Tipologia_18_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_18.Top
End Sub
Private Sub LB_Fase_Tipologia_19_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_19.Top
End Sub
Private Sub LB_Fase_Tipologia_20_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_20.Top
End Sub
Private Sub LB_Fase_Tipologia_21_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_21.Top
End Sub
Private Sub LB_Fase_Tipologia_22_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_22.Top
End Sub
Private Sub LB_Fase_Tipologia_23_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_23.Top
End Sub
Private Sub LB_Fase_Tipologia_24_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_24.Top
End Sub
Private Sub LB_Fase_Tipologia_25_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_25.Top
End Sub
Private Sub LB_Fase_Tipologia_26_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_26.Top
End Sub
Private Sub LB_Fase_Tipologia_27_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_27.Top
End Sub
Private Sub LB_Fase_Tipologia_28_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_28.Top
End Sub
Private Sub LB_Fase_Tipologia_29_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_29.Top
End Sub
Private Sub LB_Fase_Tipologia_30_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = LB_Fase_Tipologia_30.Top
End Sub

Private Sub TB_Descricao_Tipologia_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_1.Top
End Sub
Private Sub TB_Descricao_Tipologia_2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_2.Top
End Sub
Private Sub TB_Descricao_Tipologia_3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_3.Top
End Sub
Private Sub TB_Descricao_Tipologia_4_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_4.Top
End Sub
Private Sub TB_Descricao_Tipologia_5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_5.Top
End Sub
Private Sub TB_Descricao_Tipologia_6_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_6.Top
End Sub
Private Sub TB_Descricao_Tipologia_7_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_7.Top
End Sub
Private Sub TB_Descricao_Tipologia_8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_8.Top
End Sub
Private Sub TB_Descricao_Tipologia_9_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_9.Top
End Sub
Private Sub TB_Descricao_Tipologia_10_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_10.Top
End Sub
Private Sub TB_Descricao_Tipologia_11_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_11.Top
End Sub
Private Sub TB_Descricao_Tipologia_12_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_12.Top
End Sub
Private Sub TB_Descricao_Tipologia_13_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_13.Top
End Sub
Private Sub TB_Descricao_Tipologia_14_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_14.Top
End Sub
Private Sub TB_Descricao_Tipologia_15_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_15.Top
End Sub
Private Sub TB_Descricao_Tipologia_16_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_16.Top
End Sub
Private Sub TB_Descricao_Tipologia_17_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_17.Top
End Sub
Private Sub TB_Descricao_Tipologia_18_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_18.Top
End Sub
Private Sub TB_Descricao_Tipologia_19_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_19.Top
End Sub
Private Sub TB_Descricao_Tipologia_20_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_20.Top
End Sub
Private Sub TB_Descricao_Tipologia_21_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_21.Top
End Sub
Private Sub TB_Descricao_Tipologia_22_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_22.Top
End Sub
Private Sub TB_Descricao_Tipologia_23_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_23.Top
End Sub
Private Sub TB_Descricao_Tipologia_24_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_24.Top
End Sub
Private Sub TB_Descricao_Tipologia_25_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_25.Top
End Sub
Private Sub TB_Descricao_Tipologia_26_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_26.Top
End Sub
Private Sub TB_Descricao_Tipologia_27_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_27.Top
End Sub
Private Sub TB_Descricao_Tipologia_28_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_28.Top
End Sub
Private Sub TB_Descricao_Tipologia_29_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_29.Top
End Sub
Private Sub TB_Descricao_Tipologia_30_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Descricao_Tipologia_30.Top
End Sub

Private Sub TB_Und_Tipologia_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_1.Top
End Sub
Private Sub TB_Und_Tipologia_2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_2.Top
End Sub
Private Sub TB_Und_Tipologia_3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_3.Top
End Sub
Private Sub TB_Und_Tipologia_4_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_4.Top
End Sub
Private Sub TB_Und_Tipologia_5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_5.Top
End Sub
Private Sub TB_Und_Tipologia_6_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_6.Top
End Sub
Private Sub TB_Und_Tipologia_7_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_7.Top
End Sub
Private Sub TB_Und_Tipologia_8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_8.Top
End Sub
Private Sub TB_Und_Tipologia_9_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_9.Top
End Sub
Private Sub TB_Und_Tipologia_10_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_10.Top
End Sub
Private Sub TB_Und_Tipologia_11_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_11.Top
End Sub
Private Sub TB_Und_Tipologia_12_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_12.Top
End Sub
Private Sub TB_Und_Tipologia_13_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_13.Top
End Sub
Private Sub TB_Und_Tipologia_14_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_14.Top
End Sub
Private Sub TB_Und_Tipologia_15_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_15.Top
End Sub
Private Sub TB_Und_Tipologia_16_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_16.Top
End Sub
Private Sub TB_Und_Tipologia_17_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_17.Top
End Sub
Private Sub TB_Und_Tipologia_18_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_18.Top
End Sub
Private Sub TB_Und_Tipologia_19_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_19.Top
End Sub
Private Sub TB_Und_Tipologia_20_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_20.Top
End Sub
Private Sub TB_Und_Tipologia_21_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_21.Top
End Sub
Private Sub TB_Und_Tipologia_22_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_22.Top
End Sub
Private Sub TB_Und_Tipologia_23_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_23.Top
End Sub
Private Sub TB_Und_Tipologia_24_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_24.Top
End Sub
Private Sub TB_Und_Tipologia_25_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_25.Top
End Sub
Private Sub TB_Und_Tipologia_26_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_26.Top
End Sub
Private Sub TB_Und_Tipologia_27_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_27.Top
End Sub
Private Sub TB_Und_Tipologia_28_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_28.Top
End Sub
Private Sub TB_Und_Tipologia_29_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_29.Top
End Sub
Private Sub TB_Und_Tipologia_30_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Und_Tipologia_30.Top
End Sub

Private Sub TB_Permt_Tipologia_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_1.Top
End Sub
Private Sub TB_Permt_Tipologia_2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_2.Top
End Sub
Private Sub TB_Permt_Tipologia_3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_3.Top
End Sub
Private Sub TB_Permt_Tipologia_4_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_4.Top
End Sub
Private Sub TB_Permt_Tipologia_5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_5.Top
End Sub
Private Sub TB_Permt_Tipologia_6_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_6.Top
End Sub
Private Sub TB_Permt_Tipologia_7_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_7.Top
End Sub
Private Sub TB_Permt_Tipologia_8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_8.Top
End Sub
Private Sub TB_Permt_Tipologia_9_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_9.Top
End Sub
Private Sub TB_Permt_Tipologia_10_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_10.Top
End Sub
Private Sub TB_Permt_Tipologia_11_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_11.Top
End Sub
Private Sub TB_Permt_Tipologia_12_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_12.Top
End Sub
Private Sub TB_Permt_Tipologia_13_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_13.Top
End Sub
Private Sub TB_Permt_Tipologia_14_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_14.Top
End Sub
Private Sub TB_Permt_Tipologia_15_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_15.Top
End Sub
Private Sub TB_Permt_Tipologia_16_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_16.Top
End Sub
Private Sub TB_Permt_Tipologia_17_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_17.Top
End Sub
Private Sub TB_Permt_Tipologia_18_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_18.Top
End Sub
Private Sub TB_Permt_Tipologia_19_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_19.Top
End Sub
Private Sub TB_Permt_Tipologia_20_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_20.Top
End Sub
Private Sub TB_Permt_Tipologia_21_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_21.Top
End Sub
Private Sub TB_Permt_Tipologia_22_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_22.Top
End Sub
Private Sub TB_Permt_Tipologia_23_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_23.Top
End Sub
Private Sub TB_Permt_Tipologia_24_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_24.Top
End Sub
Private Sub TB_Permt_Tipologia_25_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_25.Top
End Sub
Private Sub TB_Permt_Tipologia_26_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_26.Top
End Sub
Private Sub TB_Permt_Tipologia_27_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_27.Top
End Sub
Private Sub TB_Permt_Tipologia_28_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_28.Top
End Sub
Private Sub TB_Permt_Tipologia_29_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_29.Top
End Sub
Private Sub TB_Permt_Tipologia_30_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Permt_Tipologia_30.Top
End Sub

Private Sub TB_M²_Tipologia_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_1.Top
End Sub
Private Sub TB_M²_Tipologia_2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_2.Top
End Sub
Private Sub TB_M²_Tipologia_3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_3.Top
End Sub
Private Sub TB_M²_Tipologia_4_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_4.Top
End Sub
Private Sub TB_M²_Tipologia_5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_5.Top
End Sub
Private Sub TB_M²_Tipologia_6_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_6.Top
End Sub
Private Sub TB_M²_Tipologia_7_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_7.Top
End Sub
Private Sub TB_M²_Tipologia_8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_8.Top
End Sub
Private Sub TB_M²_Tipologia_9_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_9.Top
End Sub
Private Sub TB_M²_Tipologia_10_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_10.Top
End Sub
Private Sub TB_M²_Tipologia_11_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_11.Top
End Sub
Private Sub TB_M²_Tipologia_12_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_12.Top
End Sub
Private Sub TB_M²_Tipologia_13_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_13.Top
End Sub
Private Sub TB_M²_Tipologia_14_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_14.Top
End Sub
Private Sub TB_M²_Tipologia_15_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_15.Top
End Sub
Private Sub TB_M²_Tipologia_16_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_16.Top
End Sub
Private Sub TB_M²_Tipologia_17_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_17.Top
End Sub
Private Sub TB_M²_Tipologia_18_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_18.Top
End Sub
Private Sub TB_M²_Tipologia_19_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_19.Top
End Sub
Private Sub TB_M²_Tipologia_20_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_20.Top
End Sub
Private Sub TB_M²_Tipologia_21_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_21.Top
End Sub
Private Sub TB_M²_Tipologia_22_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_22.Top
End Sub
Private Sub TB_M²_Tipologia_23_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_23.Top
End Sub
Private Sub TB_M²_Tipologia_24_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_24.Top
End Sub
Private Sub TB_M²_Tipologia_25_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_25.Top
End Sub
Private Sub TB_M²_Tipologia_26_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_26.Top
End Sub
Private Sub TB_M²_Tipologia_27_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_27.Top
End Sub
Private Sub TB_M²_Tipologia_28_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_28.Top
End Sub
Private Sub TB_M²_Tipologia_29_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_29.Top
End Sub
Private Sub TB_M²_Tipologia_30_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_Tipologia_30.Top
End Sub


Private Sub TB_ValorM²_Tipologia_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_1.Top
End Sub
Private Sub TB_ValorM²_Tipologia_2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_2.Top
End Sub
Private Sub TB_ValorM²_Tipologia_3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_3.Top
End Sub
Private Sub TB_ValorM²_Tipologia_4_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_4.Top
End Sub
Private Sub TB_ValorM²_Tipologia_5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_5.Top
End Sub
Private Sub TB_ValorM²_Tipologia_6_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_6.Top
End Sub
Private Sub TB_ValorM²_Tipologia_7_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_7.Top
End Sub
Private Sub TB_ValorM²_Tipologia_8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_8.Top
End Sub
Private Sub TB_ValorM²_Tipologia_9_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_9.Top
End Sub
Private Sub TB_ValorM²_Tipologia_10_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_10.Top
End Sub
Private Sub TB_ValorM²_Tipologia_11_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_11.Top
End Sub
Private Sub TB_ValorM²_Tipologia_12_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_12.Top
End Sub
Private Sub TB_ValorM²_Tipologia_13_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_13.Top
End Sub
Private Sub TB_ValorM²_Tipologia_14_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_14.Top
End Sub
Private Sub TB_ValorM²_Tipologia_15_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_15.Top
End Sub
Private Sub TB_ValorM²_Tipologia_16_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_16.Top
End Sub
Private Sub TB_ValorM²_Tipologia_17_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_17.Top
End Sub
Private Sub TB_ValorM²_Tipologia_18_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_18.Top
End Sub
Private Sub TB_ValorM²_Tipologia_19_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_19.Top
End Sub
Private Sub TB_ValorM²_Tipologia_20_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_20.Top
End Sub
Private Sub TB_ValorM²_Tipologia_21_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_21.Top
End Sub
Private Sub TB_ValorM²_Tipologia_22_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_22.Top
End Sub
Private Sub TB_ValorM²_Tipologia_23_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_23.Top
End Sub
Private Sub TB_ValorM²_Tipologia_24_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_24.Top
End Sub
Private Sub TB_ValorM²_Tipologia_25_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_25.Top
End Sub
Private Sub TB_ValorM²_Tipologia_26_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_26.Top
End Sub
Private Sub TB_ValorM²_Tipologia_27_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_27.Top
End Sub
Private Sub TB_ValorM²_Tipologia_28_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_28.Top
End Sub
Private Sub TB_ValorM²_Tipologia_29_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_29.Top
End Sub
Private Sub TB_ValorM²_Tipologia_30_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_ValorM²_Tipologia_30.Top
End Sub

Private Sub TB_M²_D_Tipologia_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_1.Top
End Sub
Private Sub TB_M²_D_Tipologia_2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_2.Top
End Sub
Private Sub TB_M²_D_Tipologia_3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_3.Top
End Sub
Private Sub TB_M²_D_Tipologia_4_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_4.Top
End Sub
Private Sub TB_M²_D_Tipologia_5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_5.Top
End Sub
Private Sub TB_M²_D_Tipologia_6_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_6.Top
End Sub
Private Sub TB_M²_D_Tipologia_7_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_7.Top
End Sub
Private Sub TB_M²_D_Tipologia_8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_8.Top
End Sub
Private Sub TB_M²_D_Tipologia_9_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_9.Top
End Sub
Private Sub TB_M²_D_Tipologia_10_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_10.Top
End Sub
Private Sub TB_M²_D_Tipologia_11_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_11.Top
End Sub
Private Sub TB_M²_D_Tipologia_12_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_12.Top
End Sub
Private Sub TB_M²_D_Tipologia_13_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_13.Top
End Sub
Private Sub TB_M²_D_Tipologia_14_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_14.Top
End Sub
Private Sub TB_M²_D_Tipologia_15_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_15.Top
End Sub
Private Sub TB_M²_D_Tipologia_16_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_16.Top
End Sub
Private Sub TB_M²_D_Tipologia_17_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_17.Top
End Sub
Private Sub TB_M²_D_Tipologia_18_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_18.Top
End Sub
Private Sub TB_M²_D_Tipologia_19_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_19.Top
End Sub
Private Sub TB_M²_D_Tipologia_20_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_20.Top
End Sub
Private Sub TB_M²_D_Tipologia_21_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_21.Top
End Sub
Private Sub TB_M²_D_Tipologia_22_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_22.Top
End Sub
Private Sub TB_M²_D_Tipologia_23_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_23.Top
End Sub
Private Sub TB_M²_D_Tipologia_24_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_24.Top
End Sub
Private Sub TB_M²_D_Tipologia_25_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_25.Top
End Sub
Private Sub TB_M²_D_Tipologia_26_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_26.Top
End Sub
Private Sub TB_M²_D_Tipologia_27_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_27.Top
End Sub
Private Sub TB_M²_D_Tipologia_28_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_28.Top
End Sub
Private Sub TB_M²_D_Tipologia_29_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_29.Top
End Sub
Private Sub TB_M²_D_Tipologia_30_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_M²_D_Tipologia_30.Top
End Sub

Private Sub TB_Fator_Tipologia_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_1.Top
End Sub
Private Sub TB_Fator_Tipologia_2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_2.Top
End Sub
Private Sub TB_Fator_Tipologia_3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_3.Top
End Sub
Private Sub TB_Fator_Tipologia_4_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_4.Top
End Sub
Private Sub TB_Fator_Tipologia_5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_5.Top
End Sub
Private Sub TB_Fator_Tipologia_6_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_6.Top
End Sub
Private Sub TB_Fator_Tipologia_7_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_7.Top
End Sub
Private Sub TB_Fator_Tipologia_8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_8.Top
End Sub
Private Sub TB_Fator_Tipologia_9_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_9.Top
End Sub
Private Sub TB_Fator_Tipologia_10_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_10.Top
End Sub
Private Sub TB_Fator_Tipologia_11_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_11.Top
End Sub
Private Sub TB_Fator_Tipologia_12_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_12.Top
End Sub
Private Sub TB_Fator_Tipologia_13_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_13.Top
End Sub
Private Sub TB_Fator_Tipologia_14_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_14.Top
End Sub
Private Sub TB_Fator_Tipologia_15_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_15.Top
End Sub
Private Sub TB_Fator_Tipologia_16_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_16.Top
End Sub
Private Sub TB_Fator_Tipologia_17_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_17.Top
End Sub
Private Sub TB_Fator_Tipologia_18_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_18.Top
End Sub
Private Sub TB_Fator_Tipologia_19_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_19.Top
End Sub
Private Sub TB_Fator_Tipologia_20_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_20.Top
End Sub
Private Sub TB_Fator_Tipologia_21_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_21.Top
End Sub
Private Sub TB_Fator_Tipologia_22_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_22.Top
End Sub
Private Sub TB_Fator_Tipologia_23_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_23.Top
End Sub
Private Sub TB_Fator_Tipologia_24_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_24.Top
End Sub
Private Sub TB_Fator_Tipologia_25_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_25.Top
End Sub
Private Sub TB_Fator_Tipologia_26_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_26.Top
End Sub
Private Sub TB_Fator_Tipologia_27_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_27.Top
End Sub
Private Sub TB_Fator_Tipologia_28_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_28.Top
End Sub
Private Sub TB_Fator_Tipologia_29_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_29.Top
End Sub
Private Sub TB_Fator_Tipologia_30_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Fator_Tipologia_30.Top
End Sub

Private Sub TB_VGV_Tipologia_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_1.Top
End Sub
Private Sub TB_VGV_Tipologia_2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_2.Top
End Sub
Private Sub TB_VGV_Tipologia_3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_3.Top
End Sub
Private Sub TB_VGV_Tipologia_4_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_4.Top
End Sub
Private Sub TB_VGV_Tipologia_5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_5.Top
End Sub
Private Sub TB_VGV_Tipologia_6_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_6.Top
End Sub
Private Sub TB_VGV_Tipologia_7_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_7.Top
End Sub
Private Sub TB_VGV_Tipologia_8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_8.Top
End Sub
Private Sub TB_VGV_Tipologia_9_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_9.Top
End Sub
Private Sub TB_VGV_Tipologia_10_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_10.Top
End Sub
Private Sub TB_VGV_Tipologia_11_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_11.Top
End Sub
Private Sub TB_VGV_Tipologia_12_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_12.Top
End Sub
Private Sub TB_VGV_Tipologia_13_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_13.Top
End Sub
Private Sub TB_VGV_Tipologia_14_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_14.Top
End Sub
Private Sub TB_VGV_Tipologia_15_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_15.Top
End Sub
Private Sub TB_VGV_Tipologia_16_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_16.Top
End Sub
Private Sub TB_VGV_Tipologia_17_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_17.Top
End Sub
Private Sub TB_VGV_Tipologia_18_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_18.Top
End Sub
Private Sub TB_VGV_Tipologia_19_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_19.Top
End Sub
Private Sub TB_VGV_Tipologia_20_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_20.Top
End Sub
Private Sub TB_VGV_Tipologia_21_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_21.Top
End Sub
Private Sub TB_VGV_Tipologia_22_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_22.Top
End Sub
Private Sub TB_VGV_Tipologia_23_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_23.Top
End Sub
Private Sub TB_VGV_Tipologia_24_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_24.Top
End Sub
Private Sub TB_VGV_Tipologia_25_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_25.Top
End Sub
Private Sub TB_VGV_Tipologia_26_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_26.Top
End Sub
Private Sub TB_VGV_Tipologia_27_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_27.Top
End Sub
Private Sub TB_VGV_Tipologia_28_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_28.Top
End Sub
Private Sub TB_VGV_Tipologia_29_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_29.Top
End Sub
Private Sub TB_VGV_Tipologia_30_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_VGV_Tipologia_30.Top
End Sub

Private Sub TB_Vagas_Tipologia_1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_1.Top
End Sub
Private Sub TB_Vagas_Tipologia_2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_2.Top
End Sub
Private Sub TB_Vagas_Tipologia_3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_3.Top
End Sub
Private Sub TB_Vagas_Tipologia_4_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_4.Top
End Sub
Private Sub TB_Vagas_Tipologia_5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_5.Top
End Sub
Private Sub TB_Vagas_Tipologia_6_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_6.Top
End Sub
Private Sub TB_Vagas_Tipologia_7_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_7.Top
End Sub
Private Sub TB_Vagas_Tipologia_8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_8.Top
End Sub
Private Sub TB_Vagas_Tipologia_9_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_9.Top
End Sub
Private Sub TB_Vagas_Tipologia_10_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_10.Top
End Sub
Private Sub TB_Vagas_Tipologia_11_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_11.Top
End Sub
Private Sub TB_Vagas_Tipologia_12_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_12.Top
End Sub
Private Sub TB_Vagas_Tipologia_13_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_13.Top
End Sub
Private Sub TB_Vagas_Tipologia_14_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_14.Top
End Sub
Private Sub TB_Vagas_Tipologia_15_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_15.Top
End Sub
Private Sub TB_Vagas_Tipologia_16_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_16.Top
End Sub
Private Sub TB_Vagas_Tipologia_17_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_17.Top
End Sub
Private Sub TB_Vagas_Tipologia_18_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_18.Top
End Sub
Private Sub TB_Vagas_Tipologia_19_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_19.Top
End Sub
Private Sub TB_Vagas_Tipologia_20_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_20.Top
End Sub
Private Sub TB_Vagas_Tipologia_21_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_21.Top
End Sub
Private Sub TB_Vagas_Tipologia_22_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_22.Top
End Sub
Private Sub TB_Vagas_Tipologia_23_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_23.Top
End Sub
Private Sub TB_Vagas_Tipologia_24_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_24.Top
End Sub
Private Sub TB_Vagas_Tipologia_25_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_25.Top
End Sub
Private Sub TB_Vagas_Tipologia_26_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_26.Top
End Sub
Private Sub TB_Vagas_Tipologia_27_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_27.Top
End Sub
Private Sub TB_Vagas_Tipologia_28_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_28.Top
End Sub
Private Sub TB_Vagas_Tipologia_29_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_29.Top
End Sub
Private Sub TB_Vagas_Tipologia_30_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    Selecionado.Top = TB_Vagas_Tipologia_30.Top
End Sub










